---
uid: web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/inserting-updating-and-deleting-data-with-the-sqldatasource-cs
title: 挿入、更新、および (c#)、SqlDataSource によるデータの削除 |Microsoft Docs
author: rick-anderson
description: 前のチュートリアルでは、ObjectDataSource コントロールを挿入、更新、およびデータの削除の許可する方法について説明しました。 SqlDataSource コントロールでは、t がサポートしています.
ms.author: aspnetcontent
ms.date: 02/20/2007
ms.assetid: a526f0ec-779e-4a2b-a476-6604090d25ce
msc.legacyurl: /web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/inserting-updating-and-deleting-data-with-the-sqldatasource-cs
msc.type: authoredcontent
ms.openlocfilehash: d2958cb9cb0dd5ed89988a969663022a920a3dca
ms.sourcegitcommit: b28cd0313af316c051c2ff8549865bff67f2fbb4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/05/2018
ms.locfileid: "37812848"
---
<a name="inserting-updating-and-deleting-data-with-the-sqldatasource-c"></a><span data-ttu-id="9dd98-104">挿入、更新、および (c#)、SqlDataSource によるデータの削除</span><span class="sxs-lookup"><span data-stu-id="9dd98-104">Inserting, Updating, and Deleting Data with the SqlDataSource (C#)</span></span>
====================
<span data-ttu-id="9dd98-105">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="9dd98-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="9dd98-106">[サンプル アプリをダウンロード](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_49_CS.exe)または[PDF のダウンロード](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/datatutorial49cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="9dd98-106">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_49_CS.exe) or [Download PDF](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/datatutorial49cs1.pdf)</span></span>

> <span data-ttu-id="9dd98-107">前のチュートリアルでは、ObjectDataSource コントロールを挿入、更新、およびデータの削除の許可する方法について説明しました。</span><span class="sxs-lookup"><span data-stu-id="9dd98-107">In previous tutorials we learned how the ObjectDataSource control allowed for inserting, updating, and deleting of data.</span></span> <span data-ttu-id="9dd98-108">SqlDataSource コントロールが、同じ操作をサポートしていますが、アプローチは、さまざまなと、このチュートリアルは、挿入、更新、およびデータを削除する SqlDataSource を構成する方法を示します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-108">The SqlDataSource control supports the same operations, but the approach is different, and this tutorial shows how to configure the SqlDataSource to insert, update, and delete data.</span></span>


## <a name="introduction"></a><span data-ttu-id="9dd98-109">はじめに</span><span class="sxs-lookup"><span data-stu-id="9dd98-109">Introduction</span></span>

<span data-ttu-id="9dd98-110">説明したよう[、概要の挿入、更新、および削除](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md)と共に、DetailsView コントロールと FormView コントロールは、挿入、削除の機能をサポート、GridView コントロールは、組み込みの更新を提供します。編集、および機能を削除しています。</span><span class="sxs-lookup"><span data-stu-id="9dd98-110">As discussed in [An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md), the GridView control provides built-in updating and deleting capabilities, while the DetailsView and FormView controls include inserting support along with editing and deleting functionality.</span></span> <span data-ttu-id="9dd98-111">これらのデータ変更機能を記述する必要があるコードを記述しなくてもデータ ソース コントロールに直接接続することができます。</span><span class="sxs-lookup"><span data-stu-id="9dd98-111">These data modification capabilities can be plugged directly into a data source control without a line of code needing to be written.</span></span> <span data-ttu-id="9dd98-112">[概要の挿入、更新、および削除](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md)を挿入、更新、および GridView、DetailsView、FormView コントロールを使用した削除を容易にする、ObjectDataSource を使用して確認します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-112">[An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) examined using the ObjectDataSource to facilitate inserting, updating, and deleting with the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="9dd98-113">または、SqlDataSource、ObjectDataSource の代わりに使用できます。</span><span class="sxs-lookup"><span data-stu-id="9dd98-113">Alternatively, the SqlDataSource can be used in place of the ObjectDataSource.</span></span>

<span data-ttu-id="9dd98-114">挿入、更新、および削除、ObjectDataSource 必要な挿入を実行するために呼び出すオブジェクト層のメソッドを指定する更新、または削除操作をサポートすることを思い出してください。</span><span class="sxs-lookup"><span data-stu-id="9dd98-114">Recall that to support inserting, updating, and deleting, with the ObjectDataSource we needed to specify the object layer methods to invoke to perform the insert, update, or delete action.</span></span> <span data-ttu-id="9dd98-115">提供する、SqlDataSource による`INSERT`、 `UPDATE`、および`DELETE`SQL ステートメント (またはストアド プロシージャ) を実行します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-115">With the SqlDataSource, we need to provide `INSERT`, `UPDATE`, and `DELETE` SQL statements (or stored procedures) to execute.</span></span> <span data-ttu-id="9dd98-116">このチュートリアルでは表示されるよう、これらのステートメントは手動で作成することができますか、SqlDataSource s のデータ ソース構成ウィザードによって自動的に生成できます。</span><span class="sxs-lookup"><span data-stu-id="9dd98-116">As we'll see in this tutorial, these statements can be created manually or can be automatically generated by the SqlDataSource s Configure Data Source wizard.</span></span>

> [!NOTE]
> <span data-ttu-id="9dd98-117">以降既に説明した、挿入、編集、および GridView、DetailsView の機能を削除してコントロールと FormView コントロール、このチュートリアルはこれらの操作をサポートするために、SqlDataSource コントロールを構成するのに注意してください。</span><span class="sxs-lookup"><span data-stu-id="9dd98-117">Since we ve already discussed the inserting, editing, and deleting capabilities of the GridView, DetailsView, and FormView controls, this tutorial will focus on configuring the SqlDataSource control to support these operations.</span></span> <span data-ttu-id="9dd98-118">以降で、編集、挿入、および削除するデータのチュートリアルを GridView、DetailsView、FormView、戻り値内でこれらの機能を実装する方法を復習する場合は、 [、概要の挿入、更新、および削除](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md)します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-118">If you need to brush up on implementing these features within the GridView, DetailsView, and FormView, return to the Editing, Inserting, and Deleting Data tutorials, starting with [An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md).</span></span>


## <a name="step-1-specifyinginsertupdate-anddeletestatements"></a><span data-ttu-id="9dd98-119">手順 1: 指定`INSERT`、`UPDATE`、および`DELETE`ステートメント</span><span class="sxs-lookup"><span data-stu-id="9dd98-119">Step 1: Specifying`INSERT`,`UPDATE`, and`DELETE`Statements</span></span>

<span data-ttu-id="9dd98-120">私たちは、する必要があります、SqlDataSource コントロールからデータを取得する過去の 2 つのチュートリアルで確認したところは、2 つのプロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-120">As we ve seen in the past two tutorials, to retrieve data from a SqlDataSource control we need to set two properties:</span></span>

1. <span data-ttu-id="9dd98-121">`ConnectionString`、、クエリを送信するデータベースの内容を指定して</span><span class="sxs-lookup"><span data-stu-id="9dd98-121">`ConnectionString`, which specifies what database to send the query to, and</span></span>
2. <span data-ttu-id="9dd98-122">`SelectCommand`、アドホック SQL ステートメントまたは実行結果を返すストアド プロシージャの名前を指定します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-122">`SelectCommand`, which specifies the ad-hoc SQL statement or stored procedure name to execute to return the results.</span></span>

<span data-ttu-id="9dd98-123">`SelectCommand` SqlDataSource s を使用して値を指定するパラメーター、パラメーターを持つ値`SelectParameters`コレクション ハード コーディングされた値、共通パラメーターのソースの値を含めることができます (クエリ文字列フィールド、セッション変数、Web コントロールの値となどの)、またはプログラムによって割り当てられることができます。</span><span class="sxs-lookup"><span data-stu-id="9dd98-123">For `SelectCommand` values with parameters, the parameter values are specified via the SqlDataSource s `SelectParameters` collection and can include hard-coded values, common parameter source values (querystring fields, session variables, Web control values, and so on), or can be programmatically assigned.</span></span> <span data-ttu-id="9dd98-124">SqlDataSource コントロール s`Select()`メソッドが呼び出されたプログラムまたは自動的にデータ Web コントロールからデータベースへの接続を確立するには、パラメーターの値は、クエリに割り当てられているおよびにコマンドが渡さオフ、データベース。</span><span class="sxs-lookup"><span data-stu-id="9dd98-124">When the SqlDataSource control s `Select()` method is invoked either programmatically or automatically from a data Web control a connection to the database is established, the parameter values are assigned to the query, and the command is shuttled off to the database.</span></span> <span data-ttu-id="9dd98-125">結果がデータセットか、DataReader のいずれかとして s コントロールの値に応じて、返される`DataSourceMode`プロパティ。</span><span class="sxs-lookup"><span data-stu-id="9dd98-125">The results are then returned as either a DataSet or DataReader, depending on the value of the control s `DataSourceMode` property.</span></span>

<span data-ttu-id="9dd98-126">データを選択すると、と共に、SqlDataSource コントロールを使用して挿入、更新、および指定することによってデータを削除する`INSERT`、 `UPDATE`、および`DELETE`ほぼ同じ方法で SQL ステートメント。</span><span class="sxs-lookup"><span data-stu-id="9dd98-126">Along with selecting data, the SqlDataSource control can be used to insert, update, and delete data by supplying `INSERT`, `UPDATE`, and `DELETE` SQL statements in much the same way.</span></span> <span data-ttu-id="9dd98-127">割り当てるだけで、 `InsertCommand`、 `UpdateCommand`、および`DeleteCommand`プロパティ、 `INSERT`、`UPDATE`と`DELETE`SQL ステートメントを実行します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-127">Simply assign the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties the `INSERT`, `UPDATE`, and `DELETE` SQL statements to execute.</span></span> <span data-ttu-id="9dd98-128">(が常に最も) と、ステートメントがパラメーターを持つかどうかに含める、 `InsertParameters`、 `UpdateParameters`、および`DeleteParameters`コレクション。</span><span class="sxs-lookup"><span data-stu-id="9dd98-128">If the statements have parameters (as they most always will), include them in the `InsertParameters`, `UpdateParameters`, and `DeleteParameters` collections.</span></span>

<span data-ttu-id="9dd98-129">1 回、 `InsertCommand`、 `UpdateCommand`、または`DeleteCommand`値が指定されている、対応するデータ Web コントロールのスマート タグの挿入を有効にする、編集の有効化または削除を有効にするオプションは使用可能になります。</span><span class="sxs-lookup"><span data-stu-id="9dd98-129">Once an `InsertCommand`, `UpdateCommand`, or `DeleteCommand` value has been specified, the Enable Inserting, Enable Editing, or Enable Deleting option in the corresponding data Web control s smart tag will become available.</span></span> <span data-ttu-id="9dd98-130">これを示すためには、let s がから例を見て、 `Querying.aspx`  ページで作成した、 [SqlDataSource コントロールでデータのクエリ](querying-data-with-the-sqldatasource-control-cs.md)チュートリアルと強化機能の削除が含まれるようにします。</span><span class="sxs-lookup"><span data-stu-id="9dd98-130">To illustrate this, let s take an example from the `Querying.aspx` page we created in the [Querying Data with the SqlDataSource Control](querying-data-with-the-sqldatasource-control-cs.md) tutorial and augment it to include delete capabilities.</span></span>

<span data-ttu-id="9dd98-131">開いて開始、`InsertUpdateDelete.aspx`と`Querying.aspx`ページから、`SqlDataSource`フォルダー。</span><span class="sxs-lookup"><span data-stu-id="9dd98-131">Start by opening the `InsertUpdateDelete.aspx` and `Querying.aspx` pages from the `SqlDataSource` folder.</span></span> <span data-ttu-id="9dd98-132">上のデザイナーから、 `Querying.aspx`  ページで、最初の例から、SqlDataSource や GridView を選択します (、`ProductsDataSource`と`GridView1`コントロール)。</span><span class="sxs-lookup"><span data-stu-id="9dd98-132">From the Designer on the `Querying.aspx` page, select the SqlDataSource and GridView from the first example (the `ProductsDataSource` and `GridView1` controls).</span></span> <span data-ttu-id="9dd98-133">2 つのコントロールを選択すると、[編集] メニューに移動およびコピーを選択 (または ctrl キーを押しながら C キーを押すだけ)。</span><span class="sxs-lookup"><span data-stu-id="9dd98-133">After selecting the two controls, go to the Edit menu and choose Copy (or just hit Ctrl+C).</span></span> <span data-ttu-id="9dd98-134">デザイナーに移動して次に、`InsertUpdateDelete.aspx`コントロールに貼り付けます。</span><span class="sxs-lookup"><span data-stu-id="9dd98-134">Next, go to the Designer of `InsertUpdateDelete.aspx` and paste in the controls.</span></span> <span data-ttu-id="9dd98-135">に 2 つのコントロールを移動したら`InsertUpdateDelete.aspx`ブラウザーでページをテストします。</span><span class="sxs-lookup"><span data-stu-id="9dd98-135">After you have moved the two controls over to `InsertUpdateDelete.aspx`, test out the page in a browser.</span></span> <span data-ttu-id="9dd98-136">値を表示する必要があります、 `ProductID`、 `ProductName`、および`UnitPrice`内のレコードのすべての列、`Products`データベース テーブル。</span><span class="sxs-lookup"><span data-stu-id="9dd98-136">You should see the values of the `ProductID`, `ProductName`, and `UnitPrice` columns for all of the records in the `Products` database table.</span></span>


<span data-ttu-id="9dd98-137">[![すべての製品が一覧表示されます ProductID によって順序付け](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image1.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="9dd98-137">[![All of the Products are Listed, Ordered by ProductID](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image1.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image1.png)</span></span>

<span data-ttu-id="9dd98-138">**図 1**: すべての製品が一覧表示されます並べ`ProductID`([フルサイズの画像を表示する をクリックします](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image2.png))。</span><span class="sxs-lookup"><span data-stu-id="9dd98-138">**Figure 1**: All of the Products are Listed, Ordered by `ProductID` ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image2.png))</span></span>


## <a name="adding-the-sqldatasource-sdeletecommandanddeleteparametersproperties"></a><span data-ttu-id="9dd98-139">SqlDataSource s を追加する`DeleteCommand`と`DeleteParameters`プロパティ</span><span class="sxs-lookup"><span data-stu-id="9dd98-139">Adding the SqlDataSource s`DeleteCommand`and`DeleteParameters`Properties</span></span>

<span data-ttu-id="9dd98-140">この時点であるすべてからレコードを返すだけ SqlDataSource、`Products`テーブルと、このデータを表示する GridView。</span><span class="sxs-lookup"><span data-stu-id="9dd98-140">At this point we have a SqlDataSource that simply returns all of the records from the `Products` table and a GridView that renders this data.</span></span> <span data-ttu-id="9dd98-141">目標は、GridView を使用して製品を削除するユーザーに対して許可するには、この例を拡張することです。</span><span class="sxs-lookup"><span data-stu-id="9dd98-141">Our goal is to extend this example to allow for the user to delete products via the GridView.</span></span> <span data-ttu-id="9dd98-142">SqlDataSource コントロール秒の値を指定する必要があります。 これを実現する`DeleteCommand`と`DeleteParameters`プロパティし、削除をサポートするために、GridView を構成します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-142">To accomplish this we need to specify values for the SqlDataSource control s `DeleteCommand` and `DeleteParameters` properties and then configure the GridView to support deleting.</span></span>

<span data-ttu-id="9dd98-143">`DeleteCommand`と`DeleteParameters`プロパティは、さまざまな方法で指定することができます。</span><span class="sxs-lookup"><span data-stu-id="9dd98-143">The `DeleteCommand` and `DeleteParameters` properties can be specified in a number of ways:</span></span>

- <span data-ttu-id="9dd98-144">宣言型構文を使用</span><span class="sxs-lookup"><span data-stu-id="9dd98-144">Through the declarative syntax</span></span>
- <span data-ttu-id="9dd98-145">デザイナーの [プロパティ] ウィンドウから</span><span class="sxs-lookup"><span data-stu-id="9dd98-145">From the Properties window in the Designer</span></span>
- <span data-ttu-id="9dd98-146">カスタム SQL ステートメントまたはストアド プロシージャがデータ ソースの構成ウィザードでの画面に指定</span><span class="sxs-lookup"><span data-stu-id="9dd98-146">From the Specify a custom SQL statement or stored procedure screen in the Configure Data Source wizard</span></span>
- <span data-ttu-id="9dd98-147">ビューの画面で、データ ソースの構成ウィザードでのテーブルから列を指定の詳細設定 ボタンを使用してこれが実際に自動的に生成、`DELETE`で使用される SQL ステートメントやパラメーターのコレクション、`DeleteCommand`と`DeleteParameters`プロパティ</span><span class="sxs-lookup"><span data-stu-id="9dd98-147">Via the Advanced button in the Specify columns from a table of view screen in the Configure Data Source wizard, which will actually automatically generate the `DELETE` SQL statement and parameter collection used in the `DeleteCommand` and `DeleteParameters` properties</span></span>

<span data-ttu-id="9dd98-148">自動的にする方法について説明します、`DELETE`手順 2. で作成したステートメント。</span><span class="sxs-lookup"><span data-stu-id="9dd98-148">We'll examine how to automatically have the `DELETE` statement created in Step 2.</span></span> <span data-ttu-id="9dd98-149">ここでは、データ ソース構成ウィザードまたは宣言型構文オプションは機能と同様ですが、デザイナーの [プロパティ] ウィンドウを使用して、s を使用できます。</span><span class="sxs-lookup"><span data-stu-id="9dd98-149">For now, let s use the Properties window in the Designer, although the Configure Data Source wizard or declarative syntax option would work just as well.</span></span>

<span data-ttu-id="9dd98-150">デザイナーから`InsertUpdateDelete.aspx`、 をクリックして、 `ProductsDataSource` SqlDataSource プロパティ ウィンドウを表示し (表示 メニューから、プロパティ ウィンドウを選択または f4 キーを押すだけで)。</span><span class="sxs-lookup"><span data-stu-id="9dd98-150">From the Designer in `InsertUpdateDelete.aspx`, click on the `ProductsDataSource` SqlDataSource and then bring up the Properties window (from the View menu, choose Properties window, or simply hit F4).</span></span> <span data-ttu-id="9dd98-151">省略記号のセットが表示されます、DeleteQuery プロパティを選択します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-151">Select the DeleteQuery property, which will bring up a set of ellipses.</span></span>


![[プロパティ] ウィンドウから DeleteQuery プロパティを選択します。](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image2.gif)

<span data-ttu-id="9dd98-153">**図 2**: DeleteQuery プロパティ [プロパティ] ウィンドウから選択します</span><span class="sxs-lookup"><span data-stu-id="9dd98-153">**Figure 2**: Select the DeleteQuery Property from the Properties Window</span></span>


> [!NOTE]
> <span data-ttu-id="9dd98-154">SqlDataSource されないでは、DeleteQuery プロパティがあります。</span><span class="sxs-lookup"><span data-stu-id="9dd98-154">The SqlDataSource doesn t have a DeleteQuery property.</span></span> <span data-ttu-id="9dd98-155">DeleteQuery の組み合わせは、代わりに、`DeleteCommand`と`DeleteParameters`プロパティと、デザイナーでウィンドウを表示するときに、[プロパティ] ウィンドウでのみ表示されます。</span><span class="sxs-lookup"><span data-stu-id="9dd98-155">Rather, DeleteQuery is a combination of the `DeleteCommand` and `DeleteParameters` properties and is only listed in the Properties window when viewing the window through the Designer.</span></span> <span data-ttu-id="9dd98-156">ソース ビューのプロパティ ウィンドウを見る場合、`DeleteCommand`プロパティ代わりにします。</span><span class="sxs-lookup"><span data-stu-id="9dd98-156">If you are looking at the Properties window in the Source view, you'll find the `DeleteCommand` property instead.</span></span>


<span data-ttu-id="9dd98-157">コマンドおよびパラメーターのエディター ダイアログ ボックスを表示、DeleteQuery プロパティで省略記号ボックス (図 3 参照) をクリックします。</span><span class="sxs-lookup"><span data-stu-id="9dd98-157">Click the ellipses in the DeleteQuery property to bring up the Command and Parameter Editor dialog box (see Figure 3).</span></span> <span data-ttu-id="9dd98-158">このダイアログ ボックスから指定できます、 `DELETE` SQL ステートメントのパラメーターを指定します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-158">From this dialog box you can specify the `DELETE` SQL statement and specify the parameters.</span></span> <span data-ttu-id="9dd98-159">次のクエリを入力、`DELETE`コマンド テキスト ボックス (か、手動でまたはしたい場合に、クエリ ビルダーを使用して)。</span><span class="sxs-lookup"><span data-stu-id="9dd98-159">Enter the following query into the `DELETE` command textbox (either manually or using the Query Builder, if you prefer):</span></span>

[!code-sql[Main](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/samples/sample1.sql)]

<span data-ttu-id="9dd98-160">次に、追加するパラメーターの更新ボタンをクリックして、`@ProductID`パラメーター以下のパラメーターの一覧にします。</span><span class="sxs-lookup"><span data-stu-id="9dd98-160">Next, click the Refresh Parameters button to add the `@ProductID` parameter to the list of parameters below.</span></span>


<span data-ttu-id="9dd98-161">[![[プロパティ] ウィンドウから DeleteQuery プロパティを選択します。](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image3.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="9dd98-161">[![Select the DeleteQuery Property from the Properties Window](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image3.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image3.png)</span></span>

<span data-ttu-id="9dd98-162">**図 3**: DeleteQuery プロパティ [プロパティ] ウィンドウから選択します ([フルサイズの画像を表示する をクリックします](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image4.png))。</span><span class="sxs-lookup"><span data-stu-id="9dd98-162">**Figure 3**: Select the DeleteQuery Property from the Properties Window ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image4.png))</span></span>


<span data-ttu-id="9dd98-163">*いない*(そのパラメーターのソース: None のままに) このパラメーターの値を指定します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-163">Do *not* provide a value for this parameter (leave its Parameter source at None ).</span></span> <span data-ttu-id="9dd98-164">GridView に削除のサポートを追加すると、GridView は自動的にこのパラメーター値を入力の値を使用してその`DataKeys`の Delete ボタンがクリックされた行のコレクション。</span><span class="sxs-lookup"><span data-stu-id="9dd98-164">Once we add deleting support to the GridView, the GridView will automatically supply this parameter value, using the value of its `DataKeys` collection for the row whose Delete button was clicked.</span></span>

> [!NOTE]
> <span data-ttu-id="9dd98-165">使用されるパラメーター名、`DELETE`クエリ*する必要があります*の名前と同じである、 `DataKeyNames` GridView、DetailsView、またはフォーム ビュー内の値。</span><span class="sxs-lookup"><span data-stu-id="9dd98-165">The parameter name used in the `DELETE` query *must* be the same as the name of the `DataKeyNames` value in the GridView, DetailsView, or FormView.</span></span> <span data-ttu-id="9dd98-166">内のパラメーターは、`DELETE`ステートメントの名前は意図的`@ProductID`(の代わりに、たとえば、 `@ID`)、Products テーブル (とそのため、gridview DataKeyNames 値) の主キー列名があるため、`ProductID`します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-166">That is, the parameter in the `DELETE` statement is purposefully named `@ProductID` (instead of, say, `@ID`), because the primary key column name in the Products table (and therefore the DataKeyNames value in the GridView) is `ProductID`.</span></span>


<span data-ttu-id="9dd98-167">場合、パラメーター名と`DataKeyNames`値は t の一致、GridView ことはできませんを自動的に割り当てるパラメーターの値、`DataKeys`コレクション。</span><span class="sxs-lookup"><span data-stu-id="9dd98-167">If the parameter name and `DataKeyNames` value doesn t match, the GridView cannot automatically assign the parameter the value from the `DataKeys` collection.</span></span>

<span data-ttu-id="9dd98-168">コマンドおよびパラメーターのエディター ダイアログ ボックスに、削除に関連する情報を入力した後に [ok] をクリックし、結果として得られる宣言型マークアップを確認する、ソース ビューに移動します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-168">After entering the delete-related information into the Command and Parameter Editor dialog box click OK and go to the Source view to examine the resulting declarative markup:</span></span>

[!code-aspx[Main](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/samples/sample2.aspx)]

<span data-ttu-id="9dd98-169">メモの追加、`DeleteCommand`プロパティだけでなく`<DeleteParameters>`セクションとという名前のパラメーター オブジェクト`productID`します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-169">Note the addition of the `DeleteCommand` property as well as the `<DeleteParameters>` section and the Parameter object named `productID`.</span></span>

## <a name="configuring-the-gridview-for-deleting"></a><span data-ttu-id="9dd98-170">GridView を削除するための構成</span><span class="sxs-lookup"><span data-stu-id="9dd98-170">Configuring the GridView for Deleting</span></span>

<span data-ttu-id="9dd98-171">`DeleteCommand`プロパティの追加、GridView s のスマート タグには、削除を有効にするオプションが含まれています。</span><span class="sxs-lookup"><span data-stu-id="9dd98-171">With the `DeleteCommand` property added, the GridView s smart tag now contains the Enable Deleting option.</span></span> <span data-ttu-id="9dd98-172">このチェック ボックスを確認してください。</span><span class="sxs-lookup"><span data-stu-id="9dd98-172">Go ahead and check this checkbox.</span></span> <span data-ttu-id="9dd98-173">説明したよう[、概要の挿入、更新、および削除](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md)、これが原因で、GridView で [commandfield] を追加するその`ShowDeleteButton`プロパティに設定`true`します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-173">As discussed in [An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md), this causes the GridView to add a CommandField with its `ShowDeleteButton` property set to `true`.</span></span> <span data-ttu-id="9dd98-174">ページがブラウザーからアクセスしたときに、4 に示すを図には、[削除] ボタンが含まれます。</span><span class="sxs-lookup"><span data-stu-id="9dd98-174">As Figure 4 shows, when the page is visited through a browser a Delete button is included.</span></span> <span data-ttu-id="9dd98-175">このページをテストするには、一部の製品を削除します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-175">Test this page out by deleting some products.</span></span>


<span data-ttu-id="9dd98-176">[![GridView の行ごとに Delete ボタンが含まれています](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image4.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="9dd98-176">[![Each GridView Row Now Includes a Delete Button](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image4.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image5.png)</span></span>

<span data-ttu-id="9dd98-177">**図 4**: GridView 行ごとに、[削除] ボタンが含まれています ([フルサイズの画像を表示する をクリックします](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image6.png))。</span><span class="sxs-lookup"><span data-stu-id="9dd98-177">**Figure 4**: Each GridView Row Now Includes a Delete Button ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image6.png))</span></span>


<span data-ttu-id="9dd98-178">[削除] ボタンをクリックすると、ポストバックが発生する、GridView を割り当てます、`ProductID`パラメーター値の`DataKeys`が [削除] ボタンがクリックしてされ、SqlDataSource s を呼び出す行のコレクション値`Delete()`メソッド。</span><span class="sxs-lookup"><span data-stu-id="9dd98-178">Upon clicking a Delete button, a postback occurs, the GridView assigns the `ProductID` parameter the value of the `DataKeys` collection value for the row whose Delete button was clicked, and invokes the SqlDataSource s `Delete()` method.</span></span> <span data-ttu-id="9dd98-179">SqlDataSource コントロール: データベースに接続し、実行、`DELETE`ステートメント。</span><span class="sxs-lookup"><span data-stu-id="9dd98-179">The SqlDataSource control then connects to the database and executes the `DELETE` statement.</span></span> <span data-ttu-id="9dd98-180">GridView が SqlDataSource、戻す (を不要になっただけ削除されたレコードを含む) の製品の現在のセットを表示する、再バインドします。</span><span class="sxs-lookup"><span data-stu-id="9dd98-180">The GridView then rebinds to the SqlDataSource, getting back and displaying the current set of products (which no longer includes the just-deleted record).</span></span>

> [!NOTE]
> <span data-ttu-id="9dd98-181">GridView を使用しているため、 `DataKeys` 、SqlDataSource パラメーターを設定するコレクションが s の重要なを GridView s`DataKeyNames`プロパティと主キーを構成する列に設定する SqlDataSource の`SelectCommand`を返しますこれらの列。</span><span class="sxs-lookup"><span data-stu-id="9dd98-181">Since the GridView uses its `DataKeys` collection to populate the SqlDataSource parameters, it s vital that the GridView s `DataKeyNames` property be set to the column(s) that constitute the primary key and that the SqlDataSource s `SelectCommand` returns these columns.</span></span> <span data-ttu-id="9dd98-182">さらに、その SqlDataSource s でパラメーターの名前、重要な`DeleteCommand`に設定されている`@ProductID`します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-182">Moreover, it s important that the parameter name in the SqlDataSource s `DeleteCommand` is set to `@ProductID`.</span></span> <span data-ttu-id="9dd98-183">場合、`DataKeyNames`プロパティが設定されていないか、パラメーターの名前が付いていません`@ProductsID`ポストバックを発生させるが、[削除] ボタンをクリックすると、受注の t が実際には任意のレコードを削除します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-183">If the `DataKeyNames` property is not set or the parameter is not named `@ProductsID`, clicking the Delete button will cause a postback, but won t actually delete any record.</span></span>


<span data-ttu-id="9dd98-184">図 5 は、この相互作用をグラフィカルに示しています。</span><span class="sxs-lookup"><span data-stu-id="9dd98-184">Figure 5 depicts this interaction graphically.</span></span> <span data-ttu-id="9dd98-185">参照、 [、イベントに関連付けられている挿入、更新、および削除の確認](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-cs.md)挿入、更新、およびデータ Web コントロールからの削除に関連付けられているイベントのチェーンについては詳細なチュートリアルです。</span><span class="sxs-lookup"><span data-stu-id="9dd98-185">Refer back to the [Examining the Events Associated with Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-cs.md) tutorial for a more detailed discussion on the chain of events associated with inserting, updating, and deleting from a data Web control.</span></span>


![SqlDataSource の Delete() メソッドを呼び出し、GridView で [削除] ボタンをクリックして](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image5.gif)

<span data-ttu-id="9dd98-187">**図 5**: SqlDataSource s を呼び出す、GridView で [削除] ボタンをクリックすると`Delete()`メソッド</span><span class="sxs-lookup"><span data-stu-id="9dd98-187">**Figure 5**: Clicking the Delete Button in the GridView Invokes the SqlDataSource s `Delete()` Method</span></span>


## <a name="step-2-automatically-generating-theinsertupdate-anddeletestatements"></a><span data-ttu-id="9dd98-188">手順 2: が自動的に生成する、`INSERT`、`UPDATE`、および`DELETE`ステートメント</span><span class="sxs-lookup"><span data-stu-id="9dd98-188">Step 2: Automatically Generating the`INSERT`,`UPDATE`, and`DELETE`Statements</span></span>

<span data-ttu-id="9dd98-189">検査すると、ステップ 1 として`INSERT`、 `UPDATE`、および`DELETE`プロパティ ウィンドウまたはコントロールの宣言型構文によって SQL ステートメントを指定できます。</span><span class="sxs-lookup"><span data-stu-id="9dd98-189">As Step 1 examined, `INSERT`, `UPDATE`, and `DELETE` SQL statements can be specified through the Properties window or the control s declarative syntax.</span></span> <span data-ttu-id="9dd98-190">ただし、このアプローチでは、こと手動で SQL ステートメントを手動で記述単調なりエラーが発生しやすい可能性がありますが必要です。</span><span class="sxs-lookup"><span data-stu-id="9dd98-190">However, this approach requires that we manually write out the SQL statements by hand, which can be monotonous and error-prone.</span></span> <span data-ttu-id="9dd98-191">幸いにも、データ ソース構成ウィザードはさせるオプションを提供します。、 `INSERT`、 `UPDATE`、および`DELETE`ステートメントの表示画面のテーブルから列を指定を使用する場合に自動的に生成されます。</span><span class="sxs-lookup"><span data-stu-id="9dd98-191">Fortunately, the Configure Data Source wizard provides an option to have the `INSERT`, `UPDATE`, and `DELETE` statements automatically generated when using the Specify columns from a table of view screen.</span></span>

<span data-ttu-id="9dd98-192">この自動生成オプションを探索して使用できます。</span><span class="sxs-lookup"><span data-stu-id="9dd98-192">Let s explore this automatic generation option.</span></span> <span data-ttu-id="9dd98-193">デザイナーに、DetailsView を追加`InsertUpdateDelete.aspx`設定とその`ID`プロパティを`ManageProducts`します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-193">Add a DetailsView to the Designer in `InsertUpdateDelete.aspx` and set its `ID` property to `ManageProducts`.</span></span> <span data-ttu-id="9dd98-194">次に、DetailsView s のスマート タグから、SqlDataSource という名前を作成し、新しいデータ ソースを作成する選択`ManageProductsDataSource`します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-194">Next, from the DetailsView s smart tag, choose to create a new data source and create a SqlDataSource named `ManageProductsDataSource`.</span></span>


<span data-ttu-id="9dd98-195">[![ManageProductsDataSource という名前の新しい SqlDataSource を作成します。](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image6.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="9dd98-195">[![Create a New SqlDataSource Named ManageProductsDataSource](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image6.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image7.png)</span></span>

<span data-ttu-id="9dd98-196">**図 6**: 名前付き新しい SqlDataSource 作成`ManageProductsDataSource`([フルサイズの画像を表示する をクリックします](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image8.png))。</span><span class="sxs-lookup"><span data-stu-id="9dd98-196">**Figure 6**: Create a New SqlDataSource Named `ManageProductsDataSource` ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image8.png))</span></span>


<span data-ttu-id="9dd98-197">使用することを選択、データ ソースの構成ウィザードから、`NORTHWINDConnectionString`接続文字列を [次へ] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="9dd98-197">From the Configure Data Source wizard, opt to use the `NORTHWINDConnectionString` connection string and click Next.</span></span> <span data-ttu-id="9dd98-198">Select ステートメントの画面の構成 から選択したテーブルまたはビューのオプション ボタンから列を指定のままにし、選択、`Products`ドロップダウン リストからテーブル。</span><span class="sxs-lookup"><span data-stu-id="9dd98-198">From the Configure the Select Statement screen, leave the Specify columns from a table or view radio button selected and pick the `Products` table from the drop-down list.</span></span> <span data-ttu-id="9dd98-199">選択、 `ProductID`、 `ProductName`、 `UnitPrice`、および`Discontinued`チェック ボックスの一覧から列。</span><span class="sxs-lookup"><span data-stu-id="9dd98-199">Select the `ProductID`, `ProductName`, `UnitPrice`, and `Discontinued` columns from the checkbox list.</span></span>


<span data-ttu-id="9dd98-200">[![ProductID、ProductName、UnitPrice、および提供が中止された列を返す、Products テーブルを使用して、](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image7.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="9dd98-200">[![Using the Products Table, Return the ProductID, ProductName, UnitPrice, and Discontinued Columns](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image7.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image9.png)</span></span>

<span data-ttu-id="9dd98-201">**図 7**: を使用して、`Products`テーブルを返す、 `ProductID`、 `ProductName`、 `UnitPrice`、および`Discontinued`列 ([フルサイズの画像を表示する をクリックします](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image10.png))。</span><span class="sxs-lookup"><span data-stu-id="9dd98-201">**Figure 7**: Using the `Products` Table, Return the `ProductID`, `ProductName`, `UnitPrice`, and `Discontinued` Columns ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image10.png))</span></span>


<span data-ttu-id="9dd98-202">自動的に生成する`INSERT`、`UPDATE`と`DELETE`選択したテーブルと列に基づいて、ステートメントは高度なボタンをクリックし、確認の生成`INSERT`、`UPDATE`と`DELETE`ステートメントのチェック ボックスをオンします。</span><span class="sxs-lookup"><span data-stu-id="9dd98-202">To automatically generate `INSERT`, `UPDATE`, and `DELETE` statements based on the selected table and columns, click the Advanced button and check the Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox.</span></span>


![チェック ボックスをオンの生成を挿入、更新、および DELETE ステートメントを確認してください。](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image8.gif)

<span data-ttu-id="9dd98-204">**図 8**: 確認の生成`INSERT`、 `UPDATE`、および`DELETE`ステートメント チェック ボックス</span><span class="sxs-lookup"><span data-stu-id="9dd98-204">**Figure 8**: Check the Generate `INSERT`, `UPDATE`, and `DELETE` statements Checkbox</span></span>


<span data-ttu-id="9dd98-205">生成`INSERT`、 `UPDATE`、および`DELETE`選択されているテーブルが主キーと主キー列 (または列) が返される列の一覧に含まれている場合に、ステートメントのチェック ボックスをチェック可能なだけになります。</span><span class="sxs-lookup"><span data-stu-id="9dd98-205">The Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox will only be checkable if the table selected has a primary key and the primary key column (or columns) are included in the list of returned columns.</span></span> <span data-ttu-id="9dd98-206">選択可能なオプティミスティック同時実行制御チェック ボックスを使用生成 1 回`INSERT`、 `UPDATE`、および`DELETE`拡張は、ステートメントのチェック ボックスをオンされましたが、 `WHERE` 、最終的な句`UPDATE`と`DELETE`オプティミスティック同時実行制御を提供するステートメント。</span><span class="sxs-lookup"><span data-stu-id="9dd98-206">The Use optimistic concurrency checkbox, which becomes selectable once the Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox has been checked, will augment the `WHERE` clauses in the resulting `UPDATE` and `DELETE` statements to provide optimistic concurrency control.</span></span> <span data-ttu-id="9dd98-207">ここでは、オフのままにこのチェック ボックスをオンします。次のチュートリアルでは、SqlDataSource コントロールでオプティミスティック同時実行をについて説明します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-207">For now, leave this checkbox unchecked; we'll examine optimistic concurrency with the SqlDataSource control in the next tutorial.</span></span>

<span data-ttu-id="9dd98-208">確認の生成後`INSERT`、 `UPDATE`、および`DELETE`ステートメントのチェック ボックスをオン、Select ステートメントの構成画面に戻り、次に、をクリックして ok をクリックし、データ ソースの構成ウィザードを完了します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-208">After checking the Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox, click OK to return to the Configure Select Statement screen, then click Next, and then Finish, to complete the Configure Data Source wizard.</span></span> <span data-ttu-id="9dd98-209">ウィザードを完了すると、Visual Studio は、の DetailsView に BoundFields を追加は、 `ProductID`、 `ProductName`、および`UnitPrice`列との CheckBoxField、`Discontinued`列。</span><span class="sxs-lookup"><span data-stu-id="9dd98-209">Upon completing the wizard, Visual Studio will add BoundFields to the DetailsView for the `ProductID`, `ProductName`, and `UnitPrice` columns and a CheckBoxField for the `Discontinued` column.</span></span> <span data-ttu-id="9dd98-210">DetailsView s のスマート タグからページングを有効にするオプションを確認するため、このページにアクセスするユーザーは、製品をたどることができます。</span><span class="sxs-lookup"><span data-stu-id="9dd98-210">From the DetailsView s smart tag, check the Enable Paging option so that the user visiting this page can step through the products.</span></span> <span data-ttu-id="9dd98-211">DetailsView s もクリア`Width`と`Height`プロパティ。</span><span class="sxs-lookup"><span data-stu-id="9dd98-211">Also clear out the DetailsView s `Width` and `Height` properties.</span></span>

<span data-ttu-id="9dd98-212">スマート タグが挿入を有効にする、編集の有効化、および削除を有効にするオプションを持つことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="9dd98-212">Notice that the smart tag has the Enable Inserting, Enable Editing, and Enable Deleting options available.</span></span> <span data-ttu-id="9dd98-213">これは、SqlDataSource の値を格納するため、 `InsertCommand`、 `UpdateCommand`、および`DeleteCommand`のように、次の宣言型構文。</span><span class="sxs-lookup"><span data-stu-id="9dd98-213">This is because the SqlDataSource contains values for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand`, as the following declarative syntax shows:</span></span>

[!code-aspx[Main](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/samples/sample3.aspx)]

<span data-ttu-id="9dd98-214">SqlDataSource コントロールが自動的に設定された値があった方法に注意してください。 その`InsertCommand`、 `UpdateCommand`、および`DeleteCommand`プロパティ。</span><span class="sxs-lookup"><span data-stu-id="9dd98-214">Note how the SqlDataSource control has had values automatically set for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="9dd98-215">参照される列のセット、`InsertCommand`と`UpdateCommand`プロパティがあるプログラムに基づきます、`SELECT`ステートメント。</span><span class="sxs-lookup"><span data-stu-id="9dd98-215">The set of columns referenced in the `InsertCommand` and `UpdateCommand` properties are based on those in the `SELECT` statement.</span></span> <span data-ttu-id="9dd98-216">ではなく*すべて*製品列で、`InsertCommand`と`UpdateCommand`で指定された列のみがある、 `SelectCommand` (小さい`ProductID`、ため、これが省略されて、s、 [`IDENTITY`列](http://www.sqlteam.com/item.asp?ItemID=102)を挿入するときに自動的に割り当て、編集する際に、値を変更ことはできません)。</span><span class="sxs-lookup"><span data-stu-id="9dd98-216">That is, rather than having *every* Products column in the `InsertCommand` and `UpdateCommand`, there are only those columns specified in the `SelectCommand` (less `ProductID`, which is omitted because it s an [`IDENTITY` column](http://www.sqlteam.com/item.asp?ItemID=102), whose value cannot be changed when edited and which is automatically assigned when inserting).</span></span> <span data-ttu-id="9dd98-217">さらの各パラメーターに、 `InsertCommand`、 `UpdateCommand`、および`DeleteCommand`プロパティに対応するパラメーターがある、 `InsertParameters`、 `UpdateParameters`、および`DeleteParameters`コレクション。</span><span class="sxs-lookup"><span data-stu-id="9dd98-217">Moreover, for each parameter in the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties there are corresponding parameters in the `InsertParameters`, `UpdateParameters`, and `DeleteParameters` collections.</span></span>

<span data-ttu-id="9dd98-218">DetailsView のデータの変更機能を有効にする、挿入を有効にする、有効にする編集、およびそのスマート タグの削除を有効にするオプションを確認してください。</span><span class="sxs-lookup"><span data-stu-id="9dd98-218">To turn on the DetailsView s data modification features, check the Enable Inserting, Enable Editing, and Enable Deleting options in its smart tag.</span></span> <span data-ttu-id="9dd98-219">[Commandfield] が追加されます、 `ShowInsertButton`、 `ShowEditButton`、および`ShowDeleteButton`プロパティに設定`true`します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-219">This adds a CommandField with its `ShowInsertButton`, `ShowEditButton`, and `ShowDeleteButton` properties set to `true`.</span></span>

<span data-ttu-id="9dd98-220">ブラウザーでページにアクセスし、編集、削除、および DetailsView に含まれる新しいボタンに注意してください。</span><span class="sxs-lookup"><span data-stu-id="9dd98-220">Visit the page in a browser and note the Edit, Delete, and New buttons included in the DetailsView.</span></span> <span data-ttu-id="9dd98-221">各 BoundField を表示する編集モードにある DetailsView をオンに編集ボタンをクリックを`ReadOnly`プロパティに設定されて`false`(既定)、テキスト ボックスとチェック ボックスとして CheckBoxField として。</span><span class="sxs-lookup"><span data-stu-id="9dd98-221">Clicking the Edit button turns the DetailsView into edit mode, which displays each BoundField whose `ReadOnly` property is set to `false` (the default) as a TextBox, and the CheckBoxField as a checkbox.</span></span>


<span data-ttu-id="9dd98-222">[![DetailsView s 既定の編集インターフェイス](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image9.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="9dd98-222">[![The DetailsView s Default Editing Interface](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image9.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image11.png)</span></span>

<span data-ttu-id="9dd98-223">**図 9**:、DetailsView s 編集インターフェイスの既定の ([フルサイズの画像を表示する をクリックします](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image12.png))。</span><span class="sxs-lookup"><span data-stu-id="9dd98-223">**Figure 9**: The DetailsView s Default Editing Interface ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-cs/_static/image12.png))</span></span>


<span data-ttu-id="9dd98-224">同様に、現在選択されている製品を削除したり、システムに新しい製品を追加できます。</span><span class="sxs-lookup"><span data-stu-id="9dd98-224">Similarly, you can delete the currently selected product or add a new product to the system.</span></span> <span data-ttu-id="9dd98-225">以降、`InsertCommand`ステートメントでのみ動作、 `ProductName`、 `UnitPrice`、および`Discontinued`列、他の列がいずれか`NULL`または挿入時にデータベースによって割り当てられた既定値。</span><span class="sxs-lookup"><span data-stu-id="9dd98-225">Since the `InsertCommand` statement only works with the `ProductName`, `UnitPrice`, and `Discontinued` columns, the other columns have either `NULL` or their default value assigned by the database upon insert.</span></span> <span data-ttu-id="9dd98-226">場合、ObjectDataSource と同様、`InsertCommand`ない列で使用できる任意のデータベース テーブルがありません`NULL`s としない既定の値を持つ SQL エラーが発生を実行する際、`INSERT`ステートメント。</span><span class="sxs-lookup"><span data-stu-id="9dd98-226">Just like with the ObjectDataSource, if the `InsertCommand` is missing any database table columns that don t allow `NULL` s and don t have a default value, a SQL error will occur when attempting to execute the `INSERT` statement.</span></span>

> [!NOTE]
> <span data-ttu-id="9dd98-227">DetailsView s を挿入して、インターフェイスの編集には、あらゆる種類のカスタマイズや検証が不足しています。</span><span class="sxs-lookup"><span data-stu-id="9dd98-227">The DetailsView s inserting and editing interfaces lack any sort of customization or validation.</span></span> <span data-ttu-id="9dd98-228">検証コントロールを追加する、またはインターフェイスをカスタマイズするには、TemplateFields、BoundFields に変換する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9dd98-228">To add validation controls or to customize the interfaces, you need to convert the BoundFields to TemplateFields.</span></span> <span data-ttu-id="9dd98-229">参照してください、[編集および挿入インターフェイスに検証コントロールを追加](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md)と[データ変更インターフェイスをカスタマイズ](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md)詳細についてはチュートリアル。</span><span class="sxs-lookup"><span data-stu-id="9dd98-229">Refer to the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md) and [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-cs.md) tutorials for more information.</span></span>


<span data-ttu-id="9dd98-230">また、留意更新および削除、DetailsView を使用する、現在の製品 s`DataKey`場合にのみ存在する値、`DataKeyNames`プロパティが構成されています。</span><span class="sxs-lookup"><span data-stu-id="9dd98-230">Also, keep in mind that for updating and deleting, the DetailsView uses the current product s `DataKey` value, which is only present if the `DataKeyNames` property is configured.</span></span> <span data-ttu-id="9dd98-231">場合は、編集または削除は、影響を与えないが表示されたら、確認、`DataKeyNames`プロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-231">If editing or deleting appears to have no effect, ensure that the `DataKeyNames` property is set.</span></span>

## <a name="limitations-of-automatically-generating-sql-statements"></a><span data-ttu-id="9dd98-232">SQL ステートメントを自動的に生成の制限事項</span><span class="sxs-lookup"><span data-stu-id="9dd98-232">Limitations of Automatically Generating SQL Statements</span></span>

<span data-ttu-id="9dd98-233">生成後`INSERT`、 `UPDATE`、および`DELETE`ステートメント オプションは、独自に作成する必要がありますより複雑なクエリのテーブルから列を選択するときにのみ使用可能な`INSERT`、 `UPDATE`、および`DELETE`手順 1 で行ったようにステートメントです。</span><span class="sxs-lookup"><span data-stu-id="9dd98-233">Since the Generate `INSERT`, `UPDATE`, and `DELETE` statements option is only available when picking columns from a table, for more complex queries you will have to write your own `INSERT`, `UPDATE`, and `DELETE` statements like we did in Step 1.</span></span> <span data-ttu-id="9dd98-234">一般的には、SQL`SELECT`ステートメントを使用して、`JOIN`の 1 つまたは複数のルックアップ テーブルからデータを表示目的で元に戻しますに (元に戻す方法など、`Categories`テーブルの`CategoryName`製品情報を表示するときにフィールド)。</span><span class="sxs-lookup"><span data-stu-id="9dd98-234">Commonly, SQL `SELECT` statements use `JOIN` s to bring back data from one or more lookup tables for display purposes (such as bringing back the `Categories` table s `CategoryName` field when displaying product information).</span></span> <span data-ttu-id="9dd98-235">同時に、編集、更新、または、中核となるテーブルにデータを挿入するユーザーをできるようにする場合があります (`Products`、この場合)。</span><span class="sxs-lookup"><span data-stu-id="9dd98-235">At the same time, we might want to allow the user to edit, update, or insert data into the core table (`Products`, in this case).</span></span>

<span data-ttu-id="9dd98-236">中に、 `INSERT`、 `UPDATE`、および`DELETE`ステートメントは、手動で入力することができます、次の時間節約のヒントを検討してください。</span><span class="sxs-lookup"><span data-stu-id="9dd98-236">While the `INSERT`, `UPDATE`, and `DELETE` statements can be entered manually, consider the following time-saving tip.</span></span> <span data-ttu-id="9dd98-237">最初に、SqlDataSource をセットアップ データだけを取得戻すように、`Products`テーブル。</span><span class="sxs-lookup"><span data-stu-id="9dd98-237">Initially setup the SqlDataSource so that it pulls back data just from the `Products` table.</span></span> <span data-ttu-id="9dd98-238">テーブルまたはビューの画面からデータ ソースの構成ウィザードの列と s を指定を使用して、自動的に生成することができるように、 `INSERT`、 `UPDATE`、および`DELETE`ステートメント。</span><span class="sxs-lookup"><span data-stu-id="9dd98-238">Use the Configure Data Source wizard s Specify columns from a table or view screen so that you can automatically generate the `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="9dd98-239">ウィザードの完了後に選択のプロパティ ウィンドウから SelectQuery を構成する (または、代わりに、使用するカスタム SQL ステートメントを指定しますが、データ ソース構成ウィザードまたはストアド プロシージャのオプションに戻る)。</span><span class="sxs-lookup"><span data-stu-id="9dd98-239">Then, after completing the wizard, choose to configure the SelectQuery from the Properties window (or, alternatively, go back to the Configure Data Source wizard, but use the Specify a custom SQL statement or stored procedure option).</span></span> <span data-ttu-id="9dd98-240">更新し、`SELECT`ステートメントに含める、`JOIN`構文。</span><span class="sxs-lookup"><span data-stu-id="9dd98-240">Then update the `SELECT` statement to include the `JOIN` syntax.</span></span> <span data-ttu-id="9dd98-241">この手法が自動的に生成された SQL ステートメントの時間節約の利点し、さらにカスタマイズできます`SELECT`ステートメント。</span><span class="sxs-lookup"><span data-stu-id="9dd98-241">This technique offers the time-saving benefits of the automatically generated SQL statements and allows for a more customized `SELECT` statement.</span></span>

<span data-ttu-id="9dd98-242">自動的に生成する別の制限、 `INSERT`、 `UPDATE`、および`DELETE`ステートメントは、列、`INSERT`と`UPDATE`ステートメントはによって返される列に基づいて、`SELECT`ステートメント。</span><span class="sxs-lookup"><span data-stu-id="9dd98-242">Another limitation of automatically generating the `INSERT`, `UPDATE`, and `DELETE` statements is that the columns in the `INSERT` and `UPDATE` statements are based on the columns returned by the `SELECT` statement.</span></span> <span data-ttu-id="9dd98-243">私たちは、更新またはただし、またはより少ないフィールドを挿入する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9dd98-243">We may need to update or insert more or fewer fields, however.</span></span> <span data-ttu-id="9dd98-244">たとえば、手順 2 の例ですることができますが、 `UnitPrice` BoundField が読み取り専用にします。</span><span class="sxs-lookup"><span data-stu-id="9dd98-244">For example, in the example from Step 2, maybe we want to have the `UnitPrice` BoundField be read-only.</span></span> <span data-ttu-id="9dd98-245">その場合は、これで表示されるべきで t、`UpdateCommand`します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-245">In that case, it shouldn t appear in the `UpdateCommand`.</span></span> <span data-ttu-id="9dd98-246">または、GridView に表示されていない、テーブルのフィールドの値を設定することがあります。</span><span class="sxs-lookup"><span data-stu-id="9dd98-246">Or we may want to set the value of a table field that does not appear in the GridView.</span></span> <span data-ttu-id="9dd98-247">たとえば、新しい追加するときにレコード可能性がある、`QuantityPerUnit`値 TODO に設定します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-247">For example, when adding a new record we may want the `QuantityPerUnit` value set to TODO .</span></span>

<span data-ttu-id="9dd98-248">このようなカスタマイズが必要な場合は、手動でできるように、[プロパティ] ウィンドウ、カスタム SQL ステートメントを指定してくださいまたはウィザードで、または宣言の構文を使用してストアド プロシージャのオプションを使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9dd98-248">If such customizations are required, you need to make them manually, either through the Properties window, the Specify a custom SQL statement or stored procedure option in the wizard, or via the declarative syntax.</span></span>

> [!NOTE]
> <span data-ttu-id="9dd98-249">データに対応するフィールドがないパラメーターの追加は、コントロールを Web、ときに、これらのパラメーターの値がなんらかの方法で値を割り当てる必要があることに留意してください。</span><span class="sxs-lookup"><span data-stu-id="9dd98-249">When adding parameters that do not have corresponding fields in the data Web control, keep in mind that these parameters values will need to be assigned values in some manner.</span></span> <span data-ttu-id="9dd98-250">これらの値を指定できます。 ハード コーディングされたで直接、`InsertCommand`または`UpdateCommand`(クエリ文字列、セッション状態、ページで、上の Web コントロール) は、いくつかの事前定義されたソースから取得できます。 または、前のチュートリアルで説明したようにプログラムで、割り当てることができます。</span><span class="sxs-lookup"><span data-stu-id="9dd98-250">These values can be: hard-coded directly in the `InsertCommand` or `UpdateCommand`; can come from some pre-defined source (the querystring, session state, Web controls on the page, and so on); or can be assigned programmatically, as we saw in the preceding tutorial.</span></span>


## <a name="summary"></a><span data-ttu-id="9dd98-251">まとめ</span><span class="sxs-lookup"><span data-stu-id="9dd98-251">Summary</span></span>

<span data-ttu-id="9dd98-252">Web コントロールの組み込みの挿入、編集、および削除機能を利用するデータの順序でにバインドされているデータ ソース コントロールは、このような機能を提供する必要があります。</span><span class="sxs-lookup"><span data-stu-id="9dd98-252">In order for the data Web controls to utilize their built-in inserting, editing, and deleting capabilities, the data source control they are bound to must offer such functionality.</span></span> <span data-ttu-id="9dd98-253">SqlDataSource、つまり`INSERT`、 `UPDATE`、および`DELETE`SQL ステートメントを割り当てる必要があります、 `InsertCommand`、 `UpdateCommand`、および`DeleteCommand`プロパティ。</span><span class="sxs-lookup"><span data-stu-id="9dd98-253">For the SqlDataSource, this means that `INSERT`, `UPDATE`, and `DELETE` SQL statements must be assigned to the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="9dd98-254">これらのプロパティと、対応するパラメーターのコレクションを手動で追加またはデータ ソース構成ウィザードを使用して自動的に生成します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-254">These properties, and the corresponding parameters collections, can be added manually or generated automatically through the Configure Data Source wizard.</span></span> <span data-ttu-id="9dd98-255">このチュートリアルでは、両方の手法を調査します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-255">In this tutorial we examined both techniques.</span></span>

<span data-ttu-id="9dd98-256">調べるで ObjectDataSource でオプティミスティック同時実行制御を使用して、[オプティミスティック同時実行を実装する](../editing-inserting-and-deleting-data/implementing-optimistic-concurrency-cs.md)チュートリアル。</span><span class="sxs-lookup"><span data-stu-id="9dd98-256">We examined using optimistic concurrency with the ObjectDataSource in the [Implementing Optimistic Concurrency](../editing-inserting-and-deleting-data/implementing-optimistic-concurrency-cs.md) tutorial.</span></span> <span data-ttu-id="9dd98-257">SqlDataSource コントロールには、オプティミスティック同時実行制御のサポートも提供します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-257">The SqlDataSource control also provides optimistic concurrency support.</span></span> <span data-ttu-id="9dd98-258">自動的に生成するときに、手順 2. で説明したように、 `INSERT`、 `UPDATE`、および`DELETE`ステートメントでは、ウィザードを使用してオプティミスティック同時実行制御オプションを使用しています。</span><span class="sxs-lookup"><span data-stu-id="9dd98-258">As noted in Step 2, when automatically generating the `INSERT`, `UPDATE`, and `DELETE` statements, the wizard offers a Use optimistic concurrency option.</span></span> <span data-ttu-id="9dd98-259">次のチュートリアルで後ほど、SqlDataSource でオプティミスティック同時実行制御を使用して変更、`WHERE`内の句、`UPDATE`と`DELETE`の他の列の値にデータが最後に変更されていないことを確認するステートメントページに表示されます。</span><span class="sxs-lookup"><span data-stu-id="9dd98-259">As we'll see in the next tutorial, using optimistic concurrency with the SqlDataSource modifies the `WHERE` clauses in the `UPDATE` and `DELETE` statements to ensure that the values for the other columns haven t changed since the data was last displayed on the page.</span></span>

<span data-ttu-id="9dd98-260">満足のプログラミングです。</span><span class="sxs-lookup"><span data-stu-id="9dd98-260">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="9dd98-261">執筆者紹介</span><span class="sxs-lookup"><span data-stu-id="9dd98-261">About the Author</span></span>

<span data-ttu-id="9dd98-262">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)、7 つ受け取りますブックおよびの創設者の著者[4GuysFromRolla.com](http://www.4guysfromrolla.com)、Microsoft Web テクノロジと 1998 年から携わっています。</span><span class="sxs-lookup"><span data-stu-id="9dd98-262">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="9dd98-263">Scott は、フリーのコンサルタント、トレーナー、およびライターとして動作します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-263">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="9dd98-264">最新の著書は[ *Sams 教える自分で ASP.NET 2.0 24 時間以内に*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-264">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="9dd98-265">彼に到達できる[mitchell@4GuysFromRolla.comします。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="9dd98-265">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="9dd98-266">彼のブログにあるでまたは[ http://ScottOnWriting.NET](http://ScottOnWriting.NET)します。</span><span class="sxs-lookup"><span data-stu-id="9dd98-266">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="9dd98-267">[前へ](using-parameterized-queries-with-the-sqldatasource-cs.md)
> [次へ](implementing-optimistic-concurrency-with-the-sqldatasource-cs.md)</span><span class="sxs-lookup"><span data-stu-id="9dd98-267">[Previous](using-parameterized-queries-with-the-sqldatasource-cs.md)
[Next](implementing-optimistic-concurrency-with-the-sqldatasource-cs.md)</span></span>
