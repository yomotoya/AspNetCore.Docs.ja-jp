---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb
title: 挿入、更新、およびデータ (VB) の削除の概要 |Microsoft Docs
author: rick-anderson
description: このチュートリアルでは、ObjectDataSource の Insert()、Update() にマップする方法を見ていきます、構成する方法についても、BLL のメソッドに Delete() メソッドがクラスとしています.
ms.author: aspnetcontent
ms.date: 07/17/2006
ms.assetid: 35b40b8f-2ca8-4ab3-9c19-f361a91a3647
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb
msc.type: authoredcontent
ms.openlocfilehash: bd17d87d3fa82d8ef288ce4747876ecb53e3c625
ms.sourcegitcommit: b28cd0313af316c051c2ff8549865bff67f2fbb4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/05/2018
ms.locfileid: "37820299"
---
<a name="an-overview-of-inserting-updating-and-deleting-data-vb"></a><span data-ttu-id="55a60-103">挿入、更新、およびデータ (VB) の削除の概要</span><span class="sxs-lookup"><span data-stu-id="55a60-103">An Overview of Inserting, Updating, and Deleting Data (VB)</span></span>
====================
<span data-ttu-id="55a60-104">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="55a60-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="55a60-105">[サンプル アプリをダウンロード](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_16_VB.exe)または[PDF のダウンロード](an-overview-of-inserting-updating-and-deleting-data-vb/_static/datatutorial16vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="55a60-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_16_VB.exe) or [Download PDF](an-overview-of-inserting-updating-and-deleting-data-vb/_static/datatutorial16vb1.pdf)</span></span>

> <span data-ttu-id="55a60-106">このチュートリアルでは、ObjectDataSource の Insert()、Update() にマップする方法を見ていき、データ変更の機能を提供する GridView、DetailsView と FormView コントロールを構成する方法についても、BLL のメソッドに Delete() メソッドのクラスします。</span><span class="sxs-lookup"><span data-stu-id="55a60-106">In this tutorial we'll see how to map an ObjectDataSource's Insert(), Update(), and Delete() methods to the methods of BLL classes, as well as how to configure the GridView, DetailsView, and FormView controls to provide data modification capabilities.</span></span>


## <a name="introduction"></a><span data-ttu-id="55a60-107">はじめに</span><span class="sxs-lookup"><span data-stu-id="55a60-107">Introduction</span></span>

<span data-ttu-id="55a60-108">過去のいくつかのチュートリアルでは、GridView、DetailsView、FormView コントロールを使用して、ASP.NET ページにデータを表示する方法について説明しました。</span><span class="sxs-lookup"><span data-stu-id="55a60-108">Over the past several tutorials we've examined how to display data in an ASP.NET page using the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="55a60-109">これらのコントロールは、単に指定されたデータで動作します。</span><span class="sxs-lookup"><span data-stu-id="55a60-109">These controls simply work with data supplied to them.</span></span> <span data-ttu-id="55a60-110">一般的には、これらのコントロール、ObjectDataSource などのデータ ソース コントロールを使用してデータにアクセスします。</span><span class="sxs-lookup"><span data-stu-id="55a60-110">Commonly, these controls access data through the use of a data source control, such as the ObjectDataSource.</span></span> <span data-ttu-id="55a60-111">ObjectDataSource は ASP.NET ページと基になるデータの間のプロキシとして機能する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="55a60-111">We've seen how the ObjectDataSource acts as a proxy between the ASP.NET page and the underlying data.</span></span> <span data-ttu-id="55a60-112">GridView では、データを表示する必要があります、その ObjectDataSource が呼び出されます`Select()`メソッドから、ビジネス ロジック層 (BLL)、適切なデータ アクセス層の (DAL) のメソッドを呼び出したメソッドが呼び出されます、TableAdapter が送信されますが、`SELECT` Northwind データベースにクエリします。</span><span class="sxs-lookup"><span data-stu-id="55a60-112">When a GridView needs to display data, it invokes its ObjectDataSource's `Select()` method, which in turn invokes a method from our Business Logic Layer (BLL), which calls a method in the appropriate Data Access Layer's (DAL) TableAdapter, which in turn sends a `SELECT` query to the Northwind database.</span></span>

<span data-ttu-id="55a60-113">DAL で Tableadapter を作成したときにいずれ[、最初のチュートリアル](../introduction/creating-a-data-access-layer-cs.md)、Visual Studio が自動的に追加メソッドの挿入、更新、およびデータベース テーブルを基になるからデータを削除しています。</span><span class="sxs-lookup"><span data-stu-id="55a60-113">Recall that when we created the TableAdapters in the DAL in [our first tutorial](../introduction/creating-a-data-access-layer-cs.md), Visual Studio automatically added methods for inserting, updating, and deleting data from the underlying database table.</span></span> <span data-ttu-id="55a60-114">さらに、[ビジネス ロジック層を作成する](../introduction/creating-a-business-logic-layer-vb.md)これらのデータ変更 DAL メソッドにと呼ばれる BLL のメソッドを設計しました。</span><span class="sxs-lookup"><span data-stu-id="55a60-114">Moreover, in [Creating a Business Logic Layer](../introduction/creating-a-business-logic-layer-vb.md) we designed methods in the BLL that called down into these data modification DAL methods.</span></span>

<span data-ttu-id="55a60-115">加え、`Select()`メソッド、ObjectDataSource も`Insert()`、 `Update()`、および`Delete()`メソッド。</span><span class="sxs-lookup"><span data-stu-id="55a60-115">In addition to its `Select()` method, the ObjectDataSource also has `Insert()`, `Update()`, and `Delete()` methods.</span></span> <span data-ttu-id="55a60-116">ように、`Select()`メソッドでは、これら 3 つのメソッドは、基になるオブジェクトでメソッドにマップすることができます。</span><span class="sxs-lookup"><span data-stu-id="55a60-116">Like the `Select()` method, these three methods can be mapped to methods in an underlying object.</span></span> <span data-ttu-id="55a60-117">挿入、更新、またはデータを削除するように構成、GridView、DetailsView、FormView コントロールは、基になるデータを変更するためユーザー インターフェイスを提供します。</span><span class="sxs-lookup"><span data-stu-id="55a60-117">When configured to insert, update, or delete data, the GridView, DetailsView, and FormView controls provide a user interface for modifying the underlying data.</span></span> <span data-ttu-id="55a60-118">このユーザー インターフェイスを呼び出す、 `Insert()`、 `Update()`、および`Delete()`基になるオブジェクトを呼び出して、ObjectDataSource のメソッドに関連付けられているメソッド (図 1 参照)。</span><span class="sxs-lookup"><span data-stu-id="55a60-118">This user interface calls the `Insert()`, `Update()`, and `Delete()` methods of the ObjectDataSource, which then invoke the underlying object's associated methods (see Figure 1).</span></span>


<span data-ttu-id="55a60-119">[![ObjectDataSource の Insert()、Update()、および Delete() メソッド、BLL にプロキシとして機能します。](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image2.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="55a60-119">[![The ObjectDataSource's Insert(), Update(), and Delete() Methods Serve as a Proxy into the BLL](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image2.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image1.png)</span></span>

<span data-ttu-id="55a60-120">**図 1**:、ObjectDataSource の`Insert()`、 `Update()`、および`Delete()`メソッドは、BLL にプロキシとして機能 ([フルサイズの画像を表示する をクリックします](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image3.png))。</span><span class="sxs-lookup"><span data-stu-id="55a60-120">**Figure 1**: The ObjectDataSource's `Insert()`, `Update()`, and `Delete()` Methods Serve as a Proxy into the BLL ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image3.png))</span></span>


<span data-ttu-id="55a60-121">このチュートリアルでは ObjectDataSource をマップする方法を見ていきます`Insert()`、 `Update()`、および`Delete()`BLL とデータの変更を提供する GridView、DetailsView と FormView コントロールを構成する方法でクラスのメソッドをメソッド機能。</span><span class="sxs-lookup"><span data-stu-id="55a60-121">In this tutorial we'll see how to map the ObjectDataSource's `Insert()`, `Update()`, and `Delete()` methods to methods of classes in the BLL, as well as how to configure the GridView, DetailsView, and FormView controls to provide data modification capabilities.</span></span>

## <a name="step-1-creating-the-insert-update-and-delete-tutorials-web-pages"></a><span data-ttu-id="55a60-122">手順 1: Insert、Update、および Delete のチュートリアルの Web ページを作成します。</span><span class="sxs-lookup"><span data-stu-id="55a60-122">Step 1: Creating the Insert, Update, and Delete Tutorials Web Pages</span></span>

<span data-ttu-id="55a60-123">挿入、更新、およびデータを削除する方法の調査を始める前にまずみましょう。 このチュートリアルの次のいくつかの必要がありますが、web サイト プロジェクトで、ASP.NET ページを作成します。</span><span class="sxs-lookup"><span data-stu-id="55a60-123">Before we start exploring how to insert, update, and delete data, let's first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next several ones.</span></span> <span data-ttu-id="55a60-124">という名前の新しいフォルダーを追加することで開始`EditInsertDelete`します。</span><span class="sxs-lookup"><span data-stu-id="55a60-124">Start by adding a new folder named `EditInsertDelete`.</span></span> <span data-ttu-id="55a60-125">次に、次の ASP.NET ページを使用する各ページに関連付けることを確認、そのフォルダーに追加、`Site.master`マスター ページ。</span><span class="sxs-lookup"><span data-stu-id="55a60-125">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `Basics.aspx`
- `DataModificationEvents.aspx`
- `ErrorHandling.aspx`
- `UIValidation.aspx`
- `CustomizedUI.aspx`
- `OptimisticConcurrency.aspx`
- `ConfirmationOnDelete.aspx`
- `UserLevelAccess.aspx`


![データの変更に関連するチュートリアルについては、ASP.NET ページを追加します。](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image4.png)

<span data-ttu-id="55a60-127">**図 2**: データの変更に関連するチュートリアルについては、ASP.NET ページを追加</span><span class="sxs-lookup"><span data-stu-id="55a60-127">**Figure 2**: Add the ASP.NET Pages for the Data Modification-Related Tutorials</span></span>


<span data-ttu-id="55a60-128">などの他のフォルダーで`Default.aspx`で、`EditInsertDelete`フォルダーは、チュートリアルのセクションで一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="55a60-128">Like in the other folders, `Default.aspx` in the `EditInsertDelete` folder will list the tutorials in its section.</span></span> <span data-ttu-id="55a60-129">いることを思い出してください、`SectionLevelTutorialListing.ascx`ユーザー コントロールは、この機能を提供します。</span><span class="sxs-lookup"><span data-stu-id="55a60-129">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="55a60-130">そのため、このユーザー コントロールを追加`Default.aspx`ページの デザイン ビューの ソリューション エクスプ ローラーからドラッグしています。</span><span class="sxs-lookup"><span data-stu-id="55a60-130">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page's Design view.</span></span>


<span data-ttu-id="55a60-131">[![Default.aspx に SectionLevelTutorialListing.ascx ユーザー コントロールを追加します。](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image6.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="55a60-131">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image6.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image5.png)</span></span>

<span data-ttu-id="55a60-132">**図 3**: 追加、`SectionLevelTutorialListing.ascx`ユーザー コントロールを`Default.aspx`([フルサイズの画像を表示する をクリックします](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image7.png))。</span><span class="sxs-lookup"><span data-stu-id="55a60-132">**Figure 3**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image7.png))</span></span>


<span data-ttu-id="55a60-133">最後に、ページに追加するエントリとして、`Web.sitemap`ファイル。</span><span class="sxs-lookup"><span data-stu-id="55a60-133">Lastly, add the pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="55a60-134">具体的には、カスタマイズされた書式設定後、次のマークアップを追加`<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="55a60-134">Specifically, add the following markup after the Customized Formatting `<siteMapNode>`:</span></span>


[!code-xml[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample1.xml)]

<span data-ttu-id="55a60-135">更新した後`Web.sitemap`、時間、ブラウザーを使ってチュートリアル web サイトを表示するのにはかかりません。</span><span class="sxs-lookup"><span data-stu-id="55a60-135">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="55a60-136">左側のメニューには、編集、挿入、および削除のチュートリアルの項目が含まれています。</span><span class="sxs-lookup"><span data-stu-id="55a60-136">The menu on the left now includes items for the editing, inserting, and deleting tutorials.</span></span>


![サイト マップには、編集、挿入、および削除のチュートリアルのエントリが含まれますようになりました](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image8.png)

<span data-ttu-id="55a60-138">**図 4**: サイト マップには、編集、挿入、および削除のチュートリアルのエントリが含まれますようになりました</span><span class="sxs-lookup"><span data-stu-id="55a60-138">**Figure 4**: The Site Map Now Includes Entries for the Editing, Inserting, and Deleting Tutorials</span></span>


## <a name="step-2-adding-and-configuring-the-objectdatasource-control"></a><span data-ttu-id="55a60-139">手順 2: の追加と ObjectDataSource コントロールの構成</span><span class="sxs-lookup"><span data-stu-id="55a60-139">Step 2: Adding and Configuring the ObjectDataSource Control</span></span>

<span data-ttu-id="55a60-140">以降、GridView、DetailsView、およびフォーム ビューのデータ変更の機能とレイアウトにそれぞれが異なる、それぞれを個別に調べてみましょう。</span><span class="sxs-lookup"><span data-stu-id="55a60-140">Since the GridView, DetailsView, and FormView each differ in their data modification capabilities and layout, let's examine each one individually.</span></span> <span data-ttu-id="55a60-141">独自の ObjectDataSource を使用して各コントロールがあるのではなく、作成しましょう 3 つのコントロールのすべての例を共有できる単一の ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="55a60-141">Rather than have each control using its own ObjectDataSource, however, let's just create a single ObjectDataSource that all three control examples can share.</span></span>

<span data-ttu-id="55a60-142">開く、 `Basics.aspx`  ページで、ObjectDataSource をツールボックスからデザイナーにドラッグして、スマート タグからのデータ ソースの構成のリンクをクリックします。</span><span class="sxs-lookup"><span data-stu-id="55a60-142">Open the `Basics.aspx` page, drag an ObjectDataSource from the Toolbox onto the Designer, and click the Configure Data Source link from its smart tag.</span></span> <span data-ttu-id="55a60-143">以降、`ProductsBLL`は編集、挿入、および削除メソッドでは、このクラスを使用する ObjectDataSource を構成するだけの BLL クラスです。</span><span class="sxs-lookup"><span data-stu-id="55a60-143">Since the `ProductsBLL` is the only BLL class that provides editing, inserting, and deleting methods, configure the ObjectDataSource to use this class.</span></span>


<span data-ttu-id="55a60-144">[![ProductsBLL クラスを使用する ObjectDataSource を構成します。](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image10.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="55a60-144">[![Configure the ObjectDataSource to Use the ProductsBLL Class](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image10.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image9.png)</span></span>

<span data-ttu-id="55a60-145">**図 5**: 構成に使用する ObjectDataSource、`ProductsBLL`クラス ([フルサイズの画像を表示する をクリックします](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image11.png))。</span><span class="sxs-lookup"><span data-stu-id="55a60-145">**Figure 5**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image11.png))</span></span>


<span data-ttu-id="55a60-146">次の画面のどのような方法を指定できます、`ProductsBLL`クラスは、ObjectDataSource にマップされます`Select()`、 `Insert()`、`Update()`と`Delete()`適切なタブを選択し、ドロップダウン リストからメソッドを選択します。</span><span class="sxs-lookup"><span data-stu-id="55a60-146">In the next screen we can specify what methods of the `ProductsBLL` class are mapped to the ObjectDataSource's `Select()`, `Insert()`, `Update()`, and `Delete()` by selecting the appropriate tab and choosing the method from the drop-down list.</span></span> <span data-ttu-id="55a60-147">図 6 は、ここまでで見慣れた、ObjectDataSource のマップ`Select()`メソッドを`ProductsBLL`クラスの`GetProducts()`メソッド。</span><span class="sxs-lookup"><span data-stu-id="55a60-147">Figure 6, which should look familiar by now, maps the ObjectDataSource's `Select()` method to the `ProductsBLL` class's `GetProducts()` method.</span></span> <span data-ttu-id="55a60-148">`Insert()`、 `Update()`、および`Delete()`メソッドは、上部にある一覧から適切なタブを選択して構成できます。</span><span class="sxs-lookup"><span data-stu-id="55a60-148">The `Insert()`, `Update()`, and `Delete()` methods can be configured by selecting the appropriate tab from the list along the top.</span></span>


<span data-ttu-id="55a60-149">[![ObjectDataSource 返すすべての製品](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image13.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="55a60-149">[![Have the ObjectDataSource Return All of the Products](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image13.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image12.png)</span></span>

<span data-ttu-id="55a60-150">**図 6**: ObjectDataSource を返すすべての製品がある ([フルサイズの画像を表示する をクリックします](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image14.png))。</span><span class="sxs-lookup"><span data-stu-id="55a60-150">**Figure 6**: Have the ObjectDataSource Return All of the Products ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image14.png))</span></span>


<span data-ttu-id="55a60-151">図 7、8、および 9 ObjectDataSource の更新、挿入、および削除を表示するタブで行います。</span><span class="sxs-lookup"><span data-stu-id="55a60-151">Figures 7, 8, and 9 show the ObjectDataSource's UPDATE, INSERT, and DELETE tabs.</span></span> <span data-ttu-id="55a60-152">これらのタブを構成できるように、 `Insert()`、`Update()`と`Delete()`メソッドを呼び出す、`ProductsBLL`クラスの`UpdateProduct`、`AddProduct`と`DeleteProduct`メソッド、それぞれします。</span><span class="sxs-lookup"><span data-stu-id="55a60-152">Configure these tabs so that the `Insert()`, `Update()`, and `Delete()` methods invoke the `ProductsBLL` class's `UpdateProduct`, `AddProduct`, and `DeleteProduct` methods, respectively.</span></span>


<span data-ttu-id="55a60-153">[![ObjectDataSource の Update() メソッドを ProductBLL クラスの UpdateProduct メソッドにマップします。](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image16.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="55a60-153">[![Map the ObjectDataSource's Update() Method to the ProductBLL Class's UpdateProduct Method](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image16.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image15.png)</span></span>

<span data-ttu-id="55a60-154">**図 7**: マップ ObjectDataSource の`Update()`メソッドを`ProductBLL`クラスの`UpdateProduct`メソッド ([フルサイズの画像を表示する をクリックします](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image17.png))。</span><span class="sxs-lookup"><span data-stu-id="55a60-154">**Figure 7**: Map the ObjectDataSource's `Update()` Method to the `ProductBLL` Class's `UpdateProduct` Method ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image17.png))</span></span>


<span data-ttu-id="55a60-155">[![ObjectDataSource の Insert() メソッドを ProductBLL クラスの AddProduct メソッドにマップします。](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image19.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="55a60-155">[![Map the ObjectDataSource's Insert() Method to the ProductBLL Class's AddProduct Method](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image19.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image18.png)</span></span>

<span data-ttu-id="55a60-156">**図 8**: マップ ObjectDataSource の`Insert()`メソッドを`ProductBLL`クラスの追加`Product`メソッド ([フルサイズの画像を表示する をクリックします](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image20.png))。</span><span class="sxs-lookup"><span data-stu-id="55a60-156">**Figure 8**: Map the ObjectDataSource's `Insert()` Method to the `ProductBLL` Class's Add `Product` Method ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image20.png))</span></span>


<span data-ttu-id="55a60-157">[![ObjectDataSource の Delete() メソッドを ProductBLL クラスの DeleteProduct メソッドにマップします。](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image22.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="55a60-157">[![Map the ObjectDataSource's Delete() Method to the ProductBLL Class's DeleteProduct Method](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image22.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image21.png)</span></span>

<span data-ttu-id="55a60-158">**図 9**: マップ ObjectDataSource の`Delete()`メソッドを`ProductBLL`クラスの`DeleteProduct`メソッド ([フルサイズの画像を表示する をクリックします](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image23.png))。</span><span class="sxs-lookup"><span data-stu-id="55a60-158">**Figure 9**: Map the ObjectDataSource's `Delete()` Method to the `ProductBLL` Class's `DeleteProduct` Method ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image23.png))</span></span>


<span data-ttu-id="55a60-159">お気付き UPDATE、INSERT、および DELETE の各タブで、ドロップダウン リストが既に選択されているこれらのメソッドを持っています。</span><span class="sxs-lookup"><span data-stu-id="55a60-159">You may have noticed that the drop-down lists in the UPDATE, INSERT, and DELETE tabs already had these methods selected.</span></span> <span data-ttu-id="55a60-160">これを使用するのに協力してくれた、`DataObjectMethodAttribute`のメソッドを装飾する`ProducstBLL`します。</span><span class="sxs-lookup"><span data-stu-id="55a60-160">This is thanks to our use of the `DataObjectMethodAttribute` that decorates the methods of `ProducstBLL`.</span></span> <span data-ttu-id="55a60-161">たとえば、DeleteProduct メソッドは、次のシグネチャを持ちます。</span><span class="sxs-lookup"><span data-stu-id="55a60-161">For example, the DeleteProduct method has the following signature:</span></span>


[!code-vb[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample2.vb)]

<span data-ttu-id="55a60-162">`DataObjectMethodAttribute`属性を選択、挿入、更新、または削除およびかどうか、既定値は、各メソッドの目的を示します。</span><span class="sxs-lookup"><span data-stu-id="55a60-162">The `DataObjectMethodAttribute` attribute indicates the purpose of each method whether it is for selecting, inserting, updating, or deleting and whether or not it's the default value.</span></span> <span data-ttu-id="55a60-163">これらの属性を省略すると、BLL クラスを作成するときに、必要があります、更新プログラムからメソッドを手動で選択を挿入するしタブを削除します。</span><span class="sxs-lookup"><span data-stu-id="55a60-163">If you omitted these attributes when creating your BLL classes, you'll need to manually select the methods from the UPDATE, INSERT, and DELETE tabs.</span></span>

<span data-ttu-id="55a60-164">適切なことを確認した後は`ProductsBLL`メソッドは、ObjectDataSource にマップされます`Insert()`、`Update()`と`Delete()`メソッドは、ウィザードを完了するには、[完了] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="55a60-164">After ensuring that the appropriate `ProductsBLL` methods are mapped to the ObjectDataSource's `Insert()`, `Update()`, and `Delete()` methods, click Finish to complete the wizard.</span></span>

## <a name="examining-the-objectdatasources-markup"></a><span data-ttu-id="55a60-165">ObjectDataSource のマークアップを調べる</span><span class="sxs-lookup"><span data-stu-id="55a60-165">Examining the ObjectDataSource's Markup</span></span>

<span data-ttu-id="55a60-166">ObjectDataSource ウィザードを構成した後は、生成された宣言型マークアップを確認する、ソース ビューに移動します。</span><span class="sxs-lookup"><span data-stu-id="55a60-166">After configuring the ObjectDataSource through its wizard, go to the Source view to examine the generated declarative markup.</span></span> <span data-ttu-id="55a60-167">`<asp:ObjectDataSource>`タグは、基になるオブジェクトとメソッドを呼び出すを指定します。</span><span class="sxs-lookup"><span data-stu-id="55a60-167">The `<asp:ObjectDataSource>` tag specifies the underlying object and the methods to invoke.</span></span> <span data-ttu-id="55a60-168">さらに、ある`DeleteParameters`、 `UpdateParameters`、および`InsertParameters`の入力パラメーターにマップされる、`ProductsBLL`クラスの`AddProduct`、 `UpdateProduct`、および`DeleteProduct`メソッド。</span><span class="sxs-lookup"><span data-stu-id="55a60-168">Additionally, there are `DeleteParameters`, `UpdateParameters`, and `InsertParameters` that map to the input parameters for the `ProductsBLL` class's `AddProduct`, `UpdateProduct`, and `DeleteProduct` methods:</span></span>


[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample3.aspx)]

<span data-ttu-id="55a60-169">ObjectDataSource の一覧と同様に、その関連付けられているメソッドの入力パラメーターの各パラメーターが含まれる`SelectParameter`s が存在する入力パラメーターが必要とする選択メソッドを呼び出して、ObjectDataSource が構成されている場合 (など`GetProductsByCategoryID(categoryID)`).</span><span class="sxs-lookup"><span data-stu-id="55a60-169">The ObjectDataSource includes a parameter for each of the input parameters for its associated methods, just like a list of `SelectParameter` s is present when the ObjectDataSource is configured to call a select method that expects an input parameter (such as `GetProductsByCategoryID(categoryID)`).</span></span> <span data-ttu-id="55a60-170">ご覧のとおり、これらの値`DeleteParameters`、 `UpdateParameters`、および`InsertParameters`GridView、DetailsView、FormView して ObjectDataSource を呼び出す前に自動的に設定されます`Insert()`、 `Update()`、または`Delete()`メソッド。</span><span class="sxs-lookup"><span data-stu-id="55a60-170">As we'll see shortly, values for these `DeleteParameters`, `UpdateParameters`, and `InsertParameters` are set automatically by the GridView, DetailsView, and FormView prior to invoking the ObjectDataSource's `Insert()`, `Update()`, or `Delete()` method.</span></span> <span data-ttu-id="55a60-171">これらの値も設定できます必要に応じて、プログラムによって、今後のチュートリアルで後ほど説明します。</span><span class="sxs-lookup"><span data-stu-id="55a60-171">These values can also be set programmatically as needed, as we'll discuss in a future tutorial.</span></span>

<span data-ttu-id="55a60-172">ObjectDataSource するように構成ウィザードを使用する 1 つの副作用は、Visual Studio が設定される、 [OldValuesParameterFormatString プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.oldvaluesparameterformatstring(VS.80).aspx)に`original_{0}`します。</span><span class="sxs-lookup"><span data-stu-id="55a60-172">One side effect of using the wizard to configure to ObjectDataSource is that Visual Studio sets the [OldValuesParameterFormatString property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.oldvaluesparameterformatstring(VS.80).aspx) to `original_{0}`.</span></span> <span data-ttu-id="55a60-173">このプロパティの値は編集対象のデータの元の値を含めるために使用し、は 2 つのシナリオで役立ちます。</span><span class="sxs-lookup"><span data-stu-id="55a60-173">This property value is used to include the original values of the data being edited and is useful in two scenarios:</span></span>

- <span data-ttu-id="55a60-174">レコードを編集するには、ユーザーは主キーの値を変更できます。 場合、</span><span class="sxs-lookup"><span data-stu-id="55a60-174">If, when editing a record, users are able to change the primary key value.</span></span> <span data-ttu-id="55a60-175">この場合、新しい主キーの値と元のプライマリ キー値の両方必要があります指定する元のプライマリ キー値を持つレコードが見つかりませんを適宜更新されるよう、その値を持つようにします。</span><span class="sxs-lookup"><span data-stu-id="55a60-175">In this case, both the new primary key value and the original primary key value must be provided so that the record with the original primary key value can be found and have its value updated accordingly.</span></span>
- <span data-ttu-id="55a60-176">ときに、オプティミスティック同時実行制御を使用します。</span><span class="sxs-lookup"><span data-stu-id="55a60-176">When using optimistic concurrency.</span></span> <span data-ttu-id="55a60-177">オプティミスティック同時実行することを確認する 2 つの手法は、同時ユーザーは、1 つに相互の変更を上書きしないでくださいし、今後のチュートリアルのトピックでは、します。</span><span class="sxs-lookup"><span data-stu-id="55a60-177">Optimistic concurrency is a technique to ensure that two simultaneous users don't overwrite one another's changes, and is the topic for a future tutorial.</span></span>

<span data-ttu-id="55a60-178">`OldValuesParameterFormatString`プロパティは、基になるオブジェクトの更新プログラムと元の値を delete メソッドで、入力パラメーターの名前を示します。</span><span class="sxs-lookup"><span data-stu-id="55a60-178">The `OldValuesParameterFormatString` property indicates the name of the input parameters in the underlying object's update and delete methods for the original values.</span></span> <span data-ttu-id="55a60-179">オプティミスティック同時実行制御について説明している場合は、このプロパティは、さらに詳しくは、その目的について説明します。</span><span class="sxs-lookup"><span data-stu-id="55a60-179">We'll discuss this property and its purpose in greater detail when we explore optimistic concurrency.</span></span> <span data-ttu-id="55a60-180">起動します。 ここで、ただし、BLL のメソッドでは、元の値が予期しないであるため、このプロパティを削除重要なためです。</span><span class="sxs-lookup"><span data-stu-id="55a60-180">I bring it up now, however, because our BLL's methods do not expect the original values and therefore it's important that we remove this property.</span></span> <span data-ttu-id="55a60-181">終了、`OldValuesParameterFormatString`プロパティの既定値以外に設定 (`{0}`) データ Web コントロールが呼び出す ObjectDataSource のしようとしたときにエラーが発生`Update()`または`Delete()`メソッド、ObjectDataSource があるため両方に渡して、`UpdateParameters`または`DeleteParameters`元の値のパラメーターと共に指定されています。</span><span class="sxs-lookup"><span data-stu-id="55a60-181">Leaving the `OldValuesParameterFormatString` property set to anything other than the default (`{0}`) will cause an error when a data Web control attempts to invoke the ObjectDataSource's `Update()` or `Delete()` methods because the ObjectDataSource will attempt to pass in both the `UpdateParameters` or `DeleteParameters` specified as well as original value parameters.</span></span>

<span data-ttu-id="55a60-182">そうではそれほど明確この時点で、ご心配なく、今後のチュートリアルでこのプロパティは、そのユーティリティについて見ていきましょう。</span><span class="sxs-lookup"><span data-stu-id="55a60-182">If this isn't terribly clear at this juncture, don't worry, we'll examine this property and its utility in a future tutorial.</span></span> <span data-ttu-id="55a60-183">ここでは、だけにする宣言構文から完全にこのプロパティの宣言を削除するか、既定値に値を設定する ({0})。</span><span class="sxs-lookup"><span data-stu-id="55a60-183">For now, just be certain to either remove this property declaration entirely from the declarative syntax or set the value to the default value ({0}).</span></span>

> [!NOTE]
> <span data-ttu-id="55a60-184">だけオフにした場合、`OldValuesParameterFormatString`プロパティ [デザイン] ビューで [プロパティ] ウィンドウからプロパティ値が宣言の構文ではそのままが空の文字列に設定します。</span><span class="sxs-lookup"><span data-stu-id="55a60-184">If you simply clear out the `OldValuesParameterFormatString` property value from the Properties window in the Design view, the property will still exist in the declarative syntax, but be set to an empty string.</span></span> <span data-ttu-id="55a60-185">これには、残念ながら、引き続き、前に説明した同じ問題が発生されます。</span><span class="sxs-lookup"><span data-stu-id="55a60-185">This, unfortunately, will still result in the same problem discussed above.</span></span> <span data-ttu-id="55a60-186">そのため、削除するか完全宣言の構文から、または、[プロパティ] ウィンドウからプロパティ値を既定の`{0}`します。</span><span class="sxs-lookup"><span data-stu-id="55a60-186">Therefore, either remove the property altogether from the declarative syntax or, from the Properties window, set the value to the default, `{0}`.</span></span>


## <a name="step-3-adding-a-data-web-control-and-configuring-it-for-data-modification"></a><span data-ttu-id="55a60-187">手順 3: データ Web コントロールを追加して、データ変更のための構成</span><span class="sxs-lookup"><span data-stu-id="55a60-187">Step 3: Adding a Data Web Control and Configuring It for Data Modification</span></span>

<span data-ttu-id="55a60-188">ObjectDataSource は、ページに追加され、構成されているとは、両方は、データを表示し、エンドユーザーを修正するための手段を提供するページにデータ Web コントロールを追加する準備ができました。</span><span class="sxs-lookup"><span data-stu-id="55a60-188">Once the ObjectDataSource has been added to the page and configured, we're ready to add data Web controls to the page to both display the data and provide a means for the end user to modify it.</span></span> <span data-ttu-id="55a60-189">見て GridView、DetailsView、およびフォーム ビューとは別に、これらのデータ Web コントロールのデータ変更の機能と構成が異なるとします。</span><span class="sxs-lookup"><span data-stu-id="55a60-189">We'll look at the GridView, DetailsView, and FormView separately, as these data Web controls differ in their data modification capabilities and configuration.</span></span>

<span data-ttu-id="55a60-190">見て、この記事の残りの部分で非常に基本的な編集、挿入、および GridView、DetailsView、を通じてサポートを削除するを追加すると、コントロールと FormView コントロールは、実際に、いくつかのチェック ボックスをチェックだけです。</span><span class="sxs-lookup"><span data-stu-id="55a60-190">As we'll see in the remainder of this article, adding very basic editing, inserting, and deleting support through the GridView, DetailsView, and FormView controls is really as simple as checking a couple of checkboxes.</span></span> <span data-ttu-id="55a60-191">多くの細部とのみポイント アンド クリックしてより複雑なこのような機能を提供することで現実世界のエッジ ケースがあります。</span><span class="sxs-lookup"><span data-stu-id="55a60-191">There are many subtleties and edge cases in the real-world that make providing such functionality more involved than just point and click.</span></span> <span data-ttu-id="55a60-192">このチュートリアルは、単純なデータ変更の機能を証明するのみに焦点を当てています。</span><span class="sxs-lookup"><span data-stu-id="55a60-192">This tutorial, however, focuses solely on proving simplistic data modification capabilities.</span></span> <span data-ttu-id="55a60-193">今後のチュートリアルでは、必ず実際の設定で発生する問題を確認します。</span><span class="sxs-lookup"><span data-stu-id="55a60-193">Future tutorials will examine concerns that will undoubtedly arise in a real-world setting.</span></span>

## <a name="deleting-data-from-the-gridview"></a><span data-ttu-id="55a60-194">GridView からデータを削除します。</span><span class="sxs-lookup"><span data-stu-id="55a60-194">Deleting Data from the GridView</span></span>

<span data-ttu-id="55a60-195">GridView をツールボックスからデザイナーにドラッグして開始します。</span><span class="sxs-lookup"><span data-stu-id="55a60-195">Start by dragging a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="55a60-196">次に、GridView のスマート タグでドロップダウン リストから選択して、GridView を ObjectDataSource をバインドします。</span><span class="sxs-lookup"><span data-stu-id="55a60-196">Next, bind the ObjectDataSource to the GridView by selecting it from the drop-down list in the GridView's smart tag.</span></span> <span data-ttu-id="55a60-197">この時点で、GridView の宣言型マークアップになります。</span><span class="sxs-lookup"><span data-stu-id="55a60-197">At this point the GridView's declarative markup will be:</span></span>


[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample4.aspx)]

<span data-ttu-id="55a60-198">ObjectDataSource のスマート タグを GridView にバインドすると、2 つの利点があります。</span><span class="sxs-lookup"><span data-stu-id="55a60-198">Binding the GridView to the ObjectDataSource through its smart tag has two benefits:</span></span>

- <span data-ttu-id="55a60-199">BoundFields と CheckBoxFields は ObjectDataSource によって返されるフィールドの各自動的に作成されます。</span><span class="sxs-lookup"><span data-stu-id="55a60-199">BoundFields and CheckBoxFields are automatically created for each of the fields returned by the ObjectDataSource.</span></span> <span data-ttu-id="55a60-200">さらに、BoundField および CheckBoxField のプロパティは、基になるフィールドのメタデータに基づいて設定されます。</span><span class="sxs-lookup"><span data-stu-id="55a60-200">Moreover, the BoundField and CheckBoxField's properties are set based on the underlying field's metadata.</span></span> <span data-ttu-id="55a60-201">たとえば、 `ProductID`、`CategoryName`と`SupplierName`フィールドは読み取り専用とでマークされて、`ProductsDataTable`したがってすべき更新可能なを編集するときとします。</span><span class="sxs-lookup"><span data-stu-id="55a60-201">For example, the `ProductID`, `CategoryName`, and `SupplierName` fields are marked as read-only in the `ProductsDataTable` and therefore shouldn't be updatable when editing.</span></span> <span data-ttu-id="55a60-202">この、これらの BoundFields を対応するために[読み取り専用プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.readonly(VS.80).aspx)に設定されている`True`します。</span><span class="sxs-lookup"><span data-stu-id="55a60-202">To accommodate this, these BoundFields' [ReadOnly properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.readonly(VS.80).aspx) are set to `True`.</span></span>
- <span data-ttu-id="55a60-203">[DataKeyNames プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.datakeynames(VS.80).aspx)は基になるオブジェクトの主キー フィールドに割り当てられます。</span><span class="sxs-lookup"><span data-stu-id="55a60-203">The [DataKeyNames property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.datakeynames(VS.80).aspx) is assigned to the primary key field(s) of the underlying object.</span></span> <span data-ttu-id="55a60-204">これは、プロセスの編集または削除、データのフィールド (または一連のフィールド) に、このプロパティが示すとおり、GridView を使用している一意な各レコードを識別します。</span><span class="sxs-lookup"><span data-stu-id="55a60-204">This is essential when using the GridView for editing or deleting data, as this property indicates the field (or set of fields) that unique identifies each record.</span></span> <span data-ttu-id="55a60-205">詳細については、`DataKeyNames`プロパティに戻って、[マスター/詳細 DetailView で選択可能なマスター GridView の使用について詳しく説明](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md)チュートリアル。</span><span class="sxs-lookup"><span data-stu-id="55a60-205">For more information on the `DataKeyNames` property, refer back to the [Master/Detail Using a Selectable Master GridView with a Details DetailView](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md) tutorial.</span></span>

<span data-ttu-id="55a60-206">GridView は、[プロパティ] ウィンドウまたは宣言の構文を ObjectDataSource にバインドできます、そう必要があります手動で追加する適切な BoundField と`DataKeyNames`マークアップ。</span><span class="sxs-lookup"><span data-stu-id="55a60-206">While the GridView can be bound to the ObjectDataSource through the Properties window or declarative syntax, doing so requires you to manually add the appropriate BoundField and `DataKeyNames` markup.</span></span>

<span data-ttu-id="55a60-207">GridView コントロールは、行レベルの編集および削除するための組み込みサポートを提供します。</span><span class="sxs-lookup"><span data-stu-id="55a60-207">The GridView control provides built-in support for row-level editing and deleting.</span></span> <span data-ttu-id="55a60-208">構成の削除をサポートするために GridView 列の削除 ボタンを追加します。</span><span class="sxs-lookup"><span data-stu-id="55a60-208">Configuring a GridView to support deleting adds a column of Delete buttons.</span></span> <span data-ttu-id="55a60-209">エンドユーザーは、特定の行の削除 ボタンをクリックすると、ポストバックに陥ります、GridView は、次の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="55a60-209">When the end user clicks the Delete button for a particular row, a postback ensues and the GridView performs the following steps:</span></span>

1. <span data-ttu-id="55a60-210">ObjectDataSource の`DeleteParameters`値が割り当てられています。</span><span class="sxs-lookup"><span data-stu-id="55a60-210">The ObjectDataSource's `DeleteParameters` value(s) are assigned</span></span>
2. <span data-ttu-id="55a60-211">ObjectDataSource の`Delete()`メソッドが呼び出される、指定されたレコードを削除します。</span><span class="sxs-lookup"><span data-stu-id="55a60-211">The ObjectDataSource's `Delete()` method is invoked, deleting the specified record</span></span>
3. <span data-ttu-id="55a60-212">GridView を再バインド自体、ObjectDataSource を呼び出すことによってその`Select()`メソッド</span><span class="sxs-lookup"><span data-stu-id="55a60-212">The GridView rebinds itself to the ObjectDataSource by invoking its `Select()` method</span></span>

<span data-ttu-id="55a60-213">割り当てられた値、`DeleteParameters`の値は、`DataKeyNames`の Delete ボタンがクリックされた行のフィールド。</span><span class="sxs-lookup"><span data-stu-id="55a60-213">The values assigned to the `DeleteParameters` are the values of the `DataKeyNames` field(s) for the row whose Delete button was clicked.</span></span> <span data-ttu-id="55a60-214">したがってことが重要する GridView の`DataKeyNames`プロパティが正しく設定します。</span><span class="sxs-lookup"><span data-stu-id="55a60-214">Therefore it's vital that a GridView's `DataKeyNames` property be correctly set.</span></span> <span data-ttu-id="55a60-215">存在しない場合、`DeleteParameters`の値が割り当てられます`Nothing`手順 1 で、これには発生しません手順 2. で削除されたレコード。</span><span class="sxs-lookup"><span data-stu-id="55a60-215">If it's missing, the `DeleteParameters` will be assigned a value of `Nothing` in Step 1, which in turn will not result in any deleted records in Step 2.</span></span>

> [!NOTE]
> <span data-ttu-id="55a60-216">`DataKeys`つまり GridView のコントロールの状態でコレクションが格納された、`DataKeys`値は、GridView のビュー ステートが無効になっている場合でもポストバック間で記憶されます。</span><span class="sxs-lookup"><span data-stu-id="55a60-216">The `DataKeys` collection is stored in the GridView s control state, meaning that the `DataKeys` values will be remembered across postback even if the GridView s view state has been disabled.</span></span> <span data-ttu-id="55a60-217">ただし、編集または削除 (既定の動作) をサポートする Gridview のビュー ステートを有効のままことが非常に重要です。</span><span class="sxs-lookup"><span data-stu-id="55a60-217">However, it is very important that view state remains enabled for GridViews that support editing or deleting (the default behavior).</span></span> <span data-ttu-id="55a60-218">GridView 秒に設定した場合`EnableViewState`プロパティを`false`、編集と削除の動作は、1 人のユーザーを問題なく動作が、同時実行ユーザーがデータを削除する場合は、これらの同時実行ユーザーが誤ってが発生する可能性が存在するがあります削除または編集を記録するようにしなかった t 予定です。</span><span class="sxs-lookup"><span data-stu-id="55a60-218">If you set the GridView s `EnableViewState` property to `false`, the editing and deleting behavior will work fine for a single user, but if there are concurrent users deleting data, there exists the possibility that these concurrent users may accidentally delete or edit records that they didn t intend.</span></span> <span data-ttu-id="55a60-219">私のブログ記事を参照してください。[警告: 同時実行の問題を ASP.NET 2.0 Gridview と DetailsView/FormViews そのサポートを編集または削除およびをビュー ステートが無効になっている](http://scottonwriting.net/sowblog/posts/10054.aspx)、詳細についてはします。</span><span class="sxs-lookup"><span data-stu-id="55a60-219">See my blog entry, [WARNING: Concurrency Issue with ASP.NET 2.0 GridViews/DetailsView/FormViews that Support Editing and/or Deleting and Whose View State is Disabled](http://scottonwriting.net/sowblog/posts/10054.aspx), for more information.</span></span>


<span data-ttu-id="55a60-220">この同じ警告は、DetailsViews FormViews にも適用されます。</span><span class="sxs-lookup"><span data-stu-id="55a60-220">This same warning also applies to DetailsViews and FormViews.</span></span>

<span data-ttu-id="55a60-221">に GridView を削除する機能を追加するには、そのスマート タグに移動し、削除を有効にするチェック ボックスをオンします。</span><span class="sxs-lookup"><span data-stu-id="55a60-221">To add deleting capabilities to a GridView, simply go to its smart tag and check the Enable Deleting checkbox.</span></span>


![有効にする チェック ボックスを削除するを確認してください。](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image24.png)

<span data-ttu-id="55a60-223">**図 10**: 有効にする チェック ボックスを削除するを確認してください。</span><span class="sxs-lookup"><span data-stu-id="55a60-223">**Figure 10**: Check the Enable Deleting Checkbox</span></span>


<span data-ttu-id="55a60-224">GridView に、[commandfield] を追加するスマート タグから削除を有効にするチェック ボックスをオンします。</span><span class="sxs-lookup"><span data-stu-id="55a60-224">Checking the Enable Deleting checkbox from the smart tag adds a CommandField to the GridView.</span></span> <span data-ttu-id="55a60-225">[Commandfield] で、次のタスクの 1 つ以上を実行するためのボタンの GridView 列を表示します。 レコードの編集、レコードを削除するレコードを選択します。</span><span class="sxs-lookup"><span data-stu-id="55a60-225">The CommandField renders a column in the GridView with buttons for performing one or more of the following tasks: selecting a record, editing a record, and deleting a record.</span></span> <span data-ttu-id="55a60-226">以前の動作を内のレコードを選択すると [commandfield] を説明しました、[マスター/詳細の選択可能なマスター GridView を使用すると詳細 DetailView](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md)チュートリアル。</span><span class="sxs-lookup"><span data-stu-id="55a60-226">We previously saw the CommandField in action with selecting records in the [Master/Detail Using a Selectable Master GridView with a Details DetailView](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md) tutorial.</span></span>

<span data-ttu-id="55a60-227">[Commandfield] には数が含まれています`ShowXButton`プロパティを示す、[commandfield] でどのような一連のボタンが表示されます。</span><span class="sxs-lookup"><span data-stu-id="55a60-227">The CommandField contains a number of `ShowXButton` properties that indicate what series of buttons are displayed in the CommandField.</span></span> <span data-ttu-id="55a60-228">削除を有効にする、[commandfield] チェック ボックスをオンの`ShowDeleteButton`プロパティは`True`が GridView の列のコレクションに追加されました。</span><span class="sxs-lookup"><span data-stu-id="55a60-228">By checking the Enable Deleting checkbox a CommandField whose `ShowDeleteButton` property is `True` has been added to the GridView's Columns collection.</span></span>


[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample5.aspx)]

<span data-ttu-id="55a60-229">この時点では、信じられないかもしれませんが、終わって GridView に削除のサポートを追加してください。</span><span class="sxs-lookup"><span data-stu-id="55a60-229">At this point, believe it or not, we're done with adding deleting support to the GridView!</span></span> <span data-ttu-id="55a60-230">図 11 に示すようとブラウザーの削除 ボタンの列からこのページにアクセスが存在します。</span><span class="sxs-lookup"><span data-stu-id="55a60-230">As Figure 11 shows, when visiting this page through a browser a column of Delete buttons is present.</span></span>


<span data-ttu-id="55a60-231">[![Commandfield 列の削除 ボタンを追加します](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image26.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="55a60-231">[![The CommandField Adds a Column of Delete Buttons](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image26.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image25.png)</span></span>

<span data-ttu-id="55a60-232">**図 11**: [commandfield] ボタンを追加、列の削除 ([フルサイズの画像を表示する をクリックします](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image27.png))。</span><span class="sxs-lookup"><span data-stu-id="55a60-232">**Figure 11**: The CommandField Adds a Column of Delete Buttons ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image27.png))</span></span>


<span data-ttu-id="55a60-233">構築してきたこのチュートリアルを最初から自分でクリックすると、このページをテストするときに Delete ボタンに例外が発生します。</span><span class="sxs-lookup"><span data-stu-id="55a60-233">If you've been building this tutorial from the ground up on your own, when testing this page clicking the Delete button will raise an exception.</span></span> <span data-ttu-id="55a60-234">あとは、これらの例外が発生した理由とその解決方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="55a60-234">Continue reading to learn as to why these exceptions were raised and how to fix them.</span></span>

> [!NOTE]
> <span data-ttu-id="55a60-235">このチュートリアルに付属するダウンロードを使用してに沿ってフォローしている場合は、これらの問題が既にされて反映されます。</span><span class="sxs-lookup"><span data-stu-id="55a60-235">If you're following along using the download accompanying this tutorial, these problems have already been accounted for.</span></span> <span data-ttu-id="55a60-236">ただし、発生する可能性のある問題と適切な回避策を特定するのには以下の詳細を読み取ることはお勧めします。</span><span class="sxs-lookup"><span data-stu-id="55a60-236">However, I encourage you to read through the details listed below to help identify problems that may arise and suitable workarounds.</span></span>


<span data-ttu-id="55a60-237">メッセージがような例外が発生した商品を削除しようとすると場合は、"*ObjectDataSource 'ObjectDataSource1' 非ジェネリック メソッドのパラメーターを持つ ' DeleteProduct' が見つかりませんでした: productID、元\_ProductID*、"を削除し忘れた可能性があります、 `OldValuesParameterFormatString` ObjectDataSource からのプロパティ。</span><span class="sxs-lookup"><span data-stu-id="55a60-237">If, when attempting to delete a product, you get an exception whose message is similar to "*ObjectDataSource 'ObjectDataSource1' could not find a non-generic method 'DeleteProduct' that has parameters: productID, original\_ProductID*," you likely forgot to remove the `OldValuesParameterFormatString` property from the ObjectDataSource.</span></span> <span data-ttu-id="55a60-238">`OldValuesParameterFormatString`プロパティが指定されて、ObjectDataSource が両方に渡そう`productID`と`original_ProductID`に対する入力パラメーターは、`DeleteProduct`メソッド。</span><span class="sxs-lookup"><span data-stu-id="55a60-238">With the `OldValuesParameterFormatString` property specified, the ObjectDataSource attempts to pass in both `productID` and `original_ProductID` input parameters to the `DeleteProduct` method.</span></span> <span data-ttu-id="55a60-239">`DeleteProduct`、ただし、のみ 1 つ入力パラメーターを受け取り、そのため、例外。</span><span class="sxs-lookup"><span data-stu-id="55a60-239">`DeleteProduct`, however, only accepts a single input parameter, hence the exception.</span></span> <span data-ttu-id="55a60-240">削除、`OldValuesParameterFormatString`プロパティ (またはに設定すると`{0}`)、ObjectDataSource を元の入力パラメーターを渡すよう指示します。</span><span class="sxs-lookup"><span data-stu-id="55a60-240">Removing the `OldValuesParameterFormatString` property (or setting it to `{0}`) instructs the ObjectDataSource to not attempt to pass in the original input parameter.</span></span>


<span data-ttu-id="55a60-241">[![OldValuesParameterFormatString プロパティがクリアされたことを確認します。](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image29.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="55a60-241">[![Ensure That the OldValuesParameterFormatString Property Has Been Cleared Out](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image29.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image28.png)</span></span>

<span data-ttu-id="55a60-242">**図 12**: いることを確認、`OldValuesParameterFormatString`プロパティがされたクリア Out ([フルサイズの画像を表示する をクリックします](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image30.png))。</span><span class="sxs-lookup"><span data-stu-id="55a60-242">**Figure 12**: Ensure That the `OldValuesParameterFormatString` Property Has Been Cleared Out ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image30.png))</span></span>


<span data-ttu-id="55a60-243">削除した場合でも、`OldValuesParameterFormatString`プロパティはそれでも例外メッセージで商品を削除しようとするとき:"*DELETE ステートメントと競合して参照制約 ' FK\_順序\_の詳細\_製品の*"。Northwind データベースには間の外部キー制約が含まれています、`Order Details`と`Products`で 1 つまたは複数のレコードがある場合、製品をシステムから削除できないことを意味しているテーブル、`Order Details`テーブル。</span><span class="sxs-lookup"><span data-stu-id="55a60-243">Even if you had removed the `OldValuesParameterFormatString` property, you still will get an exception when trying to delete a product with the message: "*The DELETE statement conflicted with the REFERENCE constraint 'FK\_Order\_Details\_Products'*." The Northwind database contains a foreign key constraint between the `Order Details` and `Products` table, meaning that a product cannot be deleted from the system if there are one or more records for it in the `Order Details` table.</span></span> <span data-ttu-id="55a60-244">Northwind データベースのすべての製品少なくとも 1 つのレコードを持つため`Order Details`製品、製品の関連付けられている注文の詳細レコードを削除する最初まで削除できません。</span><span class="sxs-lookup"><span data-stu-id="55a60-244">Since every product in the Northwind database has at least one record in `Order Details`, we cannot delete any products until we first delete the product's associated order details records.</span></span>


<span data-ttu-id="55a60-245">[![外部キー制約には、製品の削除が禁止されています](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image32.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="55a60-245">[![A Foreign Key Constraint Prohibits the Deletion of Products](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image32.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image31.png)</span></span>

<span data-ttu-id="55a60-246">**図 13**: 外部キー制約には、製品の削除が禁止されています ([フルサイズの画像を表示する をクリックします](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image33.png))。</span><span class="sxs-lookup"><span data-stu-id="55a60-246">**Figure 13**: A Foreign Key Constraint Prohibits the Deletion of Products ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image33.png))</span></span>


<span data-ttu-id="55a60-247">このチュートリアルでは、削除のすべてのレコードから、`Order Details`テーブル。</span><span class="sxs-lookup"><span data-stu-id="55a60-247">For our tutorial, let's just delete all of the records from the `Order Details` table.</span></span> <span data-ttu-id="55a60-248">実際のアプリケーションでは、いずれかに必要があります。</span><span class="sxs-lookup"><span data-stu-id="55a60-248">In a real-world application we'd need to either:</span></span>

- <span data-ttu-id="55a60-249">別の画面が注文の詳細情報を管理するには</span><span class="sxs-lookup"><span data-stu-id="55a60-249">Have another screen to manage order details information</span></span>
- <span data-ttu-id="55a60-250">拡張、`DeleteProduct`メソッドを指定された製品の注文の詳細を削除するロジックを含める</span><span class="sxs-lookup"><span data-stu-id="55a60-250">Augment the `DeleteProduct` method to include logic to delete the specified product's order details</span></span>
- <span data-ttu-id="55a60-251">TableAdapter を指定された製品の注文の詳細の削除を含めるために使用する SQL クエリを変更します。</span><span class="sxs-lookup"><span data-stu-id="55a60-251">Modify the SQL query used by the TableAdapter to include deletion of the specified product's order details</span></span>

<span data-ttu-id="55a60-252">削除のすべてのレコードから、`Order Details`テーブルの外部キー制約を回避するためにします。</span><span class="sxs-lookup"><span data-stu-id="55a60-252">Let's just delete all of the records from the `Order Details` table to circumvent the foreign key constraint.</span></span> <span data-ttu-id="55a60-253">Visual Studio でサーバー エクスプ ローラーに移動しを右クリックし、`NORTHWND.MDF`ノード、新しいクエリを選択します。</span><span class="sxs-lookup"><span data-stu-id="55a60-253">Go to the Server Explorer in Visual Studio, right-click on the `NORTHWND.MDF` node, and choose New Query.</span></span> <span data-ttu-id="55a60-254">次に、クエリ ウィンドウでは、次の SQL ステートメントを実行します。 `DELETE FROM [Order Details]`</span><span class="sxs-lookup"><span data-stu-id="55a60-254">Then, in the query window, run the following SQL statement: `DELETE FROM [Order Details]`</span></span>


<span data-ttu-id="55a60-255">[![受注明細テーブルからすべてのレコードを削除します。](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image35.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="55a60-255">[![Delete All Records from the Order Details Table](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image35.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image34.png)</span></span>

<span data-ttu-id="55a60-256">**図 14**: すべてのレコードを削除、`Order Details`テーブル ([フルサイズの画像を表示する をクリックします](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image36.png))。</span><span class="sxs-lookup"><span data-stu-id="55a60-256">**Figure 14**: Delete All Records from the `Order Details` Table ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image36.png))</span></span>


<span data-ttu-id="55a60-257">消去した後に、`Order Details`テーブルの削除 ボタンをクリックするとエラーが発生せず、製品が削除されます。</span><span class="sxs-lookup"><span data-stu-id="55a60-257">After clearing out the `Order Details` table clicking on the Delete button will delete the product without error.</span></span> <span data-ttu-id="55a60-258">GridView のことを確認する場合は、[削除] ボタンをクリックすると、製品が削除されることはできませんが確認`DataKeyNames`プロパティが主キー フィールドに設定 (`ProductID`)。</span><span class="sxs-lookup"><span data-stu-id="55a60-258">If clicking on the Delete button does not delete the product, check to ensure that the GridView's `DataKeyNames` property is set to the primary key field (`ProductID`).</span></span>

> [!NOTE]
> <span data-ttu-id="55a60-259">[Delete] ボタンをクリックすると、ポストバックに陥りますされ、レコードが削除されます。</span><span class="sxs-lookup"><span data-stu-id="55a60-259">When clicking on the Delete button a postback ensues and the record is deleted.</span></span> <span data-ttu-id="55a60-260">これは、誤って間違った行の削除 ボタンをクリックする簡単であるため危険であります。</span><span class="sxs-lookup"><span data-stu-id="55a60-260">This can be dangerous since it is easy to accidentally click on the wrong row's Delete button.</span></span> <span data-ttu-id="55a60-261">今後のチュートリアルでは、レコードを削除するときに、クライアント側の確認を追加する方法を表示されます。</span><span class="sxs-lookup"><span data-stu-id="55a60-261">In a future tutorial we'll see how to add a client-side confirmation when deleting a record.</span></span>


## <a name="editing-data-with-the-gridview"></a><span data-ttu-id="55a60-262">GridView を使用してデータを編集</span><span class="sxs-lookup"><span data-stu-id="55a60-262">Editing Data with the GridView</span></span>

<span data-ttu-id="55a60-263">GridView コントロールには、削除、と共に組み込みの行レベルの編集機能も提供します。</span><span class="sxs-lookup"><span data-stu-id="55a60-263">Along with deleting, the GridView control also provides built-in row-level editing support.</span></span> <span data-ttu-id="55a60-264">構成の編集をサポートする GridView 編集ボタンの列を追加します。</span><span class="sxs-lookup"><span data-stu-id="55a60-264">Configuring a GridView to support editing adds a column of Edit buttons.</span></span> <span data-ttu-id="55a60-265">行の編集 ボタンの原因に編集可能になる行をクリックすると、エンドユーザーの観点からは、既存の値を格納していると、更新プログラムの編集 ボタンと キャンセル ボタンを置換するテキスト ボックスに、セルにすること。</span><span class="sxs-lookup"><span data-stu-id="55a60-265">From the end user's perspective, clicking a row's Edit button causes that row to become editable, turning the cells into textboxes containing the existing values and replacing the Edit button with Update and Cancel buttons.</span></span> <span data-ttu-id="55a60-266">必要な変更を行った後、エンドユーザーは、変更をコミットする更新プログラムのボタンまたは [キャンセル] ボタンをクリックして破棄するクリックできます。</span><span class="sxs-lookup"><span data-stu-id="55a60-266">After making their desired changes, the end user can click the Update button to commit the changes or the Cancel button to discard them.</span></span> <span data-ttu-id="55a60-267">Update または [キャンセル] をクリックした後をどちらの場合、GridView は、編集済みの状態に戻ります。</span><span class="sxs-lookup"><span data-stu-id="55a60-267">In either case, after clicking Update or Cancel the GridView returns to its pre-editing state.</span></span>

<span data-ttu-id="55a60-268">ページの開発者としてマイクロソフトの展望からは、ポストバックに陥ります、エンドユーザーは、特定の行の編集 ボタンをクリックすると、し、GridView は、次の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="55a60-268">From our perspective as the page developer, when the end user clicks the Edit button for a particular row, a postback ensues and the GridView performs the following steps:</span></span>

1. <span data-ttu-id="55a60-269">GridView の`EditItemIndex`プロパティがある編集ボタンがクリックされた行のインデックスに割り当てられています。</span><span class="sxs-lookup"><span data-stu-id="55a60-269">The GridView's `EditItemIndex` property is assigned to the index of the row whose Edit button was clicked</span></span>
2. <span data-ttu-id="55a60-270">GridView を再バインド自体、ObjectDataSource を呼び出すことによってその`Select()`メソッド</span><span class="sxs-lookup"><span data-stu-id="55a60-270">The GridView rebinds itself to the ObjectDataSource by invoking its `Select()` method</span></span>
3. <span data-ttu-id="55a60-271">一致する行インデックス、 `EditItemIndex` 「編集モード」で表示される。</span><span class="sxs-lookup"><span data-stu-id="55a60-271">The row index that matches the `EditItemIndex` is rendered in "edit mode."</span></span> <span data-ttu-id="55a60-272">このモードで編集 ボタンは、更新のキャンセル ボタンと BoundFields に置換されますが`ReadOnly`プロパティが False (既定値) テキスト ボックスに Web コントロールとしてレンダリングされます`Text`プロパティは、データ フィールドの値に割り当てられています。</span><span class="sxs-lookup"><span data-stu-id="55a60-272">In this mode, the Edit button is replaced by Update and Cancel buttons and BoundFields whose `ReadOnly` properties are False (the default) are rendered as TextBox Web controls whose `Text` properties are assigned to the data fields' values.</span></span>

<span data-ttu-id="55a60-273">この時点で、マークアップは、エンドユーザーに行のデータを変更する、ブラウザーに返されます。</span><span class="sxs-lookup"><span data-stu-id="55a60-273">At this point the markup is returned to the browser, allowing the end user to make any changes to the row's data.</span></span> <span data-ttu-id="55a60-274">ユーザーは、[更新] ボタンをクリックすると、ポストバックが発生し、GridView は、次の手順を実行します。</span><span class="sxs-lookup"><span data-stu-id="55a60-274">When the user clicks the Update button, a postback occurs and the GridView performs the following steps:</span></span>

1. <span data-ttu-id="55a60-275">ObjectDataSource の`UpdateParameters`値には、エンドユーザーが GridView の編集インターフェイスに入力した値が割り当てられます</span><span class="sxs-lookup"><span data-stu-id="55a60-275">The ObjectDataSource's `UpdateParameters` value(s) are assigned the values entered by the end user into the GridView's editing interface</span></span>
2. <span data-ttu-id="55a60-276">ObjectDataSource の`Update()`メソッドが呼び出される、指定されたレコードを更新しています</span><span class="sxs-lookup"><span data-stu-id="55a60-276">The ObjectDataSource's `Update()` method is invoked, updating the specified record</span></span>
3. <span data-ttu-id="55a60-277">GridView を再バインド自体、ObjectDataSource を呼び出すことによってその`Select()`メソッド</span><span class="sxs-lookup"><span data-stu-id="55a60-277">The GridView rebinds itself to the ObjectDataSource by invoking its `Select()` method</span></span>

<span data-ttu-id="55a60-278">割り当てられている主キーの値、`UpdateParameters`手順 1. で指定された値から取得、`DataKeyNames`プロパティが編集された行の TextBox Web コントロールのテキストを取得する非プライマリ キー値。</span><span class="sxs-lookup"><span data-stu-id="55a60-278">The primary key values assigned to the `UpdateParameters` in Step 1 come from the values specified in the `DataKeyNames` property, whereas the non-primary key values come from the text in the TextBox Web controls for the edited row.</span></span> <span data-ttu-id="55a60-279">削除するには、必須を GridView の`DataKeyNames`プロパティが正しく設定します。</span><span class="sxs-lookup"><span data-stu-id="55a60-279">As with deleting, it is vital that a GridView's `DataKeyNames` property be correctly set.</span></span> <span data-ttu-id="55a60-280">存在しない場合、`UpdateParameters`主キーの値の値が割り当てられている`Nothing`手順 1 で、これには発生しません手順 2 で更新されたレコード。</span><span class="sxs-lookup"><span data-stu-id="55a60-280">If it's missing, the `UpdateParameters` primary key value will be assigned a value of `Nothing` in Step 1, which in turn will not result in any updated records in Step 2.</span></span>

<span data-ttu-id="55a60-281">GridView のスマート タグの編集を有効にするチェック ボックスをチェックするだけでは、編集機能をアクティブ化することができます。</span><span class="sxs-lookup"><span data-stu-id="55a60-281">Editing functionality can be activated by simply checking the Enable Editing checkbox in the GridView's smart tag.</span></span>


![確認のチェック ボックスの編集を有効にします。](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image37.png)

<span data-ttu-id="55a60-283">**図 15**: チェック ボックスの編集を有効にするを確認してください。</span><span class="sxs-lookup"><span data-stu-id="55a60-283">**Figure 15**: Check the Enable Editing Checkbox</span></span>


<span data-ttu-id="55a60-284">編集を有効にする チェック ボックスは、(必要な) 場合、commandfield に追加されますをチェックし、セット、`ShowEditButton`プロパティを`True`します。</span><span class="sxs-lookup"><span data-stu-id="55a60-284">Checking the Enable Editing checkbox will add a CommandField (if needed) and set its `ShowEditButton` property to `True`.</span></span> <span data-ttu-id="55a60-285">[Commandfield] には数が含まれています前述のように、`ShowXButton`プロパティを示す、[commandfield] でどのような一連のボタンが表示されます。</span><span class="sxs-lookup"><span data-stu-id="55a60-285">As we saw earlier, the CommandField contains a number of `ShowXButton` properties that indicate what series of buttons are displayed in the CommandField.</span></span> <span data-ttu-id="55a60-286">追加の編集を有効にするチェック ボックスをオン、`ShowEditButton`プロパティを既存の [commandfield]。</span><span class="sxs-lookup"><span data-stu-id="55a60-286">Checking the Enable Editing checkbox adds the `ShowEditButton` property to the existing CommandField:</span></span>


[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample6.aspx)]

<span data-ttu-id="55a60-287">ですが基本的な編集のサポートを追加します。</span><span class="sxs-lookup"><span data-stu-id="55a60-287">That's all there is to adding rudimentary editing support.</span></span> <span data-ttu-id="55a60-288">編集インターフェイスはかなりおおざっぱ Figure16 に示す各 BoundField が`ReadOnly`プロパティに設定されて`False`(既定値) は、テキスト ボックスとしてレンダリングされます。</span><span class="sxs-lookup"><span data-stu-id="55a60-288">As Figure16 shows, the editing interface is rather crude each BoundField whose `ReadOnly` property is set to `False` (the default) is rendered as a TextBox.</span></span> <span data-ttu-id="55a60-289">などのフィールドが含まれます`CategoryID`と`SupplierID`、他のテーブルにキーであります。</span><span class="sxs-lookup"><span data-stu-id="55a60-289">This includes fields like `CategoryID` and `SupplierID`, which are keys to other tables.</span></span>


<span data-ttu-id="55a60-290">[![Chai の編集ボタンをクリックして編集モードで、行を表示します](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image39.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="55a60-290">[![Clicking Chai s Edit Button Displays the Row in Edit Mode](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image39.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image38.png)</span></span>

<span data-ttu-id="55a60-291">**図 16**: Chai の をクリックして [編集] ボタンが編集モードで、行を表示します ([フルサイズの画像を表示する をクリックします](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image40.png))。</span><span class="sxs-lookup"><span data-stu-id="55a60-291">**Figure 16**: Clicking Chai s Edit Button Displays the Row in Edit Mode ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image40.png))</span></span>


<span data-ttu-id="55a60-292">外部キーの値を直接編集するユーザーを確認するだけでなく、編集インターフェイスのインターフェイスは、次の方法で不足しています。</span><span class="sxs-lookup"><span data-stu-id="55a60-292">In addition to asking users to edit foreign key values directly, the editing interface's interface is lacking in the following ways:</span></span>

- <span data-ttu-id="55a60-293">ユーザーが入力した場合、`CategoryID`または`SupplierID`、データベースに存在しない、`UPDATE`例外が発生する外部キー制約に違反します。</span><span class="sxs-lookup"><span data-stu-id="55a60-293">If the user enters a `CategoryID` or `SupplierID` that does not exist in the database, the `UPDATE` will violate a foreign key constraint, causing an exception to be raised.</span></span>
- <span data-ttu-id="55a60-294">編集インターフェイスには、いずれかの検証が含まれていません。</span><span class="sxs-lookup"><span data-stu-id="55a60-294">The editing interface doesn't include any validation.</span></span> <span data-ttu-id="55a60-295">必要な値を指定しない場合 (など`ProductName`)、または文字列値を入力します (「あまり!」を入力するなど、数値が必要な場合</span><span class="sxs-lookup"><span data-stu-id="55a60-295">If you don't provide a required value (such as `ProductName`), or enter a string value where a numeric value is expected (such as entering "Too much!"</span></span> <span data-ttu-id="55a60-296">`UnitPrice` textbox)、例外がスローされます。</span><span class="sxs-lookup"><span data-stu-id="55a60-296">into the `UnitPrice` textbox), an exception will be thrown.</span></span> <span data-ttu-id="55a60-297">今後のチュートリアルでは、編集のユーザー インターフェイスに検証コントロールを追加する方法を説明します。</span><span class="sxs-lookup"><span data-stu-id="55a60-297">A future tutorial will examine how to add validation controls to the editing user interface.</span></span>
- <span data-ttu-id="55a60-298">現時点では、*すべて*GridView で読み取り専用ではない製品フィールドを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="55a60-298">Currently, *all* product fields that are not read-only must be included in the GridView.</span></span> <span data-ttu-id="55a60-299">GridView からフィールドを削除する場合、たとえば`UnitPrice`GridView データの更新が設定されていない場合、 `UnitPrice` `UpdateParameters`値で、変更、データベース レコードの`UnitPrice`を`NULL`値。</span><span class="sxs-lookup"><span data-stu-id="55a60-299">If we were to remove a field from the GridView, say `UnitPrice`, when updating the data the GridView would not set the `UnitPrice` `UpdateParameters` value, which would change the database record's `UnitPrice` to a `NULL` value.</span></span> <span data-ttu-id="55a60-300">同様に必須のフィールドの場合など`ProductName`、削除は、GridView から更新プログラムは同じで失敗"*列 'ProductName' が null を許容しない*"上記で説明した例外。</span><span class="sxs-lookup"><span data-stu-id="55a60-300">Similarly, if a required field, such as `ProductName`, is removed from the GridView, the update will fail with the same "*Column 'ProductName' does not allow nulls*" exception mentioned above.</span></span>
- <span data-ttu-id="55a60-301">編集のインターフェイスの書式設定が望ましい場合に多くのままです。</span><span class="sxs-lookup"><span data-stu-id="55a60-301">The editing interface formatting leaves a lot to be desired.</span></span> <span data-ttu-id="55a60-302">`UnitPrice`付き 10 進数の 4 つの点で示されます。</span><span class="sxs-lookup"><span data-stu-id="55a60-302">The `UnitPrice` is shown with four decimal points.</span></span> <span data-ttu-id="55a60-303">理想的には、`CategoryID`と`SupplierID`値には、カテゴリと仕入先をシステムで一覧した Dropdownlist にが含まれます。</span><span class="sxs-lookup"><span data-stu-id="55a60-303">Ideally the `CategoryID` and `SupplierID` values would contain DropDownLists that list the categories and suppliers in the system.</span></span>

<span data-ttu-id="55a60-304">これらの現在のところですが我慢する必要がありますすべての欠点は、今後のチュートリアルで対処される予定です。</span><span class="sxs-lookup"><span data-stu-id="55a60-304">These are all shortcomings that we'll have to live with for now, but will be addressed in future tutorials.</span></span>

## <a name="inserting-editing-and-deleting-data-with-the-detailsview"></a><span data-ttu-id="55a60-305">挿入、編集、および DetailsView を使用してデータを削除します。</span><span class="sxs-lookup"><span data-stu-id="55a60-305">Inserting, Editing, and Deleting Data with the DetailsView</span></span>

<span data-ttu-id="55a60-306">前述したように、前のチュートリアルでは、DetailsView コントロールは一度に 1 つのレコードを表示でき、GridView のように編集および現在表示されているレコードの削除します。</span><span class="sxs-lookup"><span data-stu-id="55a60-306">As we've seen in earlier tutorials, the DetailsView control displays one record at a time and, like the GridView, allows for editing and deleting of the currently displayed record.</span></span> <span data-ttu-id="55a60-307">両方のエンド ユーザー エクスペリエンスを編集してから、DetailsView と ASP.NET の側からのワークフロー項目の削除は、GridView のと同じです。</span><span class="sxs-lookup"><span data-stu-id="55a60-307">Both the end user's experience with editing and deleting items from a DetailsView and the workflow from the ASP.NET side is identical to that of the GridView.</span></span> <span data-ttu-id="55a60-308">GridView、DetailsView とは異なるが、挿入の組み込みのサポートも提供します。</span><span class="sxs-lookup"><span data-stu-id="55a60-308">Where the DetailsView differs from the GridView is that it also provides built-in inserting support.</span></span>

<span data-ttu-id="55a60-309">GridView のデータ変更機能を示すためを開始する、DetailsView を追加することで、`Basics.aspx`ページ上の既存の GridView および DetailsView のスマート タグを既存の ObjectDataSource にバインドします。</span><span class="sxs-lookup"><span data-stu-id="55a60-309">To demonstrate the data modification capabilities of the GridView, start by adding a DetailsView to the `Basics.aspx` page above the existing GridView and bind it to the existing ObjectDataSource through the DetailsView's smart tag.</span></span> <span data-ttu-id="55a60-310">次に、DetailsView をクリアします`Height`と`Width`プロパティ、およびスマート タグからページングを有効にするオプションのチェック ボックス。</span><span class="sxs-lookup"><span data-stu-id="55a60-310">Next, clear out the DetailsView's `Height` and `Width` properties, and check the Enable Paging option from the smart tag.</span></span> <span data-ttu-id="55a60-311">編集を有効にするには、挿入、および削除のサポート、単純にチェック ボックスを編集の有効化、挿入を有効にするには、および削除を有効にするスマート タグの。</span><span class="sxs-lookup"><span data-stu-id="55a60-311">To enable editing, inserting, and deleting support, simply check the Enable Editing, Enable Inserting, and Enable Deleting checkboxes in the smart tag.</span></span>


![編集、挿入、および削除をサポートする DetailsView を構成します。](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image41.png)

<span data-ttu-id="55a60-313">**図 17**: 編集、挿入、および削除をサポートする DetailsView を構成します。</span><span class="sxs-lookup"><span data-stu-id="55a60-313">**Figure 17**: Configure the DetailsView to Support Editing, Inserting, and Deleting</span></span>


<span data-ttu-id="55a60-314">として、GridView、編集、追加で挿入、または削除のサポートとして追加します、CommandField、DetailsView を宣言型構文を次に示します。</span><span class="sxs-lookup"><span data-stu-id="55a60-314">As with the GridView, adding editing, inserting, or deleting support adds a CommandField to the DetailsView, as the following declarative syntax shows:</span></span>


[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample7.aspx)]

<span data-ttu-id="55a60-315">DetailsView、[commandfield] の既定の列コレクションの末尾に表示されるに注意してください。</span><span class="sxs-lookup"><span data-stu-id="55a60-315">Note that for the DetailsView the CommandField appears at the end of the Columns collection by default.</span></span> <span data-ttu-id="55a60-316">DetailsView のフィールドとしてレンダリングされるので、行が編集、および DetailsView の下部にあるボタンを削除、[commandfield] は、挿入、行として表示されます。</span><span class="sxs-lookup"><span data-stu-id="55a60-316">Since the DetailsView's fields are rendered as rows, the CommandField appears as a row with Insert, Edit, and Delete buttons at the bottom of the DetailsView.</span></span>


<span data-ttu-id="55a60-317">[![編集、挿入、および削除をサポートする DetailsView を構成します。](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image43.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="55a60-317">[![Configure the DetailsView to Support Editing, Inserting, and Deleting](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image43.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image42.png)</span></span>

<span data-ttu-id="55a60-318">**図 18**: サポートの編集、挿入、および削除に DetailsView を構成する ([フルサイズの画像を表示する をクリックします](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image44.png))。</span><span class="sxs-lookup"><span data-stu-id="55a60-318">**Figure 18**: Configure the DetailsView to Support Editing, Inserting, and Deleting ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image44.png))</span></span>


<span data-ttu-id="55a60-319">GridView と同様、同じイベントのシーケンスを開始する [Delete] ボタンをクリックします。 をポストバックします。設定の ObjectDataSource の DetailsView 続けて`DeleteParameters`に基づいて、 `DataKeyNames` ; の値し、その ObjectDataSource の呼び出しで完了`Delete()`メソッドで、実際には、データベースから製品を削除します。</span><span class="sxs-lookup"><span data-stu-id="55a60-319">Clicking on the Delete button starts the same sequence of events as with the GridView: a postback; followed by the DetailsView populating its ObjectDataSource's `DeleteParameters` based on the `DataKeyNames` values; and completed with a call its ObjectDataSource's `Delete()` method, which actually removes the product from the database.</span></span> <span data-ttu-id="55a60-320">GridView の場合と同じ方法で動作も、DetailsView で編集します。</span><span class="sxs-lookup"><span data-stu-id="55a60-320">Editing in the DetailsView also works in a fashion identical to that of the GridView.</span></span>

<span data-ttu-id="55a60-321">挿入すると、エンドユーザーが表示されます、新規のボタンをクリックすると、「挿入モード。」DetailsView を表示します。</span><span class="sxs-lookup"><span data-stu-id="55a60-321">For inserting, the end user is presented with a New button that, when clicked, renders the DetailsView in "insert mode."</span></span> <span data-ttu-id="55a60-322">挿入し、[キャンセル] ボタンとそれらの BoundFields のみを置き換えては「挿入モード」の新しいボタンが`InsertVisible`プロパティに設定されて`True`(既定値) が表示されます。</span><span class="sxs-lookup"><span data-stu-id="55a60-322">With "insert mode" the New button is replaced by Insert and Cancel buttons and only those BoundFields whose `InsertVisible` property is set to `True` (the default) are displayed.</span></span> <span data-ttu-id="55a60-323">など、自動インクリメント フィールドとして識別されるデータ フィールド`ProductID`がその[InsertVisible プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datacontrolfield.insertvisible(VS.80).aspx)に設定`False`DetailsView をスマート タグによってデータ ソースにバインドする場合。</span><span class="sxs-lookup"><span data-stu-id="55a60-323">Those data fields identified as auto-increment fields, such as `ProductID`, have their [InsertVisible property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datacontrolfield.insertvisible(VS.80).aspx) set to `False` when binding the DetailsView to the data source through the smart tag.</span></span>

<span data-ttu-id="55a60-324">Visual Studio の設定でスマート タグの DetailsView をデータ ソースをバインドするときに、`InsertVisible`プロパティを`False`自動インクリメント フィールドに対してのみです。</span><span class="sxs-lookup"><span data-stu-id="55a60-324">When binding a data source to a DetailsView through the smart tag, Visual Studio sets the `InsertVisible` property to `False` only for auto-increment fields.</span></span> <span data-ttu-id="55a60-325">読み取り専用のフィールドのような`CategoryName`と`SupplierName`、しない限り、「insert モード」のユーザー インターフェイスに表示されます、`InsertVisible`プロパティ明示的に`False`します。</span><span class="sxs-lookup"><span data-stu-id="55a60-325">Read-only fields, like `CategoryName` and `SupplierName`, will be displayed in the "insert mode" user interface unless their `InsertVisible` property is explicitly set to `False`.</span></span> <span data-ttu-id="55a60-326">これら 2 つのフィールドを設定する少し`InsertVisible`プロパティ`False`、スマート タグのリンクを DetailsView の宣言構文またはフィールドを編集します。</span><span class="sxs-lookup"><span data-stu-id="55a60-326">Take a moment to set these two fields' `InsertVisible` properties to `False`, either through the DetailsView's declarative syntax or through the Edit Fields link in the smart tag.</span></span> <span data-ttu-id="55a60-327">図 19 の設定の表示、`InsertVisible`プロパティを`False`編集フィールドをクリックしてリンクします。</span><span class="sxs-lookup"><span data-stu-id="55a60-327">Figure 19 shows setting the `InsertVisible` properties to `False` by clicking on the Edit Fields link.</span></span>


<span data-ttu-id="55a60-328">[![Northwind Traders Acme 紅茶を提供します。](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image46.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="55a60-328">[![Northwind Traders Now Offers Acme Tea](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image46.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image45.png)</span></span>

<span data-ttu-id="55a60-329">**図 19**: Northwind Traders ここでは、Acme 紅茶 ([フルサイズの画像を表示する をクリックします](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image47.png))。</span><span class="sxs-lookup"><span data-stu-id="55a60-329">**Figure 19**: Northwind Traders Now Offers Acme Tea ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image47.png))</span></span>


<span data-ttu-id="55a60-330">設定した後、`InsertVisible`プロパティ、ビュー、`Basics.aspx`ブラウザーでページし、新しいボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="55a60-330">After setting the `InsertVisible` properties, view the `Basics.aspx` page in a browser and click the New button.</span></span> <span data-ttu-id="55a60-331">新しい飲み物の場合は、追加するときに、図 20 は、DetailsView を示しています、製品ラインの Acme 紅茶します。</span><span class="sxs-lookup"><span data-stu-id="55a60-331">Figure 20 shows the DetailsView when adding a new beverage, Acme Tea, to our product line.</span></span>


<span data-ttu-id="55a60-332">[![Northwind Traders Acme 紅茶を提供します。](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image49.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image48.png)</span><span class="sxs-lookup"><span data-stu-id="55a60-332">[![Northwind Traders Now Offers Acme Tea](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image49.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image48.png)</span></span>

<span data-ttu-id="55a60-333">**図 20**: Northwind Traders ここでは、Acme 紅茶 ([フルサイズの画像を表示する をクリックします](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image50.png))。</span><span class="sxs-lookup"><span data-stu-id="55a60-333">**Figure 20**: Northwind Traders Now Offers Acme Tea ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image50.png))</span></span>


<span data-ttu-id="55a60-334">ポストバックに陥ります Acme 紅茶の詳細を入力し、[挿入] ボタンをクリックするとに新しいレコードを追加、`Products`データベース テーブル。</span><span class="sxs-lookup"><span data-stu-id="55a60-334">After entering the details for Acme Tea and clicking the Insert button, a postback ensues and the new record is added to the `Products` database table.</span></span> <span data-ttu-id="55a60-335">この DetailsView では、データベース テーブルに存在する順序で製品が一覧表示、ために必要がありますページ最後の製品、新製品を表示するには。</span><span class="sxs-lookup"><span data-stu-id="55a60-335">Since this DetailsView lists the products in order with which they exist in the database table, we must page to the last product in order to see the new product.</span></span>


<span data-ttu-id="55a60-336">[![Acme 紅茶の詳細](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image52.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image51.png)</span><span class="sxs-lookup"><span data-stu-id="55a60-336">[![Details for Acme Tea](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image52.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image51.png)</span></span>

<span data-ttu-id="55a60-337">**図 21**: Acme 紅茶の詳細 ([フルサイズの画像を表示する をクリックします](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image53.png))。</span><span class="sxs-lookup"><span data-stu-id="55a60-337">**Figure 21**: Details for Acme Tea ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image53.png))</span></span>


> [!NOTE]
> <span data-ttu-id="55a60-338">DetailsView の[CurrentMode プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.currentmode(VS.80).aspx)表示されているインターフェイスを示し、値は次のいずれかを指定できます: `Edit`、 `Insert`、または`ReadOnly`します。</span><span class="sxs-lookup"><span data-stu-id="55a60-338">The DetailsView's [CurrentMode property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.currentmode(VS.80).aspx) indicates the interface being displayed and can be one of the following values: `Edit`, `Insert`, or `ReadOnly`.</span></span> <span data-ttu-id="55a60-339">[DefaultMode プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.defaultmode(VS.80).aspx)を示し、DetailsView、編集後に戻るか、または挿入モードが完了したは、DetailsView は完全に編集または挿入モードを表示するために便利です。</span><span class="sxs-lookup"><span data-stu-id="55a60-339">The [DefaultMode property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.defaultmode(VS.80).aspx) indicates the mode the DetailsView returns to after an edit or insert has been completed and is useful for displaying a DetailsView that is permanently in edit or insert mode.</span></span>


<span data-ttu-id="55a60-340">ポイント アンド クリックを挿入して、編集、DetailsView の機能は、GridView と同じ制限に悩まさ: 既存のユーザーが入力する必要があります`CategoryID`と`SupplierID`値がテキスト ボックスではインターフェイスに検証ロジックはすべて製品のフィールドを許可しない`NULL`値または既定値がありません。 挿入のインターフェイスを示すでは、データベース レベルで指定された値を含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="55a60-340">The point and click inserting and editing capabilities of the DetailsView suffer from the same limitations as the GridView: the user must enter existing `CategoryID` and `SupplierID` values through a textbox; the interface lacks any validation logic; all product fields that do not allow `NULL` values or don't have a default value specified at the database level must be included in the inserting interface, and so on.</span></span>

<span data-ttu-id="55a60-341">手法を拡張および強化、GridView の編集インターフェイス今後の記事は、DetailsView コントロールの編集および挿入インターフェイスにもに適用できるため、考察します。</span><span class="sxs-lookup"><span data-stu-id="55a60-341">The techniques we will examine for extending and enhancing the GridView's editing interface in future articles can be applied to the DetailsView control's editing and inserting interfaces as well.</span></span>

## <a name="using-the-formview-for-a-more-flexible-data-modification-user-interface"></a><span data-ttu-id="55a60-342">FormView を使用してより柔軟なデータ変更のユーザー インターフェイス</span><span class="sxs-lookup"><span data-stu-id="55a60-342">Using the FormView for a More Flexible Data Modification User Interface</span></span>

<span data-ttu-id="55a60-343">FormView のデータの削除、挿入、編集、および組み込みのサポートを提供していますが、フィールドではなくテンプレートを使用しているため、BoundFields または GridView および DetailsView コントロールでデータを提供するために使用する [commandfield] を追加する場所はありません。変更のインターフェイス。</span><span class="sxs-lookup"><span data-stu-id="55a60-343">The FormView offers built-in support for inserting, editing, and deleting data, but because it uses templates instead of fields there's no place to add the BoundFields or the CommandField used by the GridView and DetailsView controls to provide the data modification interface.</span></span> <span data-ttu-id="55a60-344">代わりに、ユーザーを収集するための Web コントロール、新しい項目を追加するときに入力または編集、削除、挿入、更新、およびキャンセル ボタン、新規と既存のリソースの編集は、このインターフェイスは、適切なテンプレートを手動で追加する必要があります。</span><span class="sxs-lookup"><span data-stu-id="55a60-344">Instead, this interface the Web controls for collecting user input when adding a new item or editing an existing one along with the New, Edit, Delete, Insert, Update, and Cancel buttons must be added manually to the appropriate templates.</span></span> <span data-ttu-id="55a60-345">幸いにも、Visual Studio が自動的に作成、必要なインターフェイスのスマート タグで、ドロップダウン リストをデータ ソースに、フォーム ビューをバインドする場合。</span><span class="sxs-lookup"><span data-stu-id="55a60-345">Fortunately, Visual Studio will automatically create the needed interface when binding the FormView to a data source through the drop-down list in its smart tag.</span></span>

<span data-ttu-id="55a60-346">これらの手法を示すためを起動するフォーム ビューを追加することで、`Basics.aspx`ページし、FormView のスマート タグから既に作成されて ObjectDataSource にバインドします。</span><span class="sxs-lookup"><span data-stu-id="55a60-346">To illustrate these techniques, start by adding a FormView to the `Basics.aspx` page and, from the FormView's smart tag, bind it to the ObjectDataSource already created.</span></span> <span data-ttu-id="55a60-347">これが生成されます、 `EditItemTemplate`、 `InsertItemTemplate`、および`ItemTemplate`新規ユーザーの入力と Web のボタン コントロールを収集するためのテキスト ボックスに Web コントロールと FormView、編集、削除、挿入、更新、およびキャンセル ボタン。</span><span class="sxs-lookup"><span data-stu-id="55a60-347">This will generate an `EditItemTemplate`, `InsertItemTemplate`, and `ItemTemplate` for the FormView with TextBox Web controls for collecting the user's input and Button Web controls for the New, Edit, Delete, Insert, Update, and Cancel buttons.</span></span> <span data-ttu-id="55a60-348">さらに、FormView の`DataKeyNames`プロパティが主キー フィールドに設定 (`ProductID`) の ObjectDataSource によって返されるオブジェクト。</span><span class="sxs-lookup"><span data-stu-id="55a60-348">Additionally, the FormView's `DataKeyNames` property is set to the primary key field (`ProductID`) of the object returned by the ObjectDataSource.</span></span> <span data-ttu-id="55a60-349">最後に、フォーム ビューのスマート タグでページングを有効にするオプションを確認します。</span><span class="sxs-lookup"><span data-stu-id="55a60-349">Lastly, check the Enable Paging option in the FormView's smart tag.</span></span>

<span data-ttu-id="55a60-350">FormView の宣言型マークアップを次に示します`ItemTemplate`FormView、ObjectDataSource にバインドした後。</span><span class="sxs-lookup"><span data-stu-id="55a60-350">The following shows the declarative markup for the FormView's `ItemTemplate` after the FormView has been bound to the ObjectDataSource.</span></span> <span data-ttu-id="55a60-351">既定では各非ブール値の product フィールドにバインドされて、`Text`ブール値の各フィールドの中に、ラベルの Web コントロールのプロパティ (`Discontinued`) にバインドされて、`Checked`無効になっているチェック ボックスを Web コントロールのプロパティ。</span><span class="sxs-lookup"><span data-stu-id="55a60-351">By default, each non-Boolean value product field is bound to the `Text` property of a Label Web control while each Boolean value field (`Discontinued`) is bound to the `Checked` property of a disabled CheckBox Web control.</span></span> <span data-ttu-id="55a60-352">新規、編集、および Delete ボタンがクリックされたときに特定のフォーム ビューの動作をトリガーするためは命令型を`CommandName`設定値は`New`、`Edit`と`Delete`、それぞれします。</span><span class="sxs-lookup"><span data-stu-id="55a60-352">In order for the New, Edit, and Delete buttons to trigger certain FormView behavior when clicked, it is imperative that their `CommandName` values be set to `New`, `Edit`, and `Delete`, respectively.</span></span>


[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample8.aspx)]

<span data-ttu-id="55a60-353">図 22 示します FormView の`ItemTemplate`とき、ブラウザーで表示します。</span><span class="sxs-lookup"><span data-stu-id="55a60-353">Figure 22 shows the FormView's `ItemTemplate` when viewed through a browser.</span></span> <span data-ttu-id="55a60-354">下部にある、新規、編集、および Delete ボタンを持つ製品の各フィールドが表示されます。</span><span class="sxs-lookup"><span data-stu-id="55a60-354">Each product field is listed with the New, Edit, and Delete buttons at the bottom.</span></span>


<span data-ttu-id="55a60-355">[![照合 FormView ItemTemplate と共に新しい各 Product フィールドを一覧表示、編集、およびボタンの削除](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image55.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image54.png)</span><span class="sxs-lookup"><span data-stu-id="55a60-355">[![The Defaut FormView ItemTemplate Lists Each Product Field Along with New, Edit, and Delete Buttons](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image55.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image54.png)</span></span>

<span data-ttu-id="55a60-356">**図 22**: The 照合 FormView`ItemTemplate`一覧各製品フィールドに沿った新規、編集、削除ボタンと ([フルサイズの画像を表示する をクリックします](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image56.png))。</span><span class="sxs-lookup"><span data-stu-id="55a60-356">**Figure 22**: The Defaut FormView `ItemTemplate` Lists Each Product Field Along with New, Edit, and Delete Buttons ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image56.png))</span></span>


<span data-ttu-id="55a60-357">GridView と DetailsView を削除 ボタン、LinkButton や ImageButton をクリックすると使用するようなある`CommandName`プロパティは、削除の原因にポストバックを設定、ObjectDataSource を設定します`DeleteParameters`FormView のに基づいて`DataKeyNames`。値、および呼び出す ObjectDataSource の`Delete()`メソッド。</span><span class="sxs-lookup"><span data-stu-id="55a60-357">Like with the GridView and DetailsView, clicking the Delete button or any Button, LinkButton, or ImageButton whose `CommandName` property is set to Delete causes a postback, populates the ObjectDataSource's `DeleteParameters` based on the FormView's `DataKeyNames` value, and invokes the ObjectDataSource's `Delete()` method.</span></span>

<span data-ttu-id="55a60-358">ポストバック後し、にデータが再バインドの編集 ボタンがクリックされたときに、 `EditItemTemplate`、これはデータの編集インターフェイスをレンダリングします。</span><span class="sxs-lookup"><span data-stu-id="55a60-358">When the Edit button is clicked a postback ensues and the data is rebound to the `EditItemTemplate`, which is responsible for rendering the editing interface.</span></span> <span data-ttu-id="55a60-359">このインターフェイスには、更新、およびキャンセル ボタンと共にデータを編集するための Web コントロールが含まれています。</span><span class="sxs-lookup"><span data-stu-id="55a60-359">This interface includes the Web controls for editing data along with the Update and Cancel buttons.</span></span> <span data-ttu-id="55a60-360">既定の`EditItemTemplate`によって生成された Visual Studio には、自動インクリメント フィールドのラベルが含まれています (`ProductID`)、各非ブール値フィールドのテキスト ボックスおよびブール値の各フィールドのチェック ボックスをオンします。</span><span class="sxs-lookup"><span data-stu-id="55a60-360">The default `EditItemTemplate` generated by Visual Studio contains a Label for any auto-increment fields (`ProductID`), a TextBox for each non-Boolean value field, and a CheckBox for each Boolean value field.</span></span> <span data-ttu-id="55a60-361">この動作は、GridView および DetailsView コントロールで自動生成された BoundFields に非常に似ています。</span><span class="sxs-lookup"><span data-stu-id="55a60-361">This behavior is very similar to the auto-generated BoundFields in the GridView and DetailsView controls.</span></span>

> [!NOTE]
> <span data-ttu-id="55a60-362">1 つのフォーム ビューの自動生成に関する問題、`EditItemTemplate`がレンダリングされるテキスト ボックスに Web コントロールは読み取り専用、ようにこれらのフィールドを`CategoryName`と`SupplierName`します。</span><span class="sxs-lookup"><span data-stu-id="55a60-362">One small issue with the FormView's auto-generation of the `EditItemTemplate` is that it renders TextBox Web controls for those fields that are read-only, such as `CategoryName` and `SupplierName`.</span></span> <span data-ttu-id="55a60-363">これを考慮する方法を見てすぐします。</span><span class="sxs-lookup"><span data-stu-id="55a60-363">We'll see how to account for this shortly.</span></span>


<span data-ttu-id="55a60-364">コントロールをテキスト ボックス、`EditItemTemplate`がその`Text`プロパティの対応するフィールドを使用してデータの値にバインドされて*双方向データ バインド*します。</span><span class="sxs-lookup"><span data-stu-id="55a60-364">The TextBox controls in the `EditItemTemplate` have their `Text` property bound to the value of their corresponding data field using *two-way databinding*.</span></span> <span data-ttu-id="55a60-365">表される、双方向データ バインド`<%# Bind("dataField") %>`テンプレートにデータをバインドする際、および挿入またはレコードの編集の ObjectDataSource のパラメーターを設定するときに、両方のデータをバインドを実行します。</span><span class="sxs-lookup"><span data-stu-id="55a60-365">Two-way databinding, denoted by `<%# Bind("dataField") %>`, performs databinding both when binding data to the template and when populating the ObjectDataSource's parameters for inserting or editing records.</span></span> <span data-ttu-id="55a60-366">つまり、ユーザーがから [編集] ボタンをクリックすると、 `ItemTemplate`、`Bind()`メソッドは、指定したデータ フィールドの値を返します。</span><span class="sxs-lookup"><span data-stu-id="55a60-366">That is, when the user clicks the Edit button from the `ItemTemplate`, the `Bind()` method returns the specified data field value.</span></span> <span data-ttu-id="55a60-367">ユーザーは、変更を行い、更新プログラムをクリックして後の値がポスト バックされた対応するデータ フィールドを使用して指定する`Bind()`ObjectDataSource に適用される`UpdateParameters`します。</span><span class="sxs-lookup"><span data-stu-id="55a60-367">After the user makes their changes and clicks Update, the values posted back that correspond to the data fields specified using `Bind()` are applied to the ObjectDataSource's `UpdateParameters`.</span></span> <span data-ttu-id="55a60-368">代わりに、一方向のデータ バインドで示されています。 `<%# Eval("dataField") %>`、のみ、テンプレートにデータをバインドするときに、データ フィールドの値を取得およびは*いない*ポストバック時に、データ ソースのパラメーターにユーザーが入力した値を返します。</span><span class="sxs-lookup"><span data-stu-id="55a60-368">Alternatively, one-way databinding, denoted by `<%# Eval("dataField") %>`, only retrieves the data field values when binding data to the template and does *not* return the user-entered values to the data source's parameters on postback.</span></span>

<span data-ttu-id="55a60-369">次の宣言型マークアップ示します FormView の`EditItemTemplate`します。</span><span class="sxs-lookup"><span data-stu-id="55a60-369">The following declarative markup shows the FormView's `EditItemTemplate`.</span></span> <span data-ttu-id="55a60-370">なお、`Bind()`メソッドは、データ バインドの構文で使用し、更新プログラムおよびキャンセル ボタンの Web コントロールがその`CommandName`プロパティを適宜設定します。</span><span class="sxs-lookup"><span data-stu-id="55a60-370">Note that the `Bind()` method is used in the databinding syntax here and that the Update and Cancel Button Web controls have their `CommandName` properties set accordingly.</span></span>


[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample9.aspx)]

<span data-ttu-id="55a60-371">この`EditItemTemplate`、これを使用する場合にスローされる例外が発生、ポイントします。</span><span class="sxs-lookup"><span data-stu-id="55a60-371">Our `EditItemTemplate`, at this point, will cause an exception to be thrown if we attempt to use it.</span></span> <span data-ttu-id="55a60-372">問題なは、`CategoryName`と`SupplierName`内のテキスト ボックスに Web コントロールとして、フィールドが表示される、`EditItemTemplate`します。</span><span class="sxs-lookup"><span data-stu-id="55a60-372">The problem is that the `CategoryName` and `SupplierName` fields are rendered as TextBox Web controls in the `EditItemTemplate`.</span></span> <span data-ttu-id="55a60-373">か、これらのテキスト ボックスをラベルに変更するか、それらを完全に削除する必要があります。</span><span class="sxs-lookup"><span data-stu-id="55a60-373">We either need to change these TextBoxes to Labels or remove them altogether.</span></span> <span data-ttu-id="55a60-374">単に削除から完全に、`EditItemTemplate`します。</span><span class="sxs-lookup"><span data-stu-id="55a60-374">Let's simply delete them entirely from the `EditItemTemplate`.</span></span>

<span data-ttu-id="55a60-375">図 23 Chai の編集 ボタンがクリックしてされた後に、ブラウザーで、フォーム ビューを示しています。</span><span class="sxs-lookup"><span data-stu-id="55a60-375">Figure 23 shows the FormView in a browser after the Edit button has been clicked for Chai.</span></span> <span data-ttu-id="55a60-376">なお、`SupplierName`と`CategoryName`で表示されるフィールド、`ItemTemplate`だけから削除しましたが存在する場合は、不要になった、`EditItemTemplate`します。</span><span class="sxs-lookup"><span data-stu-id="55a60-376">Note that the `SupplierName` and `CategoryName` fields shown in the `ItemTemplate` are no longer present, as we just removed them from the `EditItemTemplate`.</span></span> <span data-ttu-id="55a60-377">[更新] ボタンがクリックされたときに、FormView GridView および DetailsView コントロールとして同じ一連の手順を進めします。</span><span class="sxs-lookup"><span data-stu-id="55a60-377">When the Update button is clicked the FormView proceeds through the same sequence of steps as the GridView and DetailsView controls.</span></span>


<span data-ttu-id="55a60-378">[![既定で、後に各編集可能な製品フィールドをテキスト ボックスまたはチェック ボックスが表示されます。](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image58.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image57.png)</span><span class="sxs-lookup"><span data-stu-id="55a60-378">[![By Default the EditItemTemplate Shows Each Editable Product Field as a TextBox or CheckBox](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image58.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image57.png)</span></span>

<span data-ttu-id="55a60-379">**図 23**: 既定では、`EditItemTemplate`示します各編集可能な製品フィールドとしてテキスト ボックスまたはチェック ボックスをオン ([フルサイズの画像を表示する をクリックします](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image59.png))。</span><span class="sxs-lookup"><span data-stu-id="55a60-379">**Figure 23**: By Default the `EditItemTemplate` Shows Each Editable Product Field as a TextBox or CheckBox ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image59.png))</span></span>


<span data-ttu-id="55a60-380">[挿入] ボタンに FormView がクリックされたとき`ItemTemplate`ポストバックに陥ります。</span><span class="sxs-lookup"><span data-stu-id="55a60-380">When the Insert button is clicked the FormView's `ItemTemplate` a postback ensues.</span></span> <span data-ttu-id="55a60-381">ただし、データがバインドされていない、FormView に新しいレコードが追加されるためです。</span><span class="sxs-lookup"><span data-stu-id="55a60-381">However, no data is bound to the FormView because a new record is being added.</span></span> <span data-ttu-id="55a60-382">`InsertItemTemplate`インターフェイスに挿入し、[キャンセル] ボタンと新しいレコードを追加するための Web コントロールが含まれています。</span><span class="sxs-lookup"><span data-stu-id="55a60-382">The `InsertItemTemplate` interface includes the Web controls for adding a new record along with the Insert and Cancel buttons.</span></span> <span data-ttu-id="55a60-383">既定の`InsertItemTemplate`によって生成された Visual Studio には、各非ブール値フィールド、テキスト ボックスと自動生成されるように各ブール値フィールドのチェック ボックスが含まれています。`EditItemTemplate`のインターフェイス。</span><span class="sxs-lookup"><span data-stu-id="55a60-383">The default `InsertItemTemplate` generated by Visual Studio contains a TextBox for each non-Boolean value field and a CheckBox for each Boolean value field, similar to the auto-generated `EditItemTemplate`'s interface.</span></span> <span data-ttu-id="55a60-384">テキスト ボックス コントロールがその`Text`双方向データ バインドを使用して、対応するデータ フィールドの値にバインドされているプロパティ。</span><span class="sxs-lookup"><span data-stu-id="55a60-384">The TextBox controls have their `Text` property bound to the value of their corresponding data field using two-way databinding.</span></span>

<span data-ttu-id="55a60-385">次の宣言型マークアップ示します FormView の`InsertItemTemplate`します。</span><span class="sxs-lookup"><span data-stu-id="55a60-385">The following declarative markup shows the FormView's `InsertItemTemplate`.</span></span> <span data-ttu-id="55a60-386">なお、`Bind()`メソッドは、データ バインドの構文で使用し、Insert およびキャンセル ボタンの Web コントロールがその`CommandName`プロパティを適宜設定します。</span><span class="sxs-lookup"><span data-stu-id="55a60-386">Note that the `Bind()` method is used in the databinding syntax here and that the Insert and Cancel Button Web controls have their `CommandName` properties set accordingly.</span></span>


[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-vb/samples/sample10.aspx)]

<span data-ttu-id="55a60-387">FormView の自動世代の注意が必要です、`InsertItemTemplate`します。</span><span class="sxs-lookup"><span data-stu-id="55a60-387">There's a subtlety with the FormView's auto-generation of the `InsertItemTemplate`.</span></span> <span data-ttu-id="55a60-388">読み取り専用、ようにこれらのフィールドの場合でも、テキスト ボックスに Web コントロールを作成する具体的には、`CategoryName`と`SupplierName`します。</span><span class="sxs-lookup"><span data-stu-id="55a60-388">Specifically, the TextBox Web controls are created even for those fields that are read-only, such as `CategoryName` and `SupplierName`.</span></span> <span data-ttu-id="55a60-389">使用するような`EditItemTemplate`、これらのテキスト ボックスから削除する必要があります、`InsertItemTemplate`します。</span><span class="sxs-lookup"><span data-stu-id="55a60-389">Like with the `EditItemTemplate`, we need to remove these TextBoxes from the `InsertItemTemplate`.</span></span>

<span data-ttu-id="55a60-390">図 24 は、新しい製品を Acme コーヒーを追加するときにブラウザーで、フォーム ビューを示します。</span><span class="sxs-lookup"><span data-stu-id="55a60-390">Figure 24 shows the FormView in a browser when adding a new product, Acme Coffee.</span></span> <span data-ttu-id="55a60-391">なお、`SupplierName`と`CategoryName`で表示されるフィールド、`ItemTemplate`だけ削除しましたが存在する場合は、不要になった。</span><span class="sxs-lookup"><span data-stu-id="55a60-391">Note that the `SupplierName` and `CategoryName` fields shown in the `ItemTemplate` are no longer present, as we just removed them.</span></span> <span data-ttu-id="55a60-392">[挿入] ボタンで、同じ一連の手順として、DetailsView コントロールをフォーム ビュー処理の進行状況がクリックされたときに新しいレコードを追加、`Products`テーブル。</span><span class="sxs-lookup"><span data-stu-id="55a60-392">When the Insert button is clicked the FormView proceeds through the same sequence of steps as the DetailsView control, adding a new record to the `Products` table.</span></span> <span data-ttu-id="55a60-393">図 25 では、挿入された後、FormView で Acme コーヒー製品の詳細が示されます。</span><span class="sxs-lookup"><span data-stu-id="55a60-393">Figure 25 shows Acme Coffee product's details in the FormView after it has been inserted.</span></span>


<span data-ttu-id="55a60-394">[![FormView の挿入のインターフェイスを決定後、](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image61.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image60.png)</span><span class="sxs-lookup"><span data-stu-id="55a60-394">[![The InsertItemTemplate Dictates the FormView's Inserting Interface](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image61.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image60.png)</span></span>

<span data-ttu-id="55a60-395">**図 24**: `InsertItemTemplate` FormView の挿入インターフェイスによって決まります ([フルサイズの画像を表示する をクリックします](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image62.png))。</span><span class="sxs-lookup"><span data-stu-id="55a60-395">**Figure 24**: The `InsertItemTemplate` Dictates the FormView's Inserting Interface ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image62.png))</span></span>


<span data-ttu-id="55a60-396">[![FormView で Acme コーヒーの新しい製品の詳細が表示されます。](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image64.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image63.png)</span><span class="sxs-lookup"><span data-stu-id="55a60-396">[![The Details for New Product, Acme Coffee, are Displayed in the FormView](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image64.png)](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image63.png)</span></span>

<span data-ttu-id="55a60-397">**図 25**: Acme コーヒーの新しい製品の詳細が、フォーム ビューで表示されます ([フルサイズの画像を表示する をクリックします](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image65.png))。</span><span class="sxs-lookup"><span data-stu-id="55a60-397">**Figure 25**: The Details for New Product, Acme Coffee, are Displayed in the FormView ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-vb/_static/image65.png))</span></span>


<span data-ttu-id="55a60-398">によって、読み取り専用の分離、編集、およびインターフェイスを次の 3 つの個別のテンプレートに挿入する、FormView が GridView と DetailsView よりも細かくのこれらのインターフェイスを制御できます。</span><span class="sxs-lookup"><span data-stu-id="55a60-398">By separating out the read-only, editing, and inserting interfaces into three separate templates, the FormView allows for a finer degree of control over these interfaces than the DetailsView and GridView.</span></span>

> [!NOTE]
> <span data-ttu-id="55a60-399">などの DetailsView、FormView の`CurrentMode`プロパティが表示されているインターフェイスを示します、`DefaultMode`プロパティは、編集後、モードを FormView 返しますを示しますまたは挿入が完了します。</span><span class="sxs-lookup"><span data-stu-id="55a60-399">Like the DetailsView, the FormView's `CurrentMode` property indicates the interface being displayed and its `DefaultMode` property indicates the mode the FormView returns to after an edit or insert has been completed.</span></span>


## <a name="summary"></a><span data-ttu-id="55a60-400">まとめ</span><span class="sxs-lookup"><span data-stu-id="55a60-400">Summary</span></span>

<span data-ttu-id="55a60-401">このチュートリアルでは、挿入、編集、および GridView、DetailsView、FormView を使用してデータの削除の基本について確認しました。</span><span class="sxs-lookup"><span data-stu-id="55a60-401">In this tutorial we examined the basics of inserting, editing, and deleting data using the GridView, DetailsView, and FormView.</span></span> <span data-ttu-id="55a60-402">これらのコントロールの 3 つのすべてでは、いくつかデータ Web コントロールと ObjectDataSource に協力してくれたの ASP.NET ページで 1 行のコードを記述することがなく利用できる組み込みのデータ変更の機能レベルを提供します。</span><span class="sxs-lookup"><span data-stu-id="55a60-402">All three of these controls provide some level of built-in data modification capabilities that can be utilized without writing a single line of code in the ASP.NET page thanks to the data Web controls and the ObjectDataSource.</span></span> <span data-ttu-id="55a60-403">ただし、単純なは、ポイントして、かなり壊れ手法レンダリングと単純なデータ変更のユーザー インターフェイス をクリックします。</span><span class="sxs-lookup"><span data-stu-id="55a60-403">However, the simple point and click techniques render a fairly frail and naïve data modification user interface.</span></span> <span data-ttu-id="55a60-404">検証を提供するには、プログラムの値を挿入、例外を適切に処理、ユーザー インターフェイスをカスタマイズし、必要になります次のいくつかのチュートリアルで説明する手法の多くに依存します。</span><span class="sxs-lookup"><span data-stu-id="55a60-404">To provide validation, inject programmatic values, gracefully handle exceptions, customize the user interface, and so on, we'll need to rely on a bevy of techniques that will be discussed over the next several tutorials.</span></span>

<span data-ttu-id="55a60-405">満足のプログラミングです。</span><span class="sxs-lookup"><span data-stu-id="55a60-405">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="55a60-406">執筆者紹介</span><span class="sxs-lookup"><span data-stu-id="55a60-406">About the Author</span></span>

<span data-ttu-id="55a60-407">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)、7 つ受け取りますブックおよびの創設者の著者[4GuysFromRolla.com](http://www.4guysfromrolla.com)、Microsoft Web テクノロジと 1998 年から携わっています。</span><span class="sxs-lookup"><span data-stu-id="55a60-407">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="55a60-408">Scott は、フリーのコンサルタント、トレーナー、およびライターとして動作します。</span><span class="sxs-lookup"><span data-stu-id="55a60-408">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="55a60-409">最新の著書は[ *Sams 教える自分で ASP.NET 2.0 24 時間以内に*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)します。</span><span class="sxs-lookup"><span data-stu-id="55a60-409">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="55a60-410">彼に到達できる[mitchell@4GuysFromRolla.comします。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="55a60-410">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="55a60-411">彼のブログにあるでまたは[ http://ScottOnWriting.NET](http://ScottOnWriting.NET)します。</span><span class="sxs-lookup"><span data-stu-id="55a60-411">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="55a60-412">[前へ](limiting-data-modification-functionality-based-on-the-user-cs.md)
> [次へ](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)</span><span class="sxs-lookup"><span data-stu-id="55a60-412">[Previous](limiting-data-modification-functionality-based-on-the-user-cs.md)
[Next](examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)</span></span>
