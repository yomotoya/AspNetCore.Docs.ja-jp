---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/adding-validation-controls-to-the-datalist-s-editing-interface-cs
title: DataList に検証コントロールを追加の編集インターフェイス (c#) |Microsoft Docs
author: rick-anderson
description: このチュートリアルでは、DataList の後に編集 int です。 ユーザー間違えにくいを提供するために検証コントロールを追加するがいかに簡単か見て.
ms.author: riande
ms.date: 10/30/2006
ms.assetid: 3ecc21c5-da0e-40ab-abb4-fac1e47398ad
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/adding-validation-controls-to-the-datalist-s-editing-interface-cs
msc.type: authoredcontent
ms.openlocfilehash: 2fe85d6513a229f11b3aad7c7cc6c7124c94d70f
ms.sourcegitcommit: 45ac74e400f9f2b7dbded66297730f6f14a4eb25
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/16/2018
ms.locfileid: "41827392"
---
<a name="adding-validation-controls-to-the-datalists-editing-interface-c"></a><span data-ttu-id="a6b53-103">DataList の編集インターフェイス (c#) に検証コントロールを追加</span><span class="sxs-lookup"><span data-stu-id="a6b53-103">Adding Validation Controls to the DataList's Editing Interface (C#)</span></span>
====================
<span data-ttu-id="a6b53-104">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="a6b53-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="a6b53-105">[サンプル アプリをダウンロード](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_39_CS.exe)または[PDF のダウンロード](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/datatutorial39cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="a6b53-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_39_CS.exe) or [Download PDF](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/datatutorial39cs1.pdf)</span></span>

> <span data-ttu-id="a6b53-106">このチュートリアルではより安全な方法での編集ユーザー インターフェイスを提供するために、DataList の後に検証コントロールを追加するがいかに簡単か見ていきます。</span><span class="sxs-lookup"><span data-stu-id="a6b53-106">In this tutorial we'll see how easy it is to add validation controls to the DataList's EditItemTemplate in order to provide a more foolproof editing user interface.</span></span>


## <a name="introduction"></a><span data-ttu-id="a6b53-107">はじめに</span><span class="sxs-lookup"><span data-stu-id="a6b53-107">Introduction</span></span>

<span data-ttu-id="a6b53-108">チュートリアルのこれまで編集 DataList、不足している製品名や、例外が負の価格の結果などの無効なユーザー入力も事前にユーザー入力の検証の場所を編集インターフェイス データリストが含まれませんが。</span><span class="sxs-lookup"><span data-stu-id="a6b53-108">In the DataList editing tutorials thus far, the DataLists editing interfaces have not included any proactive user input validation even though invalid user input such as a missing product name or negative price results in an exception.</span></span> <span data-ttu-id="a6b53-109">[前のチュートリアル](handling-bll-and-dal-level-exceptions-cs.md)例外処理 DataList s にコードを追加する方法について確認しました`UpdateCommand`をキャッチして適切に発生した例外に関する情報を表示するには、イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="a6b53-109">In the [preceding tutorial](handling-bll-and-dal-level-exceptions-cs.md) we examined how to add exception handling code to the DataList s `UpdateCommand` event handler in order to catch and gracefully display information about any exceptions that were raised.</span></span> <span data-ttu-id="a6b53-110">理想的には、ただし、編集インターフェイスが含まれますをユーザーが最初にこのような無効なデータを入力するを防ぐために検証コントロール。</span><span class="sxs-lookup"><span data-stu-id="a6b53-110">Ideally, however, the editing interface would include validation controls to prevent a user from entering such invalid data in the first place.</span></span>

<span data-ttu-id="a6b53-111">このチュートリアルでは見て DataList s に検証コントロールを追加するがいかに簡単か`EditItemTemplate`間違えにくい編集ユーザー インターフェイスを提供するためにします。</span><span class="sxs-lookup"><span data-stu-id="a6b53-111">In this tutorial we'll see how easy it is to add validation controls to the DataList s `EditItemTemplate` in order to provide a more foolproof editing user interface.</span></span> <span data-ttu-id="a6b53-112">具体的には、このチュートリアルでは、前のチュートリアルで作成した例は、し、適切な検証をインクルードする編集インターフェイスを拡張します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-112">Specifically, this tutorial takes the example created in the preceding tutorial and augments the editing interface to include appropriate validation.</span></span>

## <a name="step-1-replicating-the-example-fromhandling-bll--and-dal-level-exceptionshandling-bll-and-dal-level-exceptions-csmd"></a><span data-ttu-id="a6b53-113">手順 1: レプリケーションの例では、[BLL レベルと DAL レベルの例外の処理](handling-bll-and-dal-level-exceptions-cs.md)</span><span class="sxs-lookup"><span data-stu-id="a6b53-113">Step 1: Replicating the Example from[Handling BLL- and DAL-Level Exceptions](handling-bll-and-dal-level-exceptions-cs.md)</span></span>

<span data-ttu-id="a6b53-114">[処理 BLL - と DAL レベルの例外](handling-bll-and-dal-level-exceptions-cs.md)チュートリアルの名前と 2 列の編集可能な DataList では、製品の価格を一覧表示するページを作成しました。</span><span class="sxs-lookup"><span data-stu-id="a6b53-114">In the [Handling BLL- and DAL-Level Exceptions](handling-bll-and-dal-level-exceptions-cs.md) tutorial we created a page that listed the names and prices of the products in a two-column, editable DataList.</span></span> <span data-ttu-id="a6b53-115">このチュートリアルの目標は、検証コントロールを追加するには、DataList s 編集インターフェイスの拡張です。</span><span class="sxs-lookup"><span data-stu-id="a6b53-115">Our goal for this tutorial is to augment the DataList s editing interface to include validation controls.</span></span> <span data-ttu-id="a6b53-116">具体的には、この検証ロジックを行います。</span><span class="sxs-lookup"><span data-stu-id="a6b53-116">In particular, our validation logic will:</span></span>

- <span data-ttu-id="a6b53-117">製品の名前を指定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a6b53-117">Require that the product s name be provided</span></span>
- <span data-ttu-id="a6b53-118">価格に入力された値が有効な通貨の形式であることを確認します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-118">Ensure that the value entered for the price is a valid currency format</span></span>
- <span data-ttu-id="a6b53-119">価格は、負の値以降、0 以上を入力した値を必ず`UnitPrice`値は無効です</span><span class="sxs-lookup"><span data-stu-id="a6b53-119">Ensure that the value entered for the price is greater than or equal to zero, since a negative `UnitPrice` value is illegal</span></span>

<span data-ttu-id="a6b53-120">最初の例をレプリケートする必要がありますに検証を含める前の例の拡張について考えることができます、前に、`ErrorHandling.aspx`ページで、`EditDeleteDataList`フォルダーのこのチュートリアルでは、ページに`UIValidation.aspx`します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-120">Before we can look at augmenting the previous example to include validation, we first need to replicate the example from the `ErrorHandling.aspx` page in the `EditDeleteDataList` folder to the page for this tutorial, `UIValidation.aspx`.</span></span> <span data-ttu-id="a6b53-121">両方の経由でコピーする必要があります。 これを実現するために、 `ErrorHandling.aspx` s 宣言型マークアップとそのソース コードをページ。</span><span class="sxs-lookup"><span data-stu-id="a6b53-121">To achieve this we need to copy over both the `ErrorHandling.aspx` page s declarative markup and its source code.</span></span> <span data-ttu-id="a6b53-122">まず、次の手順を実行することによって宣言型マークアップにコピーします。</span><span class="sxs-lookup"><span data-stu-id="a6b53-122">First copy over the declarative markup by performing the following steps:</span></span>

1. <span data-ttu-id="a6b53-123">開く、 `ErrorHandling.aspx` Visual Studio でのページ</span><span class="sxs-lookup"><span data-stu-id="a6b53-123">Open the `ErrorHandling.aspx` page in Visual Studio</span></span>
2. <span data-ttu-id="a6b53-124">ページの宣言型マークアップ (ページの下部にある [ソース] ボタンをクリックします) に移動します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-124">Go to the page s declarative markup (click on the Source button at the bottom of the page)</span></span>
3. <span data-ttu-id="a6b53-125">内のテキストをコピー、`<asp:Content>`と`</asp:Content>`図 1 としてタグ (行 3 ~ 32)。</span><span class="sxs-lookup"><span data-stu-id="a6b53-125">Copy the text within the `<asp:Content>` and `</asp:Content>` tags (lines 3 through 32), as shown in Figure 1.</span></span>


<span data-ttu-id="a6b53-126">[![内のテキストのコピー、 &lt;Asp:content&gt;コントロール](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image2.png)](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="a6b53-126">[![Copy the Text Within the &lt;asp:Content&gt; Control](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image2.png)](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image1.png)</span></span>

<span data-ttu-id="a6b53-127">**図 1**: 内のテキストのコピー、`<asp:Content>`コントロール ([フルサイズの画像を表示する をクリックします](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image3.png))。</span><span class="sxs-lookup"><span data-stu-id="a6b53-127">**Figure 1**: Copy the Text Within the `<asp:Content>` Control ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image3.png))</span></span>


1. <span data-ttu-id="a6b53-128">開く、`UIValidation.aspx`ページ</span><span class="sxs-lookup"><span data-stu-id="a6b53-128">Open the `UIValidation.aspx` page</span></span>
2. <span data-ttu-id="a6b53-129">ページの宣言型マークアップに移動します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-129">Go to the page s declarative markup</span></span>
3. <span data-ttu-id="a6b53-130">内のテキストを貼り付け、`<asp:Content>`コントロール。</span><span class="sxs-lookup"><span data-stu-id="a6b53-130">Paste the text within the `<asp:Content>` control.</span></span>

<span data-ttu-id="a6b53-131">ソース コードをコピーするには、開く、`ErrorHandling.aspx.vb`ページし、同様のテキストをコピー*内*、`EditDeleteDataList_ErrorHandling`クラス。</span><span class="sxs-lookup"><span data-stu-id="a6b53-131">To copy over the source code, open the `ErrorHandling.aspx.vb` page and copy just the text *within* the `EditDeleteDataList_ErrorHandling` class.</span></span> <span data-ttu-id="a6b53-132">3 つのイベント ハンドラーをコピー (`Products_EditCommand`、 `Products_CancelCommand`、および`Products_UpdateCommand`) と共に、`DisplayExceptionDetails`メソッドだ**いない**クラス宣言をコピーまたは`using`ステートメント。</span><span class="sxs-lookup"><span data-stu-id="a6b53-132">Copy the three event handlers (`Products_EditCommand`, `Products_CancelCommand`, and `Products_UpdateCommand`) along with the `DisplayExceptionDetails` method, but do **not** copy the class declaration or `using` statements.</span></span> <span data-ttu-id="a6b53-133">コピーしたテキストを貼り付ける*内*、`EditDeleteDataList_UIValidation`クラス`UIValidation.aspx.vb`します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-133">Paste the copied text *within* the `EditDeleteDataList_UIValidation` class in `UIValidation.aspx.vb`.</span></span>

<span data-ttu-id="a6b53-134">コンテンツとコードからの上に移動した後は`ErrorHandling.aspx`に`UIValidation.aspx`ブラウザーでページをテストする少し。</span><span class="sxs-lookup"><span data-stu-id="a6b53-134">After moving over the content and code from `ErrorHandling.aspx` to `UIValidation.aspx`, take a moment to test out the pages in a browser.</span></span> <span data-ttu-id="a6b53-135">同じ出力を参照してください。 これら 2 つのページ (図 2 参照) のそれぞれで同じ機能を体験してください。</span><span class="sxs-lookup"><span data-stu-id="a6b53-135">You should see the same output and experience the same functionality in each of these two pages (see Figure 2).</span></span>


<span data-ttu-id="a6b53-136">[![UIValidation.aspx ページは ErrorHandling.aspx の機能を模倣しています](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image5.png)](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="a6b53-136">[![The UIValidation.aspx Page Mimics the Functionality in ErrorHandling.aspx](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image5.png)](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image4.png)</span></span>

<span data-ttu-id="a6b53-137">**図 2**:`UIValidation.aspx`ページ内の機能を模倣する`ErrorHandling.aspx`([フルサイズの画像を表示する をクリックします](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image6.png))。</span><span class="sxs-lookup"><span data-stu-id="a6b53-137">**Figure 2**: The `UIValidation.aspx` Page Mimics the Functionality in `ErrorHandling.aspx` ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image6.png))</span></span>


## <a name="step-2-adding-the-validation-controls-to-the-datalist-s-edititemtemplate"></a><span data-ttu-id="a6b53-138">手順 2: DataList s の後に、検証コントロールを追加します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-138">Step 2: Adding the Validation Controls to the DataList s EditItemTemplate</span></span>

<span data-ttu-id="a6b53-139">データ入力フォームを構築するときに、必須の各フィールドに入力し、指定されたすべての入力は有効で正しい形式の値であることは重要です。</span><span class="sxs-lookup"><span data-stu-id="a6b53-139">When constructing data entry forms, it is important that users enter any required fields and that all their provided inputs are legal, properly-formatted values.</span></span> <span data-ttu-id="a6b53-140">ユーザーの入力値が有効であることを確認するには、ASP.NET では、1 つの入力 Web コントロールの値を検証するように設計された 5 つの組み込みの検証コントロールが用意されています。</span><span class="sxs-lookup"><span data-stu-id="a6b53-140">To help ensure that a user s inputs are valid, ASP.NET provides five built-in validation controls that are designed to validate the value of a single input Web control:</span></span>

- <span data-ttu-id="a6b53-141">[RequiredFieldValidator](https://msdn.microsoft.com/library/5hbw267h(VS.80).aspx)により値が指定されているようになります</span><span class="sxs-lookup"><span data-stu-id="a6b53-141">[RequiredFieldValidator](https://msdn.microsoft.com/library/5hbw267h(VS.80).aspx) ensures that a value has been provided</span></span>
- <span data-ttu-id="a6b53-142">[CompareValidator](https://msdn.microsoft.com/library/db330ayw(VS.80).aspx)値を別の Web コントロールの値または定数の値を検証しますまたは、秒の値の形式が指定されたデータ型に対して有効であることを確認。</span><span class="sxs-lookup"><span data-stu-id="a6b53-142">[CompareValidator](https://msdn.microsoft.com/library/db330ayw(VS.80).aspx) validates a value against another Web control value or a constant value, or ensures that the value s format is legal for a specified data type</span></span>
- <span data-ttu-id="a6b53-143">[RangeValidator](https://msdn.microsoft.com/library/f70d09xt.aspx)値が値の範囲内であることを確認</span><span class="sxs-lookup"><span data-stu-id="a6b53-143">[RangeValidator](https://msdn.microsoft.com/library/f70d09xt.aspx) ensures that a value is within a range of values</span></span>
- <span data-ttu-id="a6b53-144">[RegularExpressionValidator](https://msdn.microsoft.com/library/eahwtc9e.aspx)に対して値を検証、[正規表現](http://en.wikipedia.org/wiki/Regular_expression)</span><span class="sxs-lookup"><span data-stu-id="a6b53-144">[RegularExpressionValidator](https://msdn.microsoft.com/library/eahwtc9e.aspx) validates a value against a [regular expression](http://en.wikipedia.org/wiki/Regular_expression)</span></span>
- <span data-ttu-id="a6b53-145">[CustomValidator](https://msdn.microsoft.com/library/9eee01cx(VS.80).aspx)に対して、ユーザー定義のカスタム メソッドの値を検証します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-145">[CustomValidator](https://msdn.microsoft.com/library/9eee01cx(VS.80).aspx) validates a value against a custom, user-defined method</span></span>

<span data-ttu-id="a6b53-146">これら 5 つのコントロールの詳細については参照、[編集および挿入インターフェイスに検証コントロールを追加](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md)チュートリアルまたはチェック アウト、[検証コントロール セクション](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/validation/default.aspx)の[ASP.NET クイック スタート チュートリアル](https://quickstarts.asp.net)します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-146">For more information on these five controls refer back to the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md) tutorial or check out the [Validation Controls section](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/validation/default.aspx) of the [ASP.NET Quickstart Tutorials](https://quickstarts.asp.net).</span></span>

<span data-ttu-id="a6b53-147">このチュートリアルを RequiredFieldValidator、製品名の値が指定されていることを確認して、CompareValidator を十分に価格を入力が 0 以上の値を持つし、有効な通貨の形式で表示を使用する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a6b53-147">For our tutorial we'll need to use a RequiredFieldValidator to ensure that a value for the product name has been supplied and a CompareValidator to ensure that the entered price has a value greater than or equal to 0 and is presented in a valid currency format.</span></span>

> [!NOTE]
> <span data-ttu-id="a6b53-148">While ASP.NET 1.x がこれらの同じ 5 つの検証コントロール、ASP.NET 2.0 にはさまざまな機能強化が追加、ブラウザー Internet Explorer だけでなく、パーティションの検証コントロールをページにする機能がサポートされるクライアント側スクリプト 2 メイン検証グループ。</span><span class="sxs-lookup"><span data-stu-id="a6b53-148">While ASP.NET 1.x had these same five validation controls, ASP.NET 2.0 has added a number of improvements, the main two being client-side script support for browsers in addition to Internet Explorer and the ability to partition validation controls on a page into validation groups.</span></span> <span data-ttu-id="a6b53-149">2.0 の検証コントロールの新機能に関する詳細についてを参照してください[詳細に分析する ASP.NET 2.0 の検証コントロール](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx)します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-149">For more information on the new validation control features in 2.0, refer to [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx).</span></span>


<span data-ttu-id="a6b53-150">S DataList s に、必要な検証コントロールを追加することで開始できるように`EditItemTemplate`します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-150">Let s start by adding the necessary validation controls to the DataList s `EditItemTemplate`.</span></span> <span data-ttu-id="a6b53-151">DataList s のスマート タグからのテンプレートの編集リンクをクリックして、デザイナー、または宣言型構文を通じて、このタスクを実行できます。</span><span class="sxs-lookup"><span data-stu-id="a6b53-151">This task can be performed through the Designer by clicking on the Edit Templates link from the DataList s smart tag, or through the declarative syntax.</span></span> <span data-ttu-id="a6b53-152">デザイン ビューからのテンプレートの編集オプションを使用して、プロセスを s ステップを使用できます。</span><span class="sxs-lookup"><span data-stu-id="a6b53-152">Let s step through the process using the Edit Templates option from the Design view.</span></span> <span data-ttu-id="a6b53-153">DataList の編集を選択した後`EditItemTemplate`、テンプレートの編集インターフェイスに、ツールボックスからドラッグして、RequiredFieldValidator を追加後に配置、`ProductName`テキスト ボックス。</span><span class="sxs-lookup"><span data-stu-id="a6b53-153">After choosing to edit the DataList s `EditItemTemplate`, add a RequiredFieldValidator by dragging it from the Toolbox into the template editing interface, placing it after the `ProductName` TextBox.</span></span>


<span data-ttu-id="a6b53-154">[![ProductName テキスト ボックスの後に、後に、RequiredFieldValidator を追加します。](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image8.png)](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="a6b53-154">[![Add a RequiredFieldValidator to the EditItemTemplate After the ProductName TextBox](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image8.png)](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image7.png)</span></span>

<span data-ttu-id="a6b53-155">**図 3**: の RequiredFieldValidator を追加、 `EditItemTemplate After` 、 `ProductName` TextBox ([フルサイズの画像を表示する をクリックします](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image9.png))。</span><span class="sxs-lookup"><span data-stu-id="a6b53-155">**Figure 3**: Add a RequiredFieldValidator to the `EditItemTemplate After` the `ProductName` TextBox ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image9.png))</span></span>


<span data-ttu-id="a6b53-156">すべての検証コントロールは、1 つの ASP.NET Web コントロールの入力を検証することで動作します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-156">All validation controls work by validating the input of a single ASP.NET Web control.</span></span> <span data-ttu-id="a6b53-157">そのため、追加した RequiredFieldValidator が検証を示す必要があります、`ProductName`テキスト ボックスですこれは、検証コントロールの設定で[`ControlToValidate`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.controltovalidate(VS.80).aspx)を、`ID`の。適切な Web コントロール (`ProductName`、このインスタンスで)。</span><span class="sxs-lookup"><span data-stu-id="a6b53-157">Therefore, we need to indicate that the RequiredFieldValidator we just added should validate against the `ProductName` TextBox; this is done by setting the validation control s [`ControlToValidate` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.controltovalidate(VS.80).aspx) to the `ID` of the appropriate Web control (`ProductName`, in this instance).</span></span> <span data-ttu-id="a6b53-158">次に、設定、 [ `ErrorMessage`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.errormessage(VS.80).aspx)するには、製品の名前を指定する必要があります、 [ `Text`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.text(VS.80).aspx)に\*します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-158">Next, set the [`ErrorMessage` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.errormessage(VS.80).aspx) to You must provide the product s name and the [`Text` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.text(VS.80).aspx) to \*.</span></span> <span data-ttu-id="a6b53-159">`Text`プロパティの値を指定されている場合は、検証が失敗した場合、検証コントロールによって表示されるテキスト。</span><span class="sxs-lookup"><span data-stu-id="a6b53-159">The `Text` property value, if provided, is the text that is displayed by the validation control if the validation fails.</span></span> <span data-ttu-id="a6b53-160">`ErrorMessage`場合を必要なプロパティ値が ValidationSummary コントロールによって使用される、`Text`プロパティの値を省略すると、`ErrorMessage`プロパティの値が無効な入力の検証コントロールによって表示されます。</span><span class="sxs-lookup"><span data-stu-id="a6b53-160">The `ErrorMessage` property value, which is required, is used by the ValidationSummary control; if the `Text` property value is omitted, the `ErrorMessage` property value is displayed by the validation control on invalid input.</span></span>

<span data-ttu-id="a6b53-161">これら 3 つ、RequiredFieldValidator のプロパティを設定した後、画面を図 4 のようなはずです。</span><span class="sxs-lookup"><span data-stu-id="a6b53-161">After setting these three properties of the RequiredFieldValidator, your screen should look similar to Figure 4.</span></span>


<span data-ttu-id="a6b53-162">[![RequiredFieldValidator の ControlToValidate、エラー メッセージ、およびテキストのプロパティを設定します。](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image11.png)](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="a6b53-162">[![Set the RequiredFieldValidator s ControlToValidate, ErrorMessage, and Text Properties](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image11.png)](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image10.png)</span></span>

<span data-ttu-id="a6b53-163">**図 4**: RequiredFieldValidator s 設定`ControlToValidate`、 `ErrorMessage`、および`Text`プロパティ ([フルサイズの画像を表示する をクリックします](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image12.png))。</span><span class="sxs-lookup"><span data-stu-id="a6b53-163">**Figure 4**: Set the RequiredFieldValidator s `ControlToValidate`, `ErrorMessage`, and `Text` Properties ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image12.png))</span></span>


<span data-ttu-id="a6b53-164">RequiredFieldValidator を追加すると、`EditItemTemplate`すべて残ってはボックス製品の価格のために必要な検証を追加することです。</span><span class="sxs-lookup"><span data-stu-id="a6b53-164">With the RequiredFieldValidator added to the `EditItemTemplate`, all that remains is to add the necessary validation for the product s price TextBox.</span></span> <span data-ttu-id="a6b53-165">以降、`UnitPrice`は省略可能なレコードを編集するには、こと、RequiredFieldValidator に追加する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="a6b53-165">Since the `UnitPrice` is optional when editing a record, we don t need to add a RequiredFieldValidator.</span></span> <span data-ttu-id="a6b53-166">ただし、いることを確認する CompareValidator を追加する必要があります、 `UnitPrice`、指定した場合は、0 以上でありが正しく、通貨として書式設定します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-166">We do, however, need to add a CompareValidator to ensure that the `UnitPrice`, if supplied, is properly formatted as a currency and is greater than or equal to 0.</span></span>

<span data-ttu-id="a6b53-167">CompareValidator の追加、`EditItemTemplate`設定とその`ControlToValidate`プロパティを`UnitPrice`その`ErrorMessage`価格にプロパティが 0 以上にする必要があり、通貨記号を含めることはできませんし、その`Text`プロパティ\*.</span><span class="sxs-lookup"><span data-stu-id="a6b53-167">Add the CompareValidator into the `EditItemTemplate` and set its `ControlToValidate` property to `UnitPrice`, its `ErrorMessage` property to The price must be greater than or equal to zero and cannot include the currency symbol, and its `Text` property to \*.</span></span> <span data-ttu-id="a6b53-168">いることを示す、`UnitPrice`値が 0 以上、CompareValidator s を設定する必要があります[`Operator`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.operator(VS.80).aspx)に`GreaterThanEqual`その[`ValueToCompare`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.valuetocompare(VS.80).aspx)を 0 にし、その[`Type`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basecomparevalidator.type.aspx)に`Currency`します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-168">To indicate that the `UnitPrice` value must be greater than or equal to 0, set the CompareValidator s [`Operator` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.operator(VS.80).aspx) to `GreaterThanEqual`, its [`ValueToCompare` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.valuetocompare(VS.80).aspx) to 0, and its [`Type` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basecomparevalidator.type.aspx) to `Currency`.</span></span>

<span data-ttu-id="a6b53-169">DataList s、これらの 2 つの検証コントロールを追加した後`EditItemTemplate`s 宣言の構文に、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="a6b53-169">After adding these two validation controls, the DataList s `EditItemTemplate` s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](adding-validation-controls-to-the-datalist-s-editing-interface-cs/samples/sample1.aspx)]

<span data-ttu-id="a6b53-170">これらの変更を行った後は、ブラウザーでページを開きます。</span><span class="sxs-lookup"><span data-stu-id="a6b53-170">After making these changes, open the page in a browser.</span></span> <span data-ttu-id="a6b53-171">名前を省略するか、製品を編集するときに、無効な価格の値を入力しようとすると、テキスト ボックスの横にある場合は、アスタリスクが表示されます。</span><span class="sxs-lookup"><span data-stu-id="a6b53-171">If you attempt to omit the name or enter an invalid price value when editing a product, an asterisk appears next to the textbox.</span></span> <span data-ttu-id="a6b53-172">図 5 に示すよう 19.95 ドルなどの通貨記号を含む価格の値は無効と見なされます。</span><span class="sxs-lookup"><span data-stu-id="a6b53-172">As Figure 5 shows, a price value that includes the currency symbol such as $19.95 is considered invalid.</span></span> <span data-ttu-id="a6b53-173">CompareValidator s `Currency` `Type` (コンマ、ピリオド、カルチャ設定によってなど) の桁区切り記号と先頭プラスまたはマイナス記号、できますが、*いない*通貨記号を許可します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-173">The CompareValidator s `Currency` `Type` allows for digit separators (such as commas or periods, depending on the culture settings) and a leading plus or minus sign, but does *not* permit a currency symbol.</span></span> <span data-ttu-id="a6b53-174">この動作は、編集インターフェイスをレンダリング現在ユーザーに perplex 可能性があります、`UnitPrice`通貨形式を使用します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-174">This behavior may perplex users as the editing interface currently renders the `UnitPrice` using the currency format.</span></span>


<span data-ttu-id="a6b53-175">[![無効な入力をテキスト ボックスの横にアスタリスクが表示されます。](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image14.png)](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="a6b53-175">[![An Asterisk Appears Next to the Textboxes with Invalid Input](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image14.png)](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image13.png)</span></span>

<span data-ttu-id="a6b53-176">**図 5**: An アスタリスクが表示されますへの無効な入力をテキスト ボックス ([フルサイズの画像を表示する をクリックします](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image15.png))。</span><span class="sxs-lookup"><span data-stu-id="a6b53-176">**Figure 5**: An Asterisk Appears Next to the Textboxes with Invalid Input ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image15.png))</span></span>


<span data-ttu-id="a6b53-177">として検証機能の中では、ユーザーが許容されないレコードを編集するときに、通貨記号を手動で削除する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a6b53-177">While the validation works as-is, the user has to manually remove the currency symbol when editing a record, which is not acceptable.</span></span> <span data-ttu-id="a6b53-178">さらに、存在が有効な場合、編集の入力のどちらも、更新プログラムもキャンセル ボタンのクリックされると、ポストバックを呼び出すときにインターフェイスです。</span><span class="sxs-lookup"><span data-stu-id="a6b53-178">Moreover, if there are invalid inputs in the editing interface neither the Update nor Cancel buttons, when clicked, will invoke a postback.</span></span> <span data-ttu-id="a6b53-179">理想的には、[キャンセル] ボタンは、ユーザーの入力の妥当性に関係なく、編集済みの状態を DataList を返します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-179">Ideally, the Cancel button would return the DataList to its pre-editing state regardless of the validity of the user s inputs.</span></span> <span data-ttu-id="a6b53-180">また、DataList s で製品情報を更新する前に、ページ データが有効であることを確認する必要があります`UpdateCommand`としてユーザーのブラウザーは JavaScript サポートがないかがクライアント側ロジックをバイパスすることができます、検証コントロールのイベント ハンドラーサポートを無効になっています。</span><span class="sxs-lookup"><span data-stu-id="a6b53-180">Also, we need to ensure that the page s data is valid before updating the product information in the DataList s `UpdateCommand` event handler, as the validation controls client-side logic can be bypassed by users whose browsers either don t support JavaScript or have its support disabled.</span></span>

## <a name="removing-the-currency-symbol-from-the-edititemtemplate-s-unitprice-textbox"></a><span data-ttu-id="a6b53-181">後の s UnitPrice TextBox から通貨記号を削除します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-181">Removing the Currency Symbol from the EditItemTemplate s UnitPrice TextBox</span></span>

<span data-ttu-id="a6b53-182">CompareValidator s を使用する場合`Currency``Type`、検証対象の入力は、通貨記号を含めることはできません。</span><span class="sxs-lookup"><span data-stu-id="a6b53-182">When using the CompareValidator s `Currency``Type`, the input being validated must not include any currency symbols.</span></span> <span data-ttu-id="a6b53-183">このようなシンボルの存在ととして無効な入力をマークする CompareValidator です。</span><span class="sxs-lookup"><span data-stu-id="a6b53-183">The presence of such symbols causes the CompareValidator to mark the input as invalid.</span></span> <span data-ttu-id="a6b53-184">通貨記号が現在の編集インターフェイスに含まれています、ただし、 `UnitPrice`  ボックスに、つまり、ユーザーがその変更を保存する前に通貨記号を明示的に削除する必要があります。</span><span class="sxs-lookup"><span data-stu-id="a6b53-184">However, our editing interface currently includes a currency symbol in the `UnitPrice` TextBox, meaning the user must explicitly remove the currency symbol before saving their changes.</span></span> <span data-ttu-id="a6b53-185">これを解決するには、3 つのオプションがあります。</span><span class="sxs-lookup"><span data-stu-id="a6b53-185">To remedy this we have three options:</span></span>

1. <span data-ttu-id="a6b53-186">構成、`EditItemTemplate`ように、`UnitPrice`テキスト ボックスの値が通貨として書式設定されません。</span><span class="sxs-lookup"><span data-stu-id="a6b53-186">Configure the `EditItemTemplate` so that the `UnitPrice` TextBox value is not formatted as a currency.</span></span>
2. <span data-ttu-id="a6b53-187">CompareValidator の削除と適切に書式設定された通貨値をチェックする RegularExpressionValidator に置き換えることによって、通貨記号を入力するユーザーを許可します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-187">Allow the user to enter a currency symbol by removing the CompareValidator and replacing it with a RegularExpressionValidator that checks for a properly formatted currency value.</span></span> <span data-ttu-id="a6b53-188">ここでチャレンジでは、通貨値を検証する正規表現は、CompareValidator として簡単ではなく、およびカルチャ設定を反映する場合は、コードの記述を必要とは。</span><span class="sxs-lookup"><span data-stu-id="a6b53-188">The challenge here is that the regular expression to validate a currency value is not as straightforward as the CompareValidator and would require writing code if we wanted to incorporate culture settings.</span></span>
3. <span data-ttu-id="a6b53-189">検証コントロールを完全に削除し、GridView s でカスタム サーバー側の検証ロジックに依存`RowUpdating`イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="a6b53-189">Remove the validation control altogether and rely on custom server-side validation logic in the GridView s `RowUpdating` event handler.</span></span>

<span data-ttu-id="a6b53-190">このチュートリアルではオプション 1 を使用してのことができます。</span><span class="sxs-lookup"><span data-stu-id="a6b53-190">Let s go with option 1 for this tutorial.</span></span> <span data-ttu-id="a6b53-191">現在、`UnitPrice`は、テキスト ボックス内のデータ バインディング式のための通貨値として書式設定、 `EditItemTemplate`:`<%# Eval("UnitPrice", "{0:c}") %>`します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-191">Currently the `UnitPrice` is formatted as a currency value due to the databinding expression for the TextBox in the `EditItemTemplate`: `<%# Eval("UnitPrice", "{0:c}") %>`.</span></span> <span data-ttu-id="a6b53-192">変更、`Eval`ステートメント`Eval("UnitPrice", "{0:n2}")`、有効桁数 2 桁の番号として、結果の書式を設定します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-192">Change the `Eval` statement to `Eval("UnitPrice", "{0:n2}")`, which formats the result as a number with two digits of precision.</span></span> <span data-ttu-id="a6b53-193">これ行う宣言型構文またはから DataBindings の編集リンクをクリックして直接、 `UnitPrice` DataList のボックス`EditItemTemplate`します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-193">This can be done directly through the declarative syntax or by clicking on the Edit DataBindings link from the `UnitPrice` TextBox in the DataList s `EditItemTemplate`.</span></span>

<span data-ttu-id="a6b53-194">この変更によりは、編集インターフェイスで書式設定された料金は、グループ区切り記号としてコンマと、小数点区切り文字としてピリオドが含まれていますが、通貨記号をオフのままです。</span><span class="sxs-lookup"><span data-stu-id="a6b53-194">With this change, the formatted price in the editing interface includes commas as the group separator and a period as the decimal separator, but leaves off the currency symbol.</span></span>

> [!NOTE]
> <span data-ttu-id="a6b53-195">編集可能なインターフェイスから通貨書式を削除するときに便利です、テキスト ボックスの外側のテキストとして通貨記号を配置します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-195">When removing the currency format from the editable interface, I find it helpful to put the currency symbol as text outside the TextBox.</span></span> <span data-ttu-id="a6b53-196">これは、通貨記号を提供する必要のないユーザーにヒントとして機能します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-196">This serves as a hint to the user that they do not need to provide the currency symbol.</span></span>


## <a name="fixing-the-cancel-button"></a><span data-ttu-id="a6b53-197">[キャンセル] ボタンを修正</span><span class="sxs-lookup"><span data-stu-id="a6b53-197">Fixing the Cancel Button</span></span>

<span data-ttu-id="a6b53-198">既定では、Web の検証コントロールは、クライアント側で検証を実行する JavaScript を生成します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-198">By default, the validation Web controls emit JavaScript to perform validation on the client-side.</span></span> <span data-ttu-id="a6b53-199">ボタン、LinkButton や ImageButton がクリックされたとき、ポストバックが発生する前にクライアント側でページの検証コントロールがチェックされます。</span><span class="sxs-lookup"><span data-stu-id="a6b53-199">When a Button, LinkButton, or ImageButton is clicked, the validation controls on the page are checked on the client-side before the postback occurs.</span></span> <span data-ttu-id="a6b53-200">無効なデータがある場合、ポストバックが取り消されました。</span><span class="sxs-lookup"><span data-stu-id="a6b53-200">If there is any invalid data, the postback is cancelled.</span></span> <span data-ttu-id="a6b53-201">特定のボタンをデータの妥当性できない可能性があります素材です。このような場合は、無効なデータのため取り消されましたポストバックを発生は厄介です。</span><span class="sxs-lookup"><span data-stu-id="a6b53-201">For certain Buttons, though, the validity of the data might be immaterial; in such a case, having the postback cancelled due to invalid data is a nuisance.</span></span>

<span data-ttu-id="a6b53-202">[キャンセル] ボタンは、このような例を示します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-202">The Cancel button is such an example.</span></span> <span data-ttu-id="a6b53-203">ユーザーなど、s の製品名を省略すると、無効なデータを入力した製品をすべて保存する彼女はたくを決定および [キャンセル] ボタンをヒットを想像してください。</span><span class="sxs-lookup"><span data-stu-id="a6b53-203">Imagine that a user enters invalid data, such as omitting the product s name, and then decides she doesn t want to save the product after all and hits the Cancel button.</span></span> <span data-ttu-id="a6b53-204">現時点では、キャンセル ボタンは、製品名が不足しているが、ポストバックを防ぐためであることを報告する ページで、検証コントロールをトリガーします。</span><span class="sxs-lookup"><span data-stu-id="a6b53-204">Currently, the Cancel button triggers the validation controls on the page, which report that the product name is missing and prevent the postback.</span></span> <span data-ttu-id="a6b53-205">ユーザーがテキストを入力する必要があります、`ProductName`テキスト ボックスに編集のプロセスをキャンセルするだけです。</span><span class="sxs-lookup"><span data-stu-id="a6b53-205">Our user has to type some text into the `ProductName` TextBox just to cancel out of the editing process.</span></span>

<span data-ttu-id="a6b53-206">さいわい、ボタン、LinkButton、および ImageButton が、 [ `CausesValidation`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.button.causesvalidation.aspx)ことを示すをクリックするかどうか、ボタンは、検証ロジックを開始する必要があります (既定値は`True`)。</span><span class="sxs-lookup"><span data-stu-id="a6b53-206">Fortunately, the Button, LinkButton, and ImageButton have a [`CausesValidation` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.button.causesvalidation.aspx) that can indicate whether or not clicking the Button should initiate the validation logic (defaults to `True`).</span></span> <span data-ttu-id="a6b53-207">設定は [キャンセル] ボタンの s`CausesValidation`プロパティを`False`します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-207">Set the Cancel Button s `CausesValidation` property to `False`.</span></span>

## <a name="ensuring-the-inputs-are-valid-in-the-updatecommand-event-handler"></a><span data-ttu-id="a6b53-208">UpdateCommand イベント ハンドラーで有効では、入力のことを確認します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-208">Ensuring the Inputs are Valid in the UpdateCommand Event Handler</span></span>

<span data-ttu-id="a6b53-209">検証コントロールによって出力されるクライアント側スクリプトにより、ユーザーが入力すると無効な入力検証コントロールのキャンセル ボタン、linkbutton コントロールで開始されたすべてのポストバック ImageButton コントロールまたは持つ`CausesValidation`プロパティは、 `True` (、既定値)。</span><span class="sxs-lookup"><span data-stu-id="a6b53-209">Due to the client-side script emitted by the validation controls, if a user enters invalid input the validation controls cancel any postbacks initiated by Button, LinkButton, or ImageButton controls whose `CausesValidation` properties are `True` (the default).</span></span> <span data-ttu-id="a6b53-210">ただし、ユーザーは旧式のブラウザーまたは JavaScript のサポートが無効になっている 1 つにアクセスして、クライアント側検証チェックは実行されません。</span><span class="sxs-lookup"><span data-stu-id="a6b53-210">However, if a user is visiting with an antiquated browser or one whose JavaScript support has been disabled, the client-side validation checks will not execute.</span></span>

<span data-ttu-id="a6b53-211">ASP.NET 検証コントロールのすべてのポストバック時にすぐに、検証ロジックを繰り返すし、を使用して、ページ入力の全体的な有効性を報告、 [ `Page.IsValid`プロパティ](https://msdn.microsoft.com/library/system.web.ui.page.isvalid.aspx)します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-211">All of the ASP.NET validation controls repeat their validation logic immediately upon postback and report the overall validity of the page s inputs via the [`Page.IsValid` property](https://msdn.microsoft.com/library/system.web.ui.page.isvalid.aspx).</span></span> <span data-ttu-id="a6b53-212">ただし、ページ フローが中断されるかいずれかの値に基づく方法で停止`Page.IsValid`します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-212">However, the page flow is not interrupted or stopped in any way based on the value of `Page.IsValid`.</span></span> <span data-ttu-id="a6b53-213">開発者として、いることを確認する必要がありますが、`Page.IsValid`プロパティの値を持つ`True`入力データの有効なが想定するコードに進む前にします。</span><span class="sxs-lookup"><span data-stu-id="a6b53-213">As developers, it is our responsibility to ensure that the `Page.IsValid` property has a value of `True` before proceeding with code that assumes valid input data.</span></span>

<span data-ttu-id="a6b53-214">ページにアクセスし、製品を編集、すぎますの価格の値を入力をユーザーに JavaScript を無効になっている場合は、高価で、[更新] ボタンをクリックしては、クライアント側の検証をバイパスし、ポストバックにつながります。</span><span class="sxs-lookup"><span data-stu-id="a6b53-214">If a user has JavaScript disabled, visits our page, edits a product, enters a price value of Too expensive, and clicks the Update button, the client-side validation will be bypassed and a postback will ensue.</span></span> <span data-ttu-id="a6b53-215">、ASP.NET ページのポストバックの`UpdateCommand`イベント ハンドラーを実行し、すぎるの解析中に例外が発生する負荷の高い、 `Decimal`。</span><span class="sxs-lookup"><span data-stu-id="a6b53-215">On postback, the ASP.NET page s `UpdateCommand` event handler executes and an exception is raised when attempting to parse Too expensive to a `Decimal`.</span></span> <span data-ttu-id="a6b53-216">例外処理がある、このような例外は正常に処理されますが、私たちを進めるだけで、最初にを通じて遅れてから無効なデータを妨げる可能性があるため、`UpdateCommand`イベント ハンドラー場合`Page.IsValid`の値を持つ`True`します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-216">Since we have exception handling, such an exception will be handled gracefully, but we could prevent the invalid data from slipping through in the first place by only proceeding with the `UpdateCommand` event handler if `Page.IsValid` has a value of `True`.</span></span>

<span data-ttu-id="a6b53-217">先頭に次のコードを追加、`UpdateCommand`イベント ハンドラーの直前に、`Try`ブロック。</span><span class="sxs-lookup"><span data-stu-id="a6b53-217">Add the following code to the start of the `UpdateCommand` event handler, immediately before the `Try` block:</span></span>


[!code-csharp[Main](adding-validation-controls-to-the-datalist-s-editing-interface-cs/samples/sample2.cs)]

<span data-ttu-id="a6b53-218">これにより、送信されたデータが有効な場合にのみ更新する製品を試みます。</span><span class="sxs-lookup"><span data-stu-id="a6b53-218">With this addition, the product will attempt to be updated only if the submitted data is valid.</span></span> <span data-ttu-id="a6b53-219">T が勝利したほとんどのユーザーが、検証コントロールのクライアント側スクリプトにより、無効なデータをポストバックできるが、ブラウザーの JavaScript サポートのない、または JavaScript のサポートのユーザーのクライアント側のチェックをバイパスし無効なデータを送信を無効にできます。</span><span class="sxs-lookup"><span data-stu-id="a6b53-219">Most users won t be able to postback invalid data due to the validation controls client-side scripts, but users whose browsers don t support JavaScript or that have JavaScript support disabled, can bypass the client-side checks and submit invalid data.</span></span>

> [!NOTE]
> <span data-ttu-id="a6b53-220">鋭い読者なら、前述のとおりです、GridView でデータを更新するときに私たちは一致しませんでした t が明示的に確認する必要があります、`Page.IsValid`ページ分離コード クラスのプロパティ。</span><span class="sxs-lookup"><span data-stu-id="a6b53-220">The astute reader will recall that when updating data with the GridView, we didn t need to explicitly check the `Page.IsValid` property in our page s code-behind class.</span></span> <span data-ttu-id="a6b53-221">これは、GridView を参照しているため、`Page.IsValid`プロパティの値を返す場合にのみ更新プログラムを続行のみと`True`します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-221">This is because the GridView consults the `Page.IsValid` property for us and only proceeds with the update only if it returns a value of `True`.</span></span>


## <a name="step-3-summarizing-data-entry-problems"></a><span data-ttu-id="a6b53-222">手順 3: データ エントリの問題の要約</span><span class="sxs-lookup"><span data-stu-id="a6b53-222">Step 3: Summarizing Data Entry Problems</span></span>

<span data-ttu-id="a6b53-223">ASP.NET には、5 つの検証コントロールのほか、 [ValidationSummary コントロール](https://msdn.microsoft.com/library/f9h59855(VS.80).aspx)が表示される、`ErrorMessage`の無効なデータが検出された検証コントロール。</span><span class="sxs-lookup"><span data-stu-id="a6b53-223">In addition to the five validation controls, ASP.NET includes the [ValidationSummary control](https://msdn.microsoft.com/library/f9h59855(VS.80).aspx), which displays the `ErrorMessage` s of those validation controls that detected invalid data.</span></span> <span data-ttu-id="a6b53-224">この概要データは、モーダル、クライアント側のメッセージ ボックスから web ページ上のテキストとして表示できます。</span><span class="sxs-lookup"><span data-stu-id="a6b53-224">This summary data can be displayed as text on the web page or through a modal, client-side messagebox.</span></span> <span data-ttu-id="a6b53-225">S をクライアント側のメッセージ ボックス検証問題の集計を含めるには、このチュートリアルを拡張することができます。</span><span class="sxs-lookup"><span data-stu-id="a6b53-225">Let s enhance this tutorial to include a client-side messagebox summarizing any validation problems.</span></span>

<span data-ttu-id="a6b53-226">これを実現するには、ツールボックスからデザイナーに ValidationSummary コントロールをドラッグします。</span><span class="sxs-lookup"><span data-stu-id="a6b53-226">To accomplish this, drag a ValidationSummary control from the Toolbox onto the Designer.</span></span> <span data-ttu-id="a6b53-227">ValidationSummary コントロールは t の場所は問題で、以降にのみ、メッセージ ボックスとしての概要を表示するように構成します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-227">The location of the ValidationSummary control doesn t really matter, since we re going to configure it to only display the summary as a messagebox.</span></span> <span data-ttu-id="a6b53-228">コントロールを追加すると、次のように設定します。 その[`ShowSummary`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showsummary(VS.80).aspx)に`False`とその[`ShowMessageBox`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showmessagebox(VS.80).aspx)に`True`します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-228">After adding the control, set its [`ShowSummary` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showsummary(VS.80).aspx) to `False` and its [`ShowMessageBox` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showmessagebox(VS.80).aspx) to `True`.</span></span> <span data-ttu-id="a6b53-229">これにより、検証エラーがクライアント側のメッセージ ボックス データベースで集計されます (図 6 参照)。</span><span class="sxs-lookup"><span data-stu-id="a6b53-229">With this addition, any validation errors are summarized in a client-side messagebox (see Figure 6).</span></span>


<span data-ttu-id="a6b53-230">[![検証エラーがクライアント側のメッセージ ボックスにまとめます](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image17.png)](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="a6b53-230">[![The Validation Errors are Summarized in a Client-Side Messagebox](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image17.png)](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image16.png)</span></span>

<span data-ttu-id="a6b53-231">**図 6**: クライアント側のメッセージ ボックスで、検証エラーをまとめます ([フルサイズの画像を表示する をクリックします](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image18.png))。</span><span class="sxs-lookup"><span data-stu-id="a6b53-231">**Figure 6**: The Validation Errors are Summarized in a Client-Side Messagebox ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-cs/_static/image18.png))</span></span>


## <a name="summary"></a><span data-ttu-id="a6b53-232">まとめ</span><span class="sxs-lookup"><span data-stu-id="a6b53-232">Summary</span></span>

<span data-ttu-id="a6b53-233">このチュートリアルでは、事前に、ユーザー入力が更新のワークフローで使用する前に有効であることを確認する検証コントロールを使用して、例外の可能性を低減する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="a6b53-233">In this tutorial we saw how to reduce the likelihood of exceptions by using validation controls to proactively ensure that our users inputs are valid before attempting to use them in the updating workflow.</span></span> <span data-ttu-id="a6b53-234">ASP.NET では、特定の Web を検査するように設計された 5 つの検証 Web コントロールが入力を制御し、入力の有効性を報告を提供します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-234">ASP.NET provides five validation Web controls that are designed to inspect a particular Web control s input and report back on the input s validity.</span></span> <span data-ttu-id="a6b53-235">このチュートリアルで使用してこれら 5 つのコントロールの 2 つ、RequiredFieldValidator およびに CompareValidator s の製品名を指定して、価格がより大きいまたは 0 以下の値を持つ通貨書式を持っていることを確認しました。</span><span class="sxs-lookup"><span data-stu-id="a6b53-235">In this tutorial we used two of those five controls the RequiredFieldValidator and the CompareValidator to ensure that the product s name was supplied and that the price had a currency format with a value greater than or equal to zero.</span></span>

<span data-ttu-id="a6b53-236">上にドラッグするだけではインターフェイスの編集、DataList に検証コントロールを追加、`EditItemTemplate`からツールボックスといくつかのプロパティを設定します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-236">Adding validation controls to the DataList s editing interface is as simple as dragging them onto the `EditItemTemplate` from the Toolbox and setting a handful of properties.</span></span> <span data-ttu-id="a6b53-237">既定では、検証コントロールに自動的に生成クライアント側の検証スクリプトサーバー側の検証で累積的な結果を格納する、ポストバックの提供、`Page.IsValid`プロパティ。</span><span class="sxs-lookup"><span data-stu-id="a6b53-237">By default, the validation controls automatically emit client-side validation script; they also provide server-side validation on postback, storing the cumulative result in the `Page.IsValid` property.</span></span> <span data-ttu-id="a6b53-238">ボタン、LinkButton や ImageButton がクリックされたときに、クライアント側の検証をバイパスする設定ボタン s`CausesValidation`プロパティを`False`します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-238">To bypass the client-side validation when a Button, LinkButton, or ImageButton is clicked, set the button s `CausesValidation` property to `False`.</span></span> <span data-ttu-id="a6b53-239">また、ポストバック時に送信されたデータのすべてのタスクを実行する前にすることを確認、`Page.IsValid`プロパティが返す`True`します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-239">Also, before performing any tasks with the data submitted on postback, ensure that the `Page.IsValid` property returns `True`.</span></span>

<span data-ttu-id="a6b53-240">DataList の編集のチュートリアルのすべて ve これまでに調べる必要がありました編集インターフェイスを非常に単純なテキスト ボックス、s の製品名と価格の。</span><span class="sxs-lookup"><span data-stu-id="a6b53-240">All of the DataList editing tutorials we ve examined so far have had very simple editing interfaces a TextBox for the product s name and another for the price.</span></span> <span data-ttu-id="a6b53-241">ただし、編集のインターフェイスは、Dropdownlist、カレンダー、ボタン、チェック ボックスなどの別の Web コントロールの組み合わせを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="a6b53-241">The editing interface, however, can contain a mix of different Web controls, such as DropDownLists, Calendars, RadioButtons, CheckBoxes, and so on.</span></span> <span data-ttu-id="a6b53-242">次のチュートリアルでは、さまざまな Web コントロールを使用するインターフェイスの構築に紹介します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-242">In our next tutorial we'll look at building an interface that uses a variety of Web controls.</span></span>

<span data-ttu-id="a6b53-243">満足のプログラミングです。</span><span class="sxs-lookup"><span data-stu-id="a6b53-243">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="a6b53-244">執筆者紹介</span><span class="sxs-lookup"><span data-stu-id="a6b53-244">About the Author</span></span>

<span data-ttu-id="a6b53-245">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)、7 つ受け取りますブックおよびの創設者の著者[4GuysFromRolla.com](http://www.4guysfromrolla.com)、Microsoft Web テクノロジと 1998 年から携わっています。</span><span class="sxs-lookup"><span data-stu-id="a6b53-245">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="a6b53-246">Scott は、フリーのコンサルタント、トレーナー、およびライターとして動作します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-246">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="a6b53-247">最新の著書は[ *Sams 教える自分で ASP.NET 2.0 24 時間以内に*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-247">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="a6b53-248">彼に到達できる[mitchell@4GuysFromRolla.comします。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="a6b53-248">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="a6b53-249">彼のブログにあるでまたは[ http://ScottOnWriting.NET](http://ScottOnWriting.NET)します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-249">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="a6b53-250">特別なに感謝します。</span><span class="sxs-lookup"><span data-stu-id="a6b53-250">Special Thanks To</span></span>

<span data-ttu-id="a6b53-251">このチュートリアル シリーズは、多くの便利なレビュー担当者によってレビューされました。</span><span class="sxs-lookup"><span data-stu-id="a6b53-251">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="a6b53-252">このチュートリアルでは、潜在顧客レビュー担当者は、Dennis Patterson、Ken Pespisa、Liz Shulok でした。</span><span class="sxs-lookup"><span data-stu-id="a6b53-252">Lead reviewers for this tutorial were Dennis Patterson, Ken Pespisa, and Liz Shulok.</span></span> <span data-ttu-id="a6b53-253">今後、MSDN の記事を確認したいですか。</span><span class="sxs-lookup"><span data-stu-id="a6b53-253">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="a6b53-254">場合は、筆者に[mitchell@4GuysFromRolla.comします。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="a6b53-254">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="a6b53-255">[前へ](handling-bll-and-dal-level-exceptions-cs.md)
> [次へ](customizing-the-datalist-s-editing-interface-cs.md)</span><span class="sxs-lookup"><span data-stu-id="a6b53-255">[Previous](handling-bll-and-dal-level-exceptions-cs.md)
[Next](customizing-the-datalist-s-editing-interface-cs.md)</span></span>
