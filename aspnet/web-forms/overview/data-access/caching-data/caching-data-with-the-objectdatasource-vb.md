---
uid: web-forms/overview/data-access/caching-data/caching-data-with-the-objectdatasource-vb
title: ObjectDataSource (VB) でデータをキャッシュ |Microsoft Docs
author: rick-anderson
description: キャッシュすると、低速と高速な Web アプリケーションの違いを意味します。 このチュートリアルでは、ASP.NET でのキャッシュで詳しく説明する 4 つの 1 つ目は.
ms.author: aspnetcontent
manager: wpickett
ms.date: 05/30/2007
ms.topic: article
ms.assetid: 2e56a733-5512-48a6-9276-70a65bbe4d5d
ms.technology: dotnet-webforms
msc.legacyurl: /web-forms/overview/data-access/caching-data/caching-data-with-the-objectdatasource-vb
msc.type: authoredcontent
ms.openlocfilehash: 9db4811687af3b029b7011763f9b5af0a8c1daec
ms.sourcegitcommit: 953ff9ea4369f154d6fd0239599279ddd3280009
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/03/2018
ms.locfileid: "37364998"
---
<a name="caching-data-with-the-objectdatasource-vb"></a><span data-ttu-id="7a1ef-104">ObjectDataSource (VB) でデータをキャッシュ</span><span class="sxs-lookup"><span data-stu-id="7a1ef-104">Caching Data with the ObjectDataSource (VB)</span></span>
====================
<span data-ttu-id="7a1ef-105">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="7a1ef-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="7a1ef-106">[サンプル アプリをダウンロード](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_58_VB.exe)または[PDF のダウンロード](caching-data-with-the-objectdatasource-vb/_static/datatutorial58vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="7a1ef-106">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_58_VB.exe) or [Download PDF](caching-data-with-the-objectdatasource-vb/_static/datatutorial58vb1.pdf)</span></span>

> <span data-ttu-id="7a1ef-107">キャッシュすると、低速と高速な Web アプリケーションの違いを意味します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-107">Caching can mean the difference between a slow and a fast Web application.</span></span> <span data-ttu-id="7a1ef-108">このチュートリアルでは、ASP.NET でのキャッシュで詳しく説明する 4 つの 1 つ目です。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-108">This tutorial is the first of four that take a detailed look at caching in ASP.NET.</span></span> <span data-ttu-id="7a1ef-109">キャッシュの主な概念と ObjectDataSource コントロールを通じて、プレゼンテーション層にキャッシュを適用する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-109">Learn the key concepts of caching and how to apply caching to the Presentation Layer through the ObjectDataSource control.</span></span>


## <a name="introduction"></a><span data-ttu-id="7a1ef-110">はじめに</span><span class="sxs-lookup"><span data-stu-id="7a1ef-110">Introduction</span></span>

<span data-ttu-id="7a1ef-111">コンピューター サイエンス、*キャッシュ*データまたは取得のコストが情報を取得し、アクセスする方が手軽な場所にそのコピーを格納するプロセスです。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-111">In computer science, *caching* is the process of taking data or information that is expensive to obtain and storing a copy of it in a location that is quicker to access.</span></span> <span data-ttu-id="7a1ef-112">データ ドリブンのアプリケーションでは、大規模で複雑なクエリはよく、アプリケーションの実行時間の大部分を消費します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-112">For data-driven applications, large and complex queries commonly consume the majority of the application s execution time.</span></span> <span data-ttu-id="7a1ef-113">このようなアプリケーションのパフォーマンス、次は、アプリケーション メモリに負荷の高いデータベース クエリの結果を格納することで多くの場合、改善できます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-113">Such an application s performance, then, can often be improved by storing the results of expensive database queries in the application s memory.</span></span>

<span data-ttu-id="7a1ef-114">ASP.NET 2.0 には、さまざまなキャッシュ オプションが用意されています。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-114">ASP.NET 2.0 offers a variety of caching options.</span></span> <span data-ttu-id="7a1ef-115">キャッシュできる、web ページ全体またはユーザー コントロールにレンダリングされますマークアップ*出力キャッシュ*します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-115">An entire web page or User Control s rendered markup can be cached through *output caching*.</span></span> <span data-ttu-id="7a1ef-116">ObjectDataSource や SqlDataSource コントロールでは、コントロール レベルでキャッシュするためにも、データを許可するキャッシュの機能を提供します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-116">The ObjectDataSource and SqlDataSource controls provide caching capabilities as well, thereby allowing data to be cached at the control level.</span></span> <span data-ttu-id="7a1ef-117">ASP.NET s*データ キャッシュ*により、ページ開発者は、プログラムでのキャッシュ オブジェクトをリッチなキャッシュ API を提供します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-117">And ASP.NET s *data cache* provides a rich caching API that enables page developers to programmatically cache objects.</span></span> <span data-ttu-id="7a1ef-118">このチュートリアルと ObjectDataSource s の使用について説明します、次の 3 つのデータ キャッシュだけでなく、機能をキャッシュします。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-118">In this tutorial and the next three we'll examine using the ObjectDataSource s caching features as well as the data cache.</span></span> <span data-ttu-id="7a1ef-119">起動時にアプリケーション全体のデータをキャッシュする方法と新しい SQL キャッシュ依存関係を使用してキャッシュされたデータを保持する方法についても説明します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-119">We'll also explore how to cache application-wide data at startup and how to keep cached data fresh through the use of SQL cache dependencies.</span></span> <span data-ttu-id="7a1ef-120">これらのチュートリアルでは、出力キャッシュは表示されません。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-120">These tutorials do not explore output caching.</span></span> <span data-ttu-id="7a1ef-121">出力キャッシュの詳細については、次を参照してください。 [ASP.NET 2.0 で出力キャッシュ](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx)します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-121">For a detailed look at output caching, see [Output Caching in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx).</span></span>

<span data-ttu-id="7a1ef-122">キャッシュを適用できるアーキテクチャでは、任意の場所でデータ アクセス層からのプレゼンテーション レイヤーを通して行われます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-122">Caching can be applied at any place in the architecture, from the Data Access Layer up through the Presentation Layer.</span></span> <span data-ttu-id="7a1ef-123">このチュートリアルでは、ObjectDataSource コントロールを通じて、プレゼンテーション層にキャッシュを適用することに紹介します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-123">In this tutorial we'll look at applying caching to the Presentation Layer through the ObjectDataSource control.</span></span> <span data-ttu-id="7a1ef-124">について説明します、次のチュートリアルでは、ビジネス ロジック層でデータをキャッシュします。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-124">In the next tutorial we'll examine caching data at the Business Logic Layer.</span></span>

## <a name="key-caching-concepts"></a><span data-ttu-id="7a1ef-125">キーのキャッシュの概念</span><span class="sxs-lookup"><span data-stu-id="7a1ef-125">Key Caching Concepts</span></span>

<span data-ttu-id="7a1ef-126">秒のアプリケーションを大幅に改善できるキャッシュ全体のパフォーマンスとスケーラビリティが生成する負荷の高いデータを取得しより効率的にアクセスできる場所にそのコピーを格納します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-126">Caching can greatly improve an application s overall performance and scalability by taking data that is expensive to generate and storing a copy of it in a location that can be more efficiently accessed.</span></span> <span data-ttu-id="7a1ef-127">キャッシュは、実際、基になるデータのコピーだけを保持しているため、古いかかるまたは*古い*、基になるデータが変更された場合。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-127">Since the cache holds just a copy of the actual, underlying data, it can become outdated, or *stale*, if the underlying data changes.</span></span> <span data-ttu-id="7a1ef-128">このページの開発者がキャッシュ項目があるされる条件を指定できます*削除*キャッシュからいずれかを使用します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-128">To combat this, a page developer can indicate criteria by which the cache item will be *evicted* from the cache, using either:</span></span>

- <span data-ttu-id="7a1ef-129">**時間ベースの条件**絶対またはスライド時間のキャッシュに項目を追加することがあります。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-129">**Time-based criteria** an item may be added to the cache for an absolute or sliding duration.</span></span> <span data-ttu-id="7a1ef-130">たとえば、ページの開発者は、60 秒間の期間に可能性があります。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-130">For example, a page developer may indicate a duration of, say, 60 seconds.</span></span> <span data-ttu-id="7a1ef-131">絶対時間の場合は、キャッシュされた項目にアクセスした頻度に関係なく、キャッシュに追加された後、60 秒が削除されます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-131">With an absolute duration, the cached item is evicted 60 seconds after it was added to cache, regardless of how frequently it was accessed.</span></span> <span data-ttu-id="7a1ef-132">スライディング継続時間が、キャッシュされた項目は最終アクセス後に 60 秒間に削除されます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-132">With a sliding duration, the cached item is evicted 60 seconds after the last access.</span></span>
- <span data-ttu-id="7a1ef-133">**依存関係に基づく条件**依存関係がキャッシュに追加されたときに項目を関連付けることができます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-133">**Dependency-based criteria** a dependency can be associated with an item when added to the cache.</span></span> <span data-ttu-id="7a1ef-134">項目 %s の依存関係が変更されたときに、キャッシュから削除されます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-134">When the item s dependency changes it is evicted from the cache.</span></span> <span data-ttu-id="7a1ef-135">ファイルを別のキャッシュ項目または 2 つの組み合わせ、依存関係があります。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-135">The dependency may be a file, another cache item, or a combination of the two.</span></span> <span data-ttu-id="7a1ef-136">ASP.NET 2.0 では、開発者は、キャッシュに項目を追加して、それを基になるデータベースのデータが変更されたときの削除を有効にする SQL キャッシュ依存関係もできます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-136">ASP.NET 2.0 also allows SQL cache dependencies, which enable developers to add an item to the cache and have it evicted when the underlying database data changes.</span></span> <span data-ttu-id="7a1ef-137">近日出版予定の SQL キャッシュ依存関係を究明する[を使用して SQL キャッシュ依存関係](using-sql-cache-dependencies-vb.md)チュートリアル。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-137">We will examine SQL cache dependencies in the upcoming [Using SQL Cache Dependencies](using-sql-cache-dependencies-vb.md) tutorial.</span></span>

<span data-ttu-id="7a1ef-138">指定された削除条件に関係なく、キャッシュ内の項目があります*清掃*前に、時間ベースまたは依存関係に基づく条件は満たされました。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-138">Regardless of the eviction criteria specified, an item in the cache may be *scavenged* before the time-based or dependency-based criteria has been met.</span></span> <span data-ttu-id="7a1ef-139">キャッシュのキャパシティに達して新しいファイルを追加する前に、既存の項目を削除してください。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-139">If the cache has reached its capacity, existing items must be removed before new ones can be added.</span></span> <span data-ttu-id="7a1ef-140">その結果、使用する場合プログラムでキャッシュされたデータが s を常に想定することが重要、キャッシュされたデータいない存在できます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-140">Consequently, when programmatically working with cached data it s vital that you always assume that the cached data may not be present.</span></span> <span data-ttu-id="7a1ef-141">次のチュートリアルでは、プログラムでキャッシュからデータにアクセスするときに使用するパターンについて説明します*アーキテクチャでデータをキャッシュ*します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-141">We'll look at the pattern to use when accessing data from the cache programmatically in our next tutorial, *Caching Data in the Architecture*.</span></span>

<span data-ttu-id="7a1ef-142">キャッシュは、アプリケーションから複数のパフォーマンスをつかんでの経済的な手段を提供します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-142">Caching provides an economical means for squeezing more performance from an application.</span></span> <span data-ttu-id="7a1ef-143">として[Steven Smith](http://aspadvice.com/blogs/ssmith/)彼の記事で示される[ASP.NET キャッシュ: テクニックとベスト プラクティス](https://msdn.microsoft.com/library/aa478965.aspx):</span><span class="sxs-lookup"><span data-stu-id="7a1ef-143">As [Steven Smith](http://aspadvice.com/blogs/ssmith/) articulates in his article [ASP.NET Caching: Techniques and Best Practices](https://msdn.microsoft.com/library/aa478965.aspx):</span></span>

<span data-ttu-id="7a1ef-144">キャッシュは、上達するための十分なパフォーマンス、多くの時間と分析を必要とせず、適切な方法です。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-144">Caching can be a good way to get good enough performance without requiring a lot of time and analysis.</span></span> <span data-ttu-id="7a1ef-145">メモリが低コスト、30 秒、1 日または週に、コードまたはデータベースの最適化を試みるをかける代わりに、出力をキャッシュすることによって必要なパフォーマンスを得ることができる場合のキャッシュ ソリューションを実行するため ([ok] は秒前-30 のデータと仮定) 移動します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-145">Memory is cheap, so if you can get the performance you need by caching the output for 30 seconds instead of spending a day or a week trying to optimize your code or database, do the caching solution (assuming 30-second old data is ok) and move on.</span></span> <span data-ttu-id="7a1ef-146">最終的には、不適切なデザインはおそらく追いつきます、使用するため、コースのアプリケーションを正しく設計するとき必要があります。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-146">Eventually, poor design will probably catch up to you, so of course you should try to design your applications correctly.</span></span> <span data-ttu-id="7a1ef-147">良いための十分なパフォーマンスを向上を取得する場合は、キャッシュできる優れた [方法]、そのためには時間がある場合、後で、アプリケーションをリファクターする時間を購入します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-147">But if you just need to get good enough performance today, caching can be an excellent [approach], buying you time to refactor your application at a later date when you have the time to do so.</span></span>

<span data-ttu-id="7a1ef-148">キャッシュと、ほどのパフォーマンスの強化が提供することができます、適用可能でないすべての状況でなど、データをリアルタイムで頻繁に更新を使用するかも間もなく有効期間の古いデータが許容されないアプリケーションとします。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-148">While caching can provide appreciable performance enhancements, it is not applicable in all situations, such as with applications that use real-time, frequently-updating data, or where even shortly-lived stale data is unacceptable.</span></span> <span data-ttu-id="7a1ef-149">ただし、大半のアプリケーションでは、キャッシュの使用します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-149">But for the majority of applications, caching should be used.</span></span> <span data-ttu-id="7a1ef-150">ASP.NET 2.0 でのキャッシュの詳細についてを参照してください、[パフォーマンス キャッシュ](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/default.aspx)のセクション、 [ASP.NET 2.0 クイック スタート チュートリアル](https://quickstarts.asp.net/QuickStartv20/aspnet/)します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-150">For more background on caching in ASP.NET 2.0, refer to the [Caching for Performance](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/default.aspx) section of the [ASP.NET 2.0 QuickStart Tutorials](https://quickstarts.asp.net/QuickStartv20/aspnet/).</span></span>

## <a name="step-1-creating-the-caching-web-pages"></a><span data-ttu-id="7a1ef-151">手順 1: Web ページのキャッシュを作成します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-151">Step 1: Creating the Caching Web Pages</span></span>

<span data-ttu-id="7a1ef-152">ObjectDataSource s のキャッシュ機能の探索を始める前に、このチュートリアルと、次の 3 つの必要がありますが、web サイト プロジェクトで ASP.NET ページを作成する最初に少し s を使用できます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-152">Before we start our exploration of the ObjectDataSource s caching features, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="7a1ef-153">という名前の新しいフォルダーを追加することで開始`Caching`します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-153">Start by adding a new folder named `Caching`.</span></span> <span data-ttu-id="7a1ef-154">次に、次の ASP.NET ページを使用する各ページに関連付けることを確認、そのフォルダーに追加、`Site.master`マスター ページ。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-154">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `ObjectDataSource.aspx`
- `FromTheArchitecture.aspx`
- `AtApplicationStartup.aspx`
- `SqlCacheDependencies.aspx`


![キャッシュに関連するチュートリアルについては、ASP.NET ページに追加します。](caching-data-with-the-objectdatasource-vb/_static/image1.png)

<span data-ttu-id="7a1ef-156">**図 1**: キャッシュに関連するチュートリアルについては、ASP.NET ページに追加します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-156">**Figure 1**: Add the ASP.NET Pages for the Caching-Related Tutorials</span></span>


<span data-ttu-id="7a1ef-157">などの他のフォルダーで`Default.aspx`で、`Caching`フォルダーは、チュートリアルのセクションで一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-157">Like in the other folders, `Default.aspx` in the `Caching` folder will list the tutorials in its section.</span></span> <span data-ttu-id="7a1ef-158">いることを思い出してください、`SectionLevelTutorialListing.ascx`ユーザー コントロールは、この機能を提供します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-158">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="7a1ef-159">そのため、このユーザー コントロールを追加`Default.aspx`をページのデザイン ビューに ソリューション エクスプ ローラーからドラッグしています。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-159">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>


<span data-ttu-id="7a1ef-160">[![図 2: SectionLevelTutorialListing.ascx ユーザー コントロールを Default.aspx に追加します。](caching-data-with-the-objectdatasource-vb/_static/image3.png)](caching-data-with-the-objectdatasource-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="7a1ef-160">[![Figure 2: Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](caching-data-with-the-objectdatasource-vb/_static/image3.png)](caching-data-with-the-objectdatasource-vb/_static/image2.png)</span></span>

<span data-ttu-id="7a1ef-161">**図 2**図 2: 追加、`SectionLevelTutorialListing.ascx`ユーザー コントロールを`Default.aspx`([フルサイズの画像を表示する をクリックします。](caching-data-with-the-objectdatasource-vb/_static/image4.png))。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-161">**Figure 2**: Figure 2: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image4.png))</span></span>


<span data-ttu-id="7a1ef-162">最後に、これらのページを追加するエントリとして、`Web.sitemap`ファイル。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-162">Lastly, add these pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="7a1ef-163">具体的には、バイナリ データで作業した後、次のマークアップを追加`<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="7a1ef-163">Specifically, add the following markup after the Working with Binary Data `<siteMapNode>`:</span></span>


[!code-xml[Main](caching-data-with-the-objectdatasource-vb/samples/sample1.xml)]

<span data-ttu-id="7a1ef-164">更新した後`Web.sitemap`、時間、ブラウザーを使ってチュートリアル web サイトを表示するのにはかかりません。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-164">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="7a1ef-165">左側のメニューで、チュートリアルについては、キャッシュ項目できるようになりました。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-165">The menu on the left now includes items for the caching tutorials.</span></span>


![サイト マップのチュートリアルでは、キャッシュ エントリになりました](caching-data-with-the-objectdatasource-vb/_static/image5.png)

<span data-ttu-id="7a1ef-167">**図 3**: サイト マップのチュートリアルでは、キャッシュ エントリになりました</span><span class="sxs-lookup"><span data-stu-id="7a1ef-167">**Figure 3**: The Site Map Now Includes Entries for the Caching Tutorials</span></span>


## <a name="step-2-displaying-a-list-of-products-in-a-web-page"></a><span data-ttu-id="7a1ef-168">手順 2: Web ページで製品の一覧を表示します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-168">Step 2: Displaying a List of Products in a Web Page</span></span>

<span data-ttu-id="7a1ef-169">このチュートリアルでは、ObjectDataSource コントロール s 組み込みキャッシュ機能を使用する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-169">This tutorial explores how to use the ObjectDataSource control s built-in caching features.</span></span> <span data-ttu-id="7a1ef-170">これらの機能を見て、前に、まず必要がありますのページから作業をします。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-170">Before we can look at these features, though, we first need a page to work from.</span></span> <span data-ttu-id="7a1ef-171">Let s は、製品情報を一覧から、ObjectDataSource によって取得された、GridView を使用する web ページを作成、`ProductsBLL`クラス。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-171">Let s create a web page that uses a GridView to list product information retrieved by an ObjectDataSource from the `ProductsBLL` class.</span></span>

<span data-ttu-id="7a1ef-172">開いて開始、`ObjectDataSource.aspx`ページで、`Caching`フォルダー。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-172">Start by opening the `ObjectDataSource.aspx` page in the `Caching` folder.</span></span> <span data-ttu-id="7a1ef-173">ツールボックスからデザイナーに、GridView をドラッグして、設定、`ID`プロパティを`Products`、という名前の新しい ObjectDataSource コントロールにバインドを選択して、スマート タグからとは、`ProductsDataSource`します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-173">Drag a GridView from the Toolbox onto the Designer, set its `ID` property to `Products`, and, from its smart tag, choose to bind it to a new ObjectDataSource control named `ProductsDataSource`.</span></span> <span data-ttu-id="7a1ef-174">構成を使用する ObjectDataSource、`ProductsBLL`クラス。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-174">Configure the ObjectDataSource to work with the `ProductsBLL` class.</span></span>


<span data-ttu-id="7a1ef-175">[![ProductsBLL クラスを使用する ObjectDataSource を構成します。](caching-data-with-the-objectdatasource-vb/_static/image7.png)](caching-data-with-the-objectdatasource-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="7a1ef-175">[![Configure the ObjectDataSource to Use the ProductsBLL Class](caching-data-with-the-objectdatasource-vb/_static/image7.png)](caching-data-with-the-objectdatasource-vb/_static/image6.png)</span></span>

<span data-ttu-id="7a1ef-176">**図 4**: 構成に使用する ObjectDataSource、`ProductsBLL`クラス ([フルサイズの画像を表示する をクリックします](caching-data-with-the-objectdatasource-vb/_static/image8.png))。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-176">**Figure 4**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image8.png))</span></span>


<span data-ttu-id="7a1ef-177">このページでは、s GridView の s インターフェイスを通じて、ObjectDataSource にキャッシュされたデータが変更されたときの動作を検証できるように編集可能な GridView を作成することができます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-177">For this page, let s create an editable GridView so that we can examine what happens when data cached in the ObjectDataSource is modified through the GridView s interface.</span></span> <span data-ttu-id="7a1ef-178">既定の設定に選択します タブで、ドロップダウン リストのままに`GetProducts()`、更新プログラム タブを選択した項目の変更が、`UpdateProduct`を受け入れるオーバー ロード`productName`、 `unitPrice`、および`productID`入力パラメーターとして。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-178">Leave the drop-down list in the SELECT tab set to its default, `GetProducts()`, but change the selected item in the UPDATE tab to the `UpdateProduct` overload that accepts `productName`, `unitPrice`, and `productID` as its input parameters.</span></span>


<span data-ttu-id="7a1ef-179">[![適切な UpdateProduct オーバー ロードに更新 タブのドロップダウン リストを設定します。](caching-data-with-the-objectdatasource-vb/_static/image10.png)](caching-data-with-the-objectdatasource-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="7a1ef-179">[![Set the UPDATE Tab s Drop-Down List to the Appropriate UpdateProduct Overload](caching-data-with-the-objectdatasource-vb/_static/image10.png)](caching-data-with-the-objectdatasource-vb/_static/image9.png)</span></span>

<span data-ttu-id="7a1ef-180">**図 5**: 更新 タブのドロップダウン リストを適切に設定`UpdateProduct`オーバー ロード ([フルサイズの画像を表示する をクリックします](caching-data-with-the-objectdatasource-vb/_static/image11.png))。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-180">**Figure 5**: Set the UPDATE Tab s Drop-Down List to the Appropriate `UpdateProduct` Overload ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image11.png))</span></span>


<span data-ttu-id="7a1ef-181">最後に、(なし) を挿入および削除のタブで、ドロップダウン リストを設定し、[完了] をクリックします。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-181">Finally, set the drop-down lists in the INSERT and DELETE tabs to (None) and click Finish.</span></span> <span data-ttu-id="7a1ef-182">データ ソース構成ウィザードを完了すると、Visual Studio 設定 ObjectDataSource s`OldValuesParameterFormatString`プロパティを`original_{0}`します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-182">Upon completing the Configure Data Source wizard, Visual Studio sets the ObjectDataSource s `OldValuesParameterFormatString` property to `original_{0}`.</span></span> <span data-ttu-id="7a1ef-183">説明したように、[挿入の概要、更新、およびデータの削除](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md)チュートリアルでは、このプロパティは、宣言構文から削除するか、その既定値に戻す設定する必要がある`{0}`、更新したワークフローのためにエラーを行わずに続行します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-183">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, this property needs to be removed from the declarative syntax or set back to its default value, `{0}`, in order for our update workflow to proceed without error.</span></span>

<span data-ttu-id="7a1ef-184">さらに、ウィザードの完了時に Visual Studio にフィールドを追加、GridView の各製品のデータ フィールドの。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-184">Furthermore, at the completion of the wizard Visual Studio adds a field to the GridView for each of the product data fields.</span></span> <span data-ttu-id="7a1ef-185">削除以外のすべて、 `ProductName`、 `CategoryName`、および`UnitPrice`BoundFields します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-185">Remove all but the `ProductName`, `CategoryName`, and `UnitPrice` BoundFields.</span></span> <span data-ttu-id="7a1ef-186">次に、更新、`HeaderText`各製品カテゴリで、価格、およびこれら BoundFields のプロパティそれぞれします。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-186">Next, update the `HeaderText` properties of each of these BoundFields to Product, Category, and Price, respectively.</span></span> <span data-ttu-id="7a1ef-187">以降、`ProductName`フィールドは必須です、BoundField を TemplateField に変換し、RequiredFieldValidator への追加、`EditItemTemplate`します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-187">Since the `ProductName` field is required, convert the BoundField into a TemplateField and add a RequiredFieldValidator to the `EditItemTemplate`.</span></span> <span data-ttu-id="7a1ef-188">同様に、変換、`UnitPrice`を TemplateField BoundField、ユーザーが入力した値が有効な通貨の値より大きいまたは 0 に等しい s であることを確認する CompareValidator を追加します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-188">Similarly, convert the `UnitPrice` BoundField into a TemplateField and add a CompareValidator to ensure that the value entered by the user is a valid currency value that s greater than or equal to zero.</span></span> <span data-ttu-id="7a1ef-189">これらの変更だけでなく自由に右揃えなど、美的な変更を実行、`UnitPrice`値、または書式設定を指定する、`UnitPrice`その読み取り専用と編集インターフェイスのテキスト。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-189">In addition to these modifications, feel free to perform any aesthetic changes, such as right-aligning the `UnitPrice` value, or specifying the formatting for the `UnitPrice` text in its read-only and editing interfaces.</span></span>

<span data-ttu-id="7a1ef-190">GridView のスマート タグの編集を有効にするチェック ボックスをオンして、GridView を編集可能です。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-190">Make the GridView editable by checking the Enable Editing checkbox in the GridView s smart tag.</span></span> <span data-ttu-id="7a1ef-191">ページングを有効にして、並べ替えを有効にするチェック ボックスも確認してください。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-191">Also check the Enable Paging and Enable Sorting checkboxes.</span></span>

> [!NOTE]
> <span data-ttu-id="7a1ef-192">GridView の編集インターフェイスをカスタマイズする方法のレビューが必要ですか。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-192">Need a review of how to customize the GridView s editing interface?</span></span> <span data-ttu-id="7a1ef-193">そうである場合に戻って、[データ変更インターフェイスをカスタマイズ](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md)チュートリアル。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-193">If so, refer back to the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial.</span></span>


<span data-ttu-id="7a1ef-194">[![編集、並べ替え、およびページングを GridView サポートを有効にします。](caching-data-with-the-objectdatasource-vb/_static/image13.png)](caching-data-with-the-objectdatasource-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="7a1ef-194">[![Enable GridView Support for Editing, Sorting, and Paging](caching-data-with-the-objectdatasource-vb/_static/image13.png)](caching-data-with-the-objectdatasource-vb/_static/image12.png)</span></span>

<span data-ttu-id="7a1ef-195">**図 6**: 編集、並べ替え、およびページングの GridView サポートを有効にする ([フルサイズの画像を表示する をクリックします](caching-data-with-the-objectdatasource-vb/_static/image14.png))。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-195">**Figure 6**: Enable GridView Support for Editing, Sorting, and Paging ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image14.png))</span></span>


<span data-ttu-id="7a1ef-196">GridView のこれらの変更を加えたら、GridView コントロールと ObjectDataSource s の宣言型マークアップを次のようになります。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-196">After making these GridView modifications, the GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](caching-data-with-the-objectdatasource-vb/samples/sample2.aspx)]

<span data-ttu-id="7a1ef-197">図 7 に示す、編集可能な GridView には、名前、カテゴリ、および各データベースでは、製品の価格が一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-197">As Figure 7 shows, the editable GridView lists the name, category, and price of each of the products in the database.</span></span> <span data-ttu-id="7a1ef-198">テスト ページの機能の並べ替え結果をそれらを使用してページとレコードを編集します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-198">Take a moment to test out the page s functionality sort the results, page through them, and edit a record.</span></span>


<span data-ttu-id="7a1ef-199">[![各製品名、カテゴリ、および価格は、ソート可能、Pageable、編集可能な GridView に表示されます。](caching-data-with-the-objectdatasource-vb/_static/image16.png)](caching-data-with-the-objectdatasource-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="7a1ef-199">[![Each Product s Name, Category, and Price is Listed in a Sortable, Pageable, Editable GridView](caching-data-with-the-objectdatasource-vb/_static/image16.png)](caching-data-with-the-objectdatasource-vb/_static/image15.png)</span></span>

<span data-ttu-id="7a1ef-200">**図 7**: 各製品の名前、カテゴリ、および価格は、ソート可能、Pageable、編集可能な GridView で表示されます ([フルサイズの画像を表示する をクリックします](caching-data-with-the-objectdatasource-vb/_static/image17.png))。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-200">**Figure 7**: Each Product s Name, Category, and Price is Listed in a Sortable, Pageable, Editable GridView ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image17.png))</span></span>


## <a name="step-3-examining-when-the-objectdatasource-is-requesting-data"></a><span data-ttu-id="7a1ef-201">手順 3: データの要求をときに、ObjectDataSource を調べること</span><span class="sxs-lookup"><span data-stu-id="7a1ef-201">Step 3: Examining When the ObjectDataSource is Requesting Data</span></span>

<span data-ttu-id="7a1ef-202">`Products` GridView を呼び出すことによって表示するには、そのデータを取得、`Select`のメソッド、 `ProductsDataSource` ObjectDataSource します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-202">The `Products` GridView retrieves its data to display by invoking the `Select` method of the `ProductsDataSource` ObjectDataSource.</span></span> <span data-ttu-id="7a1ef-203">この ObjectDataSource は、ビジネス ロジック層 s のインスタンスを作成します。`ProductsBLL`クラスと呼び出しの`GetProducts()`メソッドをさらに、データ アクセス層の s を呼び出す`ProductsTableAdapter`s`GetProducts()`メソッド。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-203">This ObjectDataSource creates an instance of the Business Logic Layer s `ProductsBLL` class and calls its `GetProducts()` method, which in turn calls the Data Access Layer s `ProductsTableAdapter` s `GetProducts()` method.</span></span> <span data-ttu-id="7a1ef-204">DAL メソッドは、Northwind データベースに接続し、構成済みの問題`SELECT`クエリ。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-204">The DAL method connects to the Northwind database and issues the configured `SELECT` query.</span></span> <span data-ttu-id="7a1ef-205">このデータは、DAL では、パッケージ化に返されます、`NorthwindDataTable`します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-205">This data is then returned to the DAL, which packages it up in a `NorthwindDataTable`.</span></span> <span data-ttu-id="7a1ef-206">DataTable オブジェクトには、GridView に返されます ObjectDataSource に返されます BLL が返されます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-206">The DataTable object is returned to the BLL, which returns it to the ObjectDataSource, which returns it to the GridView.</span></span> <span data-ttu-id="7a1ef-207">GridView を作成し、`GridViewRow`オブジェクトごとに`DataRow`DataTable には、および各`GridViewRow`がクライアントに返され、秒のユーザーのブラウザーで表示される HTML に最終的にレンダリングされます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-207">The GridView then creates a `GridViewRow` object for each `DataRow` in the DataTable, and each `GridViewRow` is eventually rendered into the HTML that is returned to the client and displayed on the visitor s browser.</span></span>

<span data-ttu-id="7a1ef-208">この一連のイベントは、GridView は、その基になるデータにバインドする必要があるたびに発生します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-208">This sequence of events happens each and every time the GridView needs to bind to its underlying data.</span></span> <span data-ttu-id="7a1ef-209">ページが初めてアクセスした、または、GridView を並べ替えるときに、編集、またはインターフェイスの削除は、その組み込みを使用して GridView のデータを変更するときに、データの 1 つのページから移動するときに場合に起こります。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-209">That happens when the page is first visited, when moving from one page of data to another, when sorting the GridView, or when modifying the GridView s data through its built-in editing or deleting interfaces.</span></span> <span data-ttu-id="7a1ef-210">GridView のビュー ステートが無効になっている場合は、各ポストバックもに、GridView に再バインドできます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-210">If the GridView s view state is disabled, the GridView will be rebound on each and every postback as well.</span></span> <span data-ttu-id="7a1ef-211">GridView も明示的に再バインドできるそのデータを呼び出すことによってその`DataBind()`メソッド。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-211">The GridView can also be explicitly rebound to its data by calling its `DataBind()` method.</span></span>

<span data-ttu-id="7a1ef-212">データベースからデータを取得する頻度を完全に理解するには、s、データの再取得されたときを示すメッセージを表示することができます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-212">To fully appreciate the frequency with which the data is retrieved from the database, let s display a message indicating when the data is being re-retrieved.</span></span> <span data-ttu-id="7a1ef-213">GridView という名前の上のラベルの Web コントロールを追加`ODSEvents`します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-213">Add a Label Web control above the GridView named `ODSEvents`.</span></span> <span data-ttu-id="7a1ef-214">クリアしますその`Text`プロパティとその`EnableViewState`プロパティを`False`します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-214">Clear out its `Text` property and set its `EnableViewState` property to `False`.</span></span> <span data-ttu-id="7a1ef-215">ラベルの下にあるボタンの Web コントロールを追加し、設定、`Text`ポストバックへのプロパティ。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-215">Underneath the Label, add a Button Web control and set its `Text` property to Postback .</span></span>


<span data-ttu-id="7a1ef-216">[![GridView の上のページに、ラベルとボタンを追加します。](caching-data-with-the-objectdatasource-vb/_static/image19.png)](caching-data-with-the-objectdatasource-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="7a1ef-216">[![Add a Label and Button to the Page Above the GridView](caching-data-with-the-objectdatasource-vb/_static/image19.png)](caching-data-with-the-objectdatasource-vb/_static/image18.png)</span></span>

<span data-ttu-id="7a1ef-217">**図 8**: 上、GridView ページに、ラベルとボタンを追加 ([フルサイズの画像を表示する をクリックします](caching-data-with-the-objectdatasource-vb/_static/image20.png))。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-217">**Figure 8**: Add a Label and Button to the Page Above the GridView ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image20.png))</span></span>


<span data-ttu-id="7a1ef-218">ワークフローの間にデータ アクセス、ObjectDataSource の`Selecting`基になるオブジェクトが作成される前に、イベントが発生し、構成されているメソッドが呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-218">During the data access workflow, the ObjectDataSource s `Selecting` event fires before the underlying object is created and its configured method invoked.</span></span> <span data-ttu-id="7a1ef-219">このイベントのイベント ハンドラーを作成し、次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-219">Create an event handler for this event and add the following code:</span></span>


[!code-vb[Main](caching-data-with-the-objectdatasource-vb/samples/sample3.vb)]

<span data-ttu-id="7a1ef-220">ObjectDataSource は、要求をデータ アーキテクチャを作成するたびに、ラベル テキスト選択イベントを発生が表示されます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-220">Each time the ObjectDataSource makes a request to the architecture for data, the Label will display the text Selecting event fired .</span></span>

<span data-ttu-id="7a1ef-221">ブラウザーでこのページを参照してください。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-221">Visit this page in a browser.</span></span> <span data-ttu-id="7a1ef-222">ページが初めてアクセスしたときに発生したテキスト選択イベントが表示されます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-222">When the page is first visited, the text Selecting event fired is shown.</span></span> <span data-ttu-id="7a1ef-223">ポストバックのボタンをクリックし、テキストが表示されないことに注意してください (と仮定すると GridView s`EnableViewState`プロパティに設定されて`True`、既定値)。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-223">Click the Postback button and note that the text disappears (assuming that the GridView s `EnableViewState` property is set to `True`, the default).</span></span> <span data-ttu-id="7a1ef-224">ポストバックの GridView がビューステートから再構築し、そのデータに対して ObjectDataSource には t が有効にするためです。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-224">This is because, on postback, the GridView is reconstructed from its view state and therefore doesn t turn to the ObjectDataSource for its data.</span></span> <span data-ttu-id="7a1ef-225">並べ替え、ページング、または、データを編集する一方、そのデータ ソースを再バインドする GridView とするイベントにテキストが再表示されますが発生したためです。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-225">Sorting, paging, or editing the data, however, causes the GridView to rebind to its data source, and therefore the Selecting event fired text reappears.</span></span>


<span data-ttu-id="7a1ef-226">[![発生するイベントが表示されるたびに、GridView がそのデータ ソースにバインドし、](caching-data-with-the-objectdatasource-vb/_static/image22.png)](caching-data-with-the-objectdatasource-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="7a1ef-226">[![Whenever the GridView is Rebound to its Data Source, Selecting event fired is Displayed](caching-data-with-the-objectdatasource-vb/_static/image22.png)](caching-data-with-the-objectdatasource-vb/_static/image21.png)</span></span>

<span data-ttu-id="7a1ef-227">**図 9**: ときに GridView がそのデータ ソースにバインドし、発生するイベントが表示されます ([フルサイズの画像を表示する をクリックします](caching-data-with-the-objectdatasource-vb/_static/image23.png))。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-227">**Figure 9**: Whenever the GridView is Rebound to its Data Source, Selecting event fired is Displayed ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image23.png))</span></span>


<span data-ttu-id="7a1ef-228">[![ビューステートから再構築する GridView をポストバック ボタンがクリックすると](caching-data-with-the-objectdatasource-vb/_static/image25.png)](caching-data-with-the-objectdatasource-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="7a1ef-228">[![Clicking the Postback Button Causes the GridView to be Reconstructed from its View State](caching-data-with-the-objectdatasource-vb/_static/image25.png)](caching-data-with-the-objectdatasource-vb/_static/image24.png)</span></span>

<span data-ttu-id="7a1ef-229">**図 10**: ポストバックのボタンをクリックすると、ビュー状態から再構築する GridView ([フルサイズの画像を表示する をクリックします](caching-data-with-the-objectdatasource-vb/_static/image26.png))。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-229">**Figure 10**: Clicking the Postback Button Causes the GridView to be Reconstructed from its View State ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image26.png))</span></span>


<span data-ttu-id="7a1ef-230">データがを介してページングまたは並べ替えられて、毎回データベースのデータを取得するは無駄と思われる場合があります。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-230">It may seem wasteful to retrieve the database data each time the data is paged through or sorted.</span></span> <span data-ttu-id="7a1ef-231">結局のところ、以降既定のページングを使用して、ObjectDataSource が取得してすべてのレコードの最初のページを表示するときに。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-231">After all, since we re using default paging, the ObjectDataSource has retrieved all of the records when displaying the first page.</span></span> <span data-ttu-id="7a1ef-232">GridView で並べ替えとページングのサポートが提供されない場合でも、データを取得、データベースからすべてのユーザー (および、ビュー ステートが無効になっている場合、すべてのポストバックの) ページが初めてアクセスした各時間。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-232">Even if the GridView does not provide sorting and paging support, the data must be retrieved from the database each time the page is first visited by any user (and on every postback, if view state is disabled).</span></span> <span data-ttu-id="7a1ef-233">これらのデータベースを追加要求は余分な GridView には、すべてのユーザーに同じデータが表示されている場合。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-233">But if the GridView is showing the same data to all users, these extra database requests are superfluous.</span></span> <span data-ttu-id="7a1ef-234">返される結果をキャッシュできない、`GetProducts()`メソッドおよび bind、GridView に結果をキャッシュしますか?</span><span class="sxs-lookup"><span data-stu-id="7a1ef-234">Why not cache the results returned from the `GetProducts()` method and bind the GridView to those cached results?</span></span>

## <a name="step-4-caching-the-data-using-the-objectdatasource"></a><span data-ttu-id="7a1ef-235">手順 4: ObjectDataSource を使用してデータをキャッシュします。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-235">Step 4: Caching the Data Using the ObjectDataSource</span></span>

<span data-ttu-id="7a1ef-236">いくつかのプロパティを設定するだけでは、ASP.NET のデータ キャッシュで取得したデータを自動的にキャッシュする ObjectDataSource を構成できます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-236">By simply setting a few properties, the ObjectDataSource can be configured to automatically cache its retrieved data in the ASP.NET data cache.</span></span> <span data-ttu-id="7a1ef-237">ObjectDataSource のキャッシュに関連するプロパティを次に示します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-237">The following list summarizes the cache-related properties of the ObjectDataSource:</span></span>

- <span data-ttu-id="7a1ef-238">[EnableCaching](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.enablecaching.aspx)に設定する必要があります`True`キャッシュを有効にします。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-238">[EnableCaching](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.enablecaching.aspx) must be set to `True` to enable caching.</span></span> <span data-ttu-id="7a1ef-239">既定値は `False` です。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-239">The default is `False`.</span></span>
- <span data-ttu-id="7a1ef-240">[CacheDuration](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheduration.aspx)時間 (秒)、データがキャッシュされている量。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-240">[CacheDuration](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheduration.aspx) the amount of time, in seconds, that the data is cached.</span></span> <span data-ttu-id="7a1ef-241">既定値は 0 です。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-241">The default is 0.</span></span> <span data-ttu-id="7a1ef-242">場合は、ObjectDataSource にデータはキャッシュのみ`EnableCaching`は`True`と`CacheDuration`0 より大きい値に設定されます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-242">The ObjectDataSource will only cache data if `EnableCaching` is `True` and `CacheDuration` is set to a value greater than zero.</span></span>
- <span data-ttu-id="7a1ef-243">[CacheExpirationPolicy](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheexpirationpolicy.aspx)に設定することができます`Absolute`または`Sliding`します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-243">[CacheExpirationPolicy](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheexpirationpolicy.aspx) can be set to `Absolute` or `Sliding`.</span></span> <span data-ttu-id="7a1ef-244">場合`Absolute`、ObjectDataSource が取得するデータをキャッシュ`CacheDuration`秒; 場合`Sliding`、データにアクセスされていない後でのみ有効期限が切れる`CacheDuration`秒。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-244">If `Absolute`, the ObjectDataSource caches its retrieved data for `CacheDuration` seconds; if `Sliding`, the data expires only after it has not been accessed for `CacheDuration` seconds.</span></span> <span data-ttu-id="7a1ef-245">既定値は `Absolute` です。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-245">The default is `Absolute`.</span></span>
- <span data-ttu-id="7a1ef-246">[CacheKeyDependency](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cachekeydependency.aspx)このプロパティを使用して、既存のキャッシュ依存関係と ObjectDataSource s のキャッシュ エントリを関連付けます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-246">[CacheKeyDependency](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cachekeydependency.aspx) use this property to associate the ObjectDataSource s cache entries with an existing cache dependency.</span></span> <span data-ttu-id="7a1ef-247">ObjectDataSource のデータ エントリ途中で削除できるキャッシュから期限切れに関連付けられた`CacheKeyDependency`します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-247">The ObjectDataSource s data entries can be prematurely evicted from the cache by expiring its associated `CacheKeyDependency`.</span></span> <span data-ttu-id="7a1ef-248">このプロパティは、SQL キャッシュ依存関係を関連付ける ObjectDataSource のキャッシュに最もよく使用は、トピックについて説明します、将来[を使用して SQL キャッシュ依存関係](using-sql-cache-dependencies-vb.md)チュートリアル。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-248">This property is most commonly used to associate a SQL cache dependency with the ObjectDataSource s cache, a topic we'll explore in the future [Using SQL Cache Dependencies](using-sql-cache-dependencies-vb.md) tutorial.</span></span>

<span data-ttu-id="7a1ef-249">S を構成できるように、 `ProductsDataSource` ObjectDataSource 絶対スケールで 30 秒間のデータをキャッシュします。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-249">Let s configure the `ProductsDataSource` ObjectDataSource to cache its data for 30 seconds on an absolute scale.</span></span> <span data-ttu-id="7a1ef-250">ObjectDataSource s 設定`EnableCaching`プロパティを`True`とその`CacheDuration`30 に設定するプロパティ。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-250">Set the ObjectDataSource s `EnableCaching` property to `True` and its `CacheDuration` property to 30.</span></span> <span data-ttu-id="7a1ef-251">ままに、`CacheExpirationPolicy`プロパティの既定の設定に`Absolute`します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-251">Leave the `CacheExpirationPolicy` property set to its default, `Absolute`.</span></span>


<span data-ttu-id="7a1ef-252">[![30 秒間のデータをキャッシュする ObjectDataSource を構成します。](caching-data-with-the-objectdatasource-vb/_static/image28.png)](caching-data-with-the-objectdatasource-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="7a1ef-252">[![Configure the ObjectDataSource to Cache its Data for 30 Seconds](caching-data-with-the-objectdatasource-vb/_static/image28.png)](caching-data-with-the-objectdatasource-vb/_static/image27.png)</span></span>

<span data-ttu-id="7a1ef-253">**図 11**: 30 秒間のデータをキャッシュする ObjectDataSource を構成する ([フルサイズの画像を表示する をクリックします](caching-data-with-the-objectdatasource-vb/_static/image29.png))。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-253">**Figure 11**: Configure the ObjectDataSource to Cache its Data for 30 Seconds ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image29.png))</span></span>


<span data-ttu-id="7a1ef-254">変更を保存し、ブラウザーでこのページを再検討します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-254">Save your changes and revisit this page in a browser.</span></span> <span data-ttu-id="7a1ef-255">選択すると発生するイベントのテキストは最初に、データがキャッシュ内のページに初めてアクセスするときにも表示されます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-255">The Selecting event fired text will appear when you first visit the page, as initially the data is not in the cache.</span></span> <span data-ttu-id="7a1ef-256">以降のポストバック トリガー並べ替え、ポストバックのボタンをクリックしてページング、または編集 または キャンセル ボタンをクリックすると、*いない*テキストを再表示するイベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-256">But subsequent postbacks triggered by clicking the Postback button, sorting, paging, or clicking the Edit or Cancel buttons does *not* redisplay the Selecting event fired text.</span></span> <span data-ttu-id="7a1ef-257">これは、ため、 `Selecting` 、ObjectDataSource がその基になるオブジェクトからのデータを取得するときにのみイベントが発生した、`Selecting`データ キャッシュからデータを取り込む場合、イベントは発生しません。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-257">This is because the `Selecting` event only fires when the ObjectDataSource gets its data from its underlying object; the `Selecting` event does not fire if the data is pulled from the data cache.</span></span>

<span data-ttu-id="7a1ef-258">30 秒後、データをキャッシュから削除されます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-258">After 30 seconds, the data will be evicted from the cache.</span></span> <span data-ttu-id="7a1ef-259">場合、データをキャッシュから削除もは ObjectDataSource s `Insert`、 `Update`、または`Delete`メソッドが呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-259">The data will also be evicted from the cache if the ObjectDataSource s `Insert`, `Update`, or `Delete` methods are invoked.</span></span> <span data-ttu-id="7a1ef-260">そのため、30 秒が経過または [更新] ボタンがクリックしてされた並べ替え、ページング、またはその基になるオブジェクトからのデータを取得する ObjectDataSource により、編集、または [キャンセル] ボタンをクリックすると後のテキストが発生するイベントを表示するときに、`Selecting`イベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-260">Consequently, after 30 seconds have passed or the Update button has been clicked, sorting, paging, or clicking the Edit or Cancel buttons will cause the ObjectDataSource to get its data from its underlying object, displaying the Selecting event fired text when the `Selecting` event fires.</span></span> <span data-ttu-id="7a1ef-261">返される結果は、データ キャッシュに配置されます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-261">These returned results are placed back into the data cache.</span></span>

> [!NOTE]
> <span data-ttu-id="7a1ef-262">頻繁に発生するイベントの文字列の選択を表示する場合、キャッシュされたデータで作業を ObjectDataSource が予想される場合もありますメモリ制約によって。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-262">If you see the Selecting event fired text frequently, even when you expect the ObjectDataSource to be working with cached data, it may be due to memory constraints.</span></span> <span data-ttu-id="7a1ef-263">十分な空きメモリがない場合、ObjectDataSource によってキャッシュに追加されたデータを清掃がある可能性があります。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-263">If there is not enough free memory, the data added to the cache by the ObjectDataSource may have been scavenged.</span></span> <span data-ttu-id="7a1ef-264">ObjectDataSource されないデータまたはキャッシュのみにキャッシュが正しく表示されない場合は、データは、断続的空きメモリの一部のアプリケーションを閉じるし、もう一度やり直してください。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-264">If the ObjectDataSource doesn t appear to be correctly caching the data or only caches the data sporadically, close some applications to free memory and try again.</span></span>


<span data-ttu-id="7a1ef-265">図 12 は、ワークフローをキャッシュする ObjectDataSource s を示しています。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-265">Figure 12 illustrates the ObjectDataSource s caching workflow.</span></span> <span data-ttu-id="7a1ef-266">イベントが発生したときに、画面にテキストが表示される、ため、データがキャッシュに存在していなかったし、基になるオブジェクトから取得する必要があります。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-266">When the Selecting event fired text appears on your screen, it is because the data was not in the cache and had to be retrieved from the underlying object.</span></span> <span data-ttu-id="7a1ef-267">このテキストは、不足しているときにただし、その s データがキャッシュから使用可能なためです。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-267">When this text is missing, however, it s because the data was available from the cache.</span></span> <span data-ttu-id="7a1ef-268">データがキャッシュから返される場合が s の基になるオブジェクトへの呼び出しと、そのため、データベース クエリではなく実行されません。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-268">When the data is returned from the cache there s no call to the underlying object and, therefore, no database query executed.</span></span>


![ObjectDataSource ストアとデータ キャッシュからそのデータを取得します](caching-data-with-the-objectdatasource-vb/_static/image30.png)

<span data-ttu-id="7a1ef-270">**図 12**: ObjectDataSource を格納し、データ キャッシュからのデータの取得</span><span class="sxs-lookup"><span data-stu-id="7a1ef-270">**Figure 12**: The ObjectDataSource Stores and Retrieves its Data from the Data Cache</span></span>


<span data-ttu-id="7a1ef-271">各 ASP.NET アプリケーションでは、すべてのページと訪問者の間で共有 s インスタンス、独自のデータ キャッシュがあります。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-271">Each ASP.NET application has its own data cache instance that s shared across all pages and visitors.</span></span> <span data-ttu-id="7a1ef-272">ObjectDataSource でデータ キャッシュに格納されたデータが同様に、ページにアクセスするすべてのユーザーの間で共有されることを意味します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-272">That means that the data stored in the data cache by the ObjectDataSource is likewise shared across all users who visit the page.</span></span> <span data-ttu-id="7a1ef-273">これを確認するには、開く、`ObjectDataSource.aspx`ブラウザーでページ。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-273">To verify this, open the `ObjectDataSource.aspx` page in a browser.</span></span> <span data-ttu-id="7a1ef-274">最初のページにアクセスして、(前のテストによって、キャッシュに追加されたデータが、ここまでで、削除された) すると仮定した場合に選択すると発生するイベントのテキストが表示されます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-274">When first visiting the page, the Selecting event fired text will appear (assuming that the data added to the cache by previous tests has, by now, been evicted).</span></span> <span data-ttu-id="7a1ef-275">2 番目のブラウザー インスタンスとコピーを開き、2 番目の最初のブラウザー インスタンスから URL を貼り付けます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-275">Open a second browser instance and copy and paste the URL from the first browser instance to the second.</span></span> <span data-ttu-id="7a1ef-276">2 番目のブラウザー インスタンスのため、選択すると発生するイベントのテキストは表示されませんを使用して、同じキャッシュ データを 1 つ目として。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-276">In the second browser instance, the Selecting event fired text is not shown because it s using the same cached data as the first.</span></span>

<span data-ttu-id="7a1ef-277">ObjectDataSource がキャッシュのキー値が含まれていますを使用して、取得したデータをキャッシュに挿入するとき:`CacheDuration`と`CacheExpirationPolicy`プロパティの値です指定されていると、ObjectDataSource で使用されている、基になるビジネス オブジェクトの型。使用して、 [ `TypeName`プロパティ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.typename.aspx)(`ProductsBLL`、この例では); の値、`SelectMethod`名前と値のパラメーターのプロパティ、`SelectParameters`コレクションとそのの値`StartRowIndex`と`MaximumRows`を実装するときに使用されるプロパティ、[カスタム ページング](../paging-and-sorting/paging-and-sorting-report-data-vb.md)します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-277">When inserting its retrieved data into the cache, the ObjectDataSource uses a cache key value that includes: the `CacheDuration` and `CacheExpirationPolicy` property values; the type of the underlying business object being used by the ObjectDataSource, which is specified via the [`TypeName` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.typename.aspx) (`ProductsBLL`, in this example); the value of the `SelectMethod` property and the name and values of the parameters in the `SelectParameters` collection; and the values of its `StartRowIndex` and `MaximumRows` properties, which are used when implementing [custom paging](../paging-and-sorting/paging-and-sorting-report-data-vb.md).</span></span>

<span data-ttu-id="7a1ef-278">これらの値を変更、一意のキャッシュ エントリをにより、これらのプロパティの組み合わせとして、キャッシュ キーの値を作成します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-278">Crafting the cache key value as a combination of these properties ensures a unique cache entry as these values change.</span></span> <span data-ttu-id="7a1ef-279">たとえば、過去のチュートリアルで ve を使用して参照される、`ProductsBLL`クラスの`GetProductsByCategoryID(categoryID)`、指定したカテゴリのすべての製品が返されます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-279">For example, in past tutorials we ve looked at using the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)`, which returns all products for a specified category.</span></span> <span data-ttu-id="7a1ef-280">1 人のユーザーが、ページおよび表示の飲み物を付属可能性がありますが、 `CategoryID` 1。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-280">One user might come to the page and view beverages, which has a `CategoryID` of 1.</span></span> <span data-ttu-id="7a1ef-281">ObjectDataSource に関わりなく、その結果がキャッシュされている場合、`SelectParameters`値、別のユーザーがこのページにキャッシュ内にあった調味料飲み物の製品の中に表示すると、調味料ではなく、キャッシュされた飲料、d を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-281">If the ObjectDataSource cached its results without regard for the `SelectParameters` values, when another user came to the page to view condiments while the beverages products were in the cache, they d see the cached beverage products rather than condiments.</span></span> <span data-ttu-id="7a1ef-282">値を含むがこれらのプロパティによって、キャッシュ キーを変更することで、 `SelectParameters`ObjectDataSource が beverages と調味料の個別のキャッシュ エントリを保持します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-282">By varying the cache key by these properties, which include the values of the `SelectParameters`, the ObjectDataSource maintains a separate cache entry for beverages and condiments.</span></span>

## <a name="stale-data-concerns"></a><span data-ttu-id="7a1ef-283">古いデータの問題</span><span class="sxs-lookup"><span data-stu-id="7a1ef-283">Stale Data Concerns</span></span>

<span data-ttu-id="7a1ef-284">ObjectDataSource がいずれかの場合のキャッシュからその項目を自動的に削除の`Insert`、 `Update`、または`Delete`メソッドが呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-284">The ObjectDataSource automatically evicts its items from the cache when any one of its `Insert`, `Update`, or `Delete` methods is invoked.</span></span> <span data-ttu-id="7a1ef-285">これにより、ページで、データが変更されたときに、キャッシュ エントリをクリアする古いデータから保護します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-285">This helps protect against stale data by clearing out the cache entries when the data is modified through the page.</span></span> <span data-ttu-id="7a1ef-286">ただし、キャッシュを使用した古いデータが表示されたまま、ObjectDataSource 可能性は。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-286">However, it is possible for an ObjectDataSource using caching to still display stale data.</span></span> <span data-ttu-id="7a1ef-287">最も簡単な場合は、により、データは、データベース内で直接変更できます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-287">In the simplest case, it can be due to the data changing directly within the database.</span></span> <span data-ttu-id="7a1ef-288">おそらく、データベース管理者は、データベース内のレコードの一部を変更するスクリプトを実行しました。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-288">Perhaps a database administrator just ran a script that modifies some of the records in the database.</span></span>

<span data-ttu-id="7a1ef-289">このシナリオはより複雑な方法で展開も可能性があります。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-289">This scenario could also unfold in a more subtle way.</span></span> <span data-ttu-id="7a1ef-290">ObjectDataSource は、そのデータ変更メソッドのいずれかが呼び出されると、キャッシュからその項目を削除、キャッシュされた項目が削除された、プロパティの値の ObjectDataSource s の特定の組み合わせ (`CacheDuration`、 `TypeName`、 `SelectMethod`、同様に続きます)。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-290">While the ObjectDataSource evicts its items from the cache when one of its data modification methods is called, the cached items removed are for the ObjectDataSource s particular combination of property values (`CacheDuration`, `TypeName`, `SelectMethod`, and so on).</span></span> <span data-ttu-id="7a1ef-291">使用して、異なる 2 つの ObjectDataSources があれば`SelectMethods`または`SelectParameters`が、まだ更新できます、同じデータを 1 つの ObjectDataSource 可能性があります行を更新し、独自のキャッシュ エントリが、対応する行の 2 つ目の ObjectDataSource が無効になります。提供されますが、キャッシュされたからです。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-291">If you have two ObjectDataSources that use different `SelectMethods` or `SelectParameters`, but still can update the same data, then one ObjectDataSource may update a row and invalidate its own cache entries, but the corresponding row for the second ObjectDataSource will still be served from the cached.</span></span> <span data-ttu-id="7a1ef-292">この機能が発生するページを作成することをお勧めします。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-292">I encourage you to create pages to exhibit this functionality.</span></span> <span data-ttu-id="7a1ef-293">ObjectDataSource のキャッシュを使用し、データを取得するように構成からのデータをプルする編集可能な GridView を表示するページを作成、`ProductsBLL`クラスの`GetProducts()`メソッド。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-293">Create a page that displays an editable GridView that pulls its data from an ObjectDataSource that uses caching and is configured to get data from the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="7a1ef-294">もう 1 つ追加編集可能な GridView コントロールと ObjectDataSource をこのページ (または、もう 1 つ) がこの 2 つ目の ObjectDataSource を使用して、それがある、`GetProductsByCategoryID(categoryID)`メソッド。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-294">Add another editable GridView and ObjectDataSource to this page (or another one), but for this second ObjectDataSource have it use the `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="7a1ef-295">2 つの ObjectDataSources 以降`SelectMethod`プロパティが異なる場合、これら各 ll 独自のキャッシュされた値があります。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-295">Since the two ObjectDataSources `SelectMethod` properties differ, they ll each have their own cached values.</span></span> <span data-ttu-id="7a1ef-296">次回 (ページング、並べ替え、およびなど) を他のグリッドにデータをバインドする 1 つのグリッド内の製品を編集する場合も、キャッシュされた古いデータが提供され、他のグリッドから加えられた変更は反映されません。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-296">If you edit a product in one grid, the next time you bind the data back to the other grid (by paging, sorting, and so forth), it will still serve the old, cached data and not reflect the change that was made from the other grid.</span></span>

<span data-ttu-id="7a1ef-297">つまり場合に、のみ使用切れの時間ベースの古いデータの可能性があるし、データの新しさが重要なシナリオの短い切れを使用してもよい。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-297">In short, only use time-based expiries if you are willing to have the potential of stale data, and use shorter expiries for scenarios where the freshness of data is important.</span></span> <span data-ttu-id="7a1ef-298">古いデータが許容されない場合はキャッシュを断念または SQL キャッシュ依存関係を使用して、いずれか (これはデータベースのデータと仮定すると再キャッシュする)。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-298">If stale data is not acceptable, either forgo caching or use SQL cache dependencies (assuming it is database data you re caching).</span></span> <span data-ttu-id="7a1ef-299">今後のチュートリアルでは SQL キャッシュ依存関係について説明します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-299">We'll explore SQL cache dependencies in a future tutorial.</span></span>

## <a name="summary"></a><span data-ttu-id="7a1ef-300">まとめ</span><span class="sxs-lookup"><span data-stu-id="7a1ef-300">Summary</span></span>

<span data-ttu-id="7a1ef-301">このチュートリアルでは、ObjectDataSource s 組み込みキャッシュ機能を確認します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-301">In this tutorial we examined the ObjectDataSource s built-in caching capabilities.</span></span> <span data-ttu-id="7a1ef-302">いくつかのプロパティを設定するだけでは、指定された対象から返される結果をキャッシュする ObjectDataSource を指示できます`SelectMethod`ASP.NET のデータ キャッシュにします。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-302">By simply setting a few properties, we can instruct the ObjectDataSource to cache the results returned from the specified `SelectMethod` into the ASP.NET data cache.</span></span> <span data-ttu-id="7a1ef-303">`CacheDuration`と`CacheExpirationPolicy`プロパティは、項目がキャッシュされる期間とは、絶対またはスライディング有効期限を示します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-303">The `CacheDuration` and `CacheExpirationPolicy` properties indicate the duration the item is cached and whether it is an absolute or sliding expiration.</span></span> <span data-ttu-id="7a1ef-304">`CacheKeyDependency`プロパティが既存のキャッシュ依存関係を ObjectDataSource s のキャッシュ エントリのすべてを関連付けます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-304">The `CacheKeyDependency` property associates all of the ObjectDataSource s cache entries with an existing cache dependency.</span></span> <span data-ttu-id="7a1ef-305">時間ベースの有効期限に達するし、SQL キャッシュ依存関係は通常使用する前に、キャッシュから ObjectDataSource s のエントリを削除するために使用できます。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-305">This can be used to evict the ObjectDataSource s entries from the cache before the time-based expiration is reached, and is typically used with SQL cache dependencies.</span></span>

<span data-ttu-id="7a1ef-306">データ キャッシュには、その値は、単に、ObjectDataSource にキャッシュからプログラムで ObjectDataSource の組み込み機能を複製します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-306">Since the ObjectDataSource simply caches its values to the data cache, we could replicate the ObjectDataSource s built-in functionality programmatically.</span></span> <span data-ttu-id="7a1ef-307">これは、ObjectDataSource は、既定では、この機能を提供していますが、アーキテクチャの別のレイヤーにキャッシュ機能を実装できるため、プレゼンテーション層でこれには t が合理的です。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-307">It doesn t make sense to do this at the Presentation Layer, since the ObjectDataSource offers this functionality out of the box, but we can implement caching capabilities in a separate layer of the architecture.</span></span> <span data-ttu-id="7a1ef-308">これを行うには、ObjectDataSource で使用される同じロジックを繰り返す必要があります。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-308">To do so, we'll need to repeat the same logic used by the ObjectDataSource.</span></span> <span data-ttu-id="7a1ef-309">[次へ]、チュートリアルでは、アーキテクチャ内からのデータ キャッシュをプログラムで操作する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-309">We'll explore how to programmatically work with the data cache from within the architecture in our next tutorial.</span></span>

<span data-ttu-id="7a1ef-310">満足のプログラミングです。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-310">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="7a1ef-311">関連項目</span><span class="sxs-lookup"><span data-stu-id="7a1ef-311">Further Reading</span></span>

<span data-ttu-id="7a1ef-312">このチュートリアルで説明したトピックの詳細については、次の情報を参照してください。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-312">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="7a1ef-313">ASP.NET のキャッシュ: テクニックとベスト プラクティス</span><span class="sxs-lookup"><span data-stu-id="7a1ef-313">ASP.NET Caching: Techniques and Best Practices</span></span>](https://msdn.microsoft.com/library/aa478965.aspx)
- [<span data-ttu-id="7a1ef-314">.NET Framework アプリケーション用のキャッシュのアーキテクチャ ガイド</span><span class="sxs-lookup"><span data-stu-id="7a1ef-314">Caching Architecture Guide for .NET Framework Applications</span></span>](https://msdn.microsoft.com/library/ee817645.aspx)
- [<span data-ttu-id="7a1ef-315">ASP.NET 2.0 で出力キャッシュ</span><span class="sxs-lookup"><span data-stu-id="7a1ef-315">Output Caching in ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx)

## <a name="about-the-author"></a><span data-ttu-id="7a1ef-316">執筆者紹介</span><span class="sxs-lookup"><span data-stu-id="7a1ef-316">About the Author</span></span>

<span data-ttu-id="7a1ef-317">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)、7 つ受け取りますブックおよびの創設者の著者[4GuysFromRolla.com](http://www.4guysfromrolla.com)、Microsoft Web テクノロジと 1998 年から携わっています。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-317">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="7a1ef-318">Scott は、フリーのコンサルタント、トレーナー、およびライターとして動作します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-318">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="7a1ef-319">最新の著書は[ *Sams 教える自分で ASP.NET 2.0 24 時間以内に*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-319">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="7a1ef-320">彼に到達できる[mitchell@4GuysFromRolla.comします。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="7a1ef-320">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="7a1ef-321">彼のブログにあるでまたは[ http://ScottOnWriting.NET](http://ScottOnWriting.NET)します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-321">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="7a1ef-322">特別なに感謝します。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-322">Special Thanks To</span></span>

<span data-ttu-id="7a1ef-323">このチュートリアル シリーズは、多くの便利なレビュー担当者によってレビューされました。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-323">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="7a1ef-324">このチュートリアルでは、潜在顧客レビュー担当者は、Teresa Murphy でした。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-324">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="7a1ef-325">今後、MSDN の記事を確認したいですか。</span><span class="sxs-lookup"><span data-stu-id="7a1ef-325">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="7a1ef-326">場合は、筆者に[mitchell@4GuysFromRolla.comします。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="7a1ef-326">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="7a1ef-327">[前へ](using-sql-cache-dependencies-cs.md)
> [次へ](caching-data-in-the-architecture-vb.md)</span><span class="sxs-lookup"><span data-stu-id="7a1ef-327">[Previous](using-sql-cache-dependencies-cs.md)
[Next](caching-data-in-the-architecture-vb.md)</span></span>
