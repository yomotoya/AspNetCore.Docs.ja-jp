---
uid: web-forms/overview/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-vb
title: GridView のフッター (VB) から新しいレコードの挿入 |Microsoft Docs
author: rick-anderson
description: このチュートリアルが含める GridView を拡張する方法では、GridView コントロールには、データの新しいレコードを挿入するための組み込みのサポートされていません、中に、.
ms.author: aspnetcontent
ms.date: 03/06/2007
ms.assetid: 528acc48-f20c-4b4e-aa16-4cc02f068ebb
msc.legacyurl: /web-forms/overview/data-access/enhancing-the-gridview/inserting-a-new-record-from-the-gridview-s-footer-vb
msc.type: authoredcontent
ms.openlocfilehash: 69aa6659a6c18ed6d16e2916f0f9088ef38a453f
ms.sourcegitcommit: b28cd0313af316c051c2ff8549865bff67f2fbb4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/05/2018
ms.locfileid: "37828320"
---
<a name="inserting-a-new-record-from-the-gridviews-footer-vb"></a><span data-ttu-id="1d21b-103">GridView のフッター (VB) から新しいレコードを挿入します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-103">Inserting a New Record from the GridView's Footer (VB)</span></span>
====================
<span data-ttu-id="1d21b-104">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="1d21b-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="1d21b-105">[サンプル アプリをダウンロード](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_53_VB.exe)または[PDF のダウンロード](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/datatutorial53vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="1d21b-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_53_VB.exe) or [Download PDF](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/datatutorial53vb1.pdf)</span></span>

> <span data-ttu-id="1d21b-106">GridView コントロールには、データの新しいレコードを挿入するための組み込みのサポートされていません、このチュートリアルでは、挿入のインターフェイスを含める GridView を拡張する方法が表示されます。</span><span class="sxs-lookup"><span data-stu-id="1d21b-106">While the GridView control does not provide built-in support for inserting a new record of data, this tutorial shows how to augment the GridView to include an inserting interface.</span></span>


## <a name="introduction"></a><span data-ttu-id="1d21b-107">はじめに</span><span class="sxs-lookup"><span data-stu-id="1d21b-107">Introduction</span></span>

<span data-ttu-id="1d21b-108">説明したように、[挿入の概要、更新、およびデータの削除](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md)チュートリアルでは、GridView、DetailsView、FormView Web の各のコントロールには、組み込みのデータ変更機能が含まれます。</span><span class="sxs-lookup"><span data-stu-id="1d21b-108">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, the GridView, DetailsView, and FormView Web controls each include built-in data modification capabilities.</span></span> <span data-ttu-id="1d21b-109">宣言型のデータ ソース コントロールを併用すると、これら 3 つの Web コントロールできます迅速かつ簡単にするように構成データの変更とでは 1 行のコードを記述する必要はありません。</span><span class="sxs-lookup"><span data-stu-id="1d21b-109">When used with declarative data source controls, these three Web controls can be quickly and easily configured to modify data - and in scenarios without needing to write a single line of code.</span></span> <span data-ttu-id="1d21b-110">残念ながら、のみ、DetailsView コントロールと FormView コントロールは、組み込みの挿入、編集、および削除機能を提供します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-110">Unfortunately, only the DetailsView and FormView controls provide built-in inserting, editing, and deleting capabilities.</span></span> <span data-ttu-id="1d21b-111">GridView には、編集および削除のサポートのみ提供しています。</span><span class="sxs-lookup"><span data-stu-id="1d21b-111">The GridView only offers editing and deleting support.</span></span> <span data-ttu-id="1d21b-112">ただし、少しの屈曲グリースはことができますの強化点、GridView を挿入するインターフェイスを含めます。</span><span class="sxs-lookup"><span data-stu-id="1d21b-112">However, with a little elbow grease, we can augment the GridView to include an inserting interface.</span></span>

<span data-ttu-id="1d21b-113">挿入機能を GridView に追加するで新しいレコードが追加されますを決定する、挿入のインターフェイスを作成して、新しいレコードを挿入するコードを記述を担当います。</span><span class="sxs-lookup"><span data-stu-id="1d21b-113">In adding inserting capabilities to the GridView, we are responsible for deciding on how new records will be added, creating the inserting interface, and writing the code to insert the new record.</span></span> <span data-ttu-id="1d21b-114">挿入のインターフェイスを GridView のフッターに追加することに注目するはこのチュートリアルでは行が (図 1 参照)。</span><span class="sxs-lookup"><span data-stu-id="1d21b-114">In this tutorial we will look at adding the inserting interface to the GridView s footer row (see Figure 1).</span></span> <span data-ttu-id="1d21b-115">各列のフッター セルには、適切なデータ コレクションのユーザー インターフェイス要素 (s の製品名 ボックスと供給業者、DropDownList) が含まれています。</span><span class="sxs-lookup"><span data-stu-id="1d21b-115">The footer cell for each column includes the appropriate data collection user interface element (a TextBox for the product s name, a DropDownList for the supplier, and so on).</span></span> <span data-ttu-id="1d21b-116">列も必要があります、追加のボタンで、クリックされたときのポストバックを発生させるしに新しいレコードを挿入、`Products`テーブル フッター行に指定された値を使用します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-116">We also need a column for an Add button that, when clicked, will cause a postback and insert a new record into the `Products` table using the values supplied in the footer row.</span></span>


<span data-ttu-id="1d21b-117">[![フッター行が新しい製品を追加するためのインターフェイスを提供します。](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="1d21b-117">[![The Footer Row Provides an Interface for Adding New Products](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image1.png)</span></span>

<span data-ttu-id="1d21b-118">**図 1**: フッター行は、新製品の追加のインターフェイスを提供します ([フルサイズの画像を表示する をクリックします](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.png))。</span><span class="sxs-lookup"><span data-stu-id="1d21b-118">**Figure 1**: The Footer Row Provides an Interface for Adding New Products ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.png))</span></span>


## <a name="step-1-displaying-product-information-in-a-gridview"></a><span data-ttu-id="1d21b-119">手順 1: GridView の製品情報を表示します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-119">Step 1: Displaying Product Information in a GridView</span></span>

<span data-ttu-id="1d21b-120">GridView のフッターに挿入するインターフェイスを作成すると自分たちに関係、前に、データベースでは、製品を一覧表示されたページに GridView を追加する最初のフォーカスを s を使用できます。</span><span class="sxs-lookup"><span data-stu-id="1d21b-120">Before we concern ourselves with creating the inserting interface in the GridView s footer, let s first focus on adding a GridView to the page that lists the products in the database.</span></span> <span data-ttu-id="1d21b-121">開いて開始、`InsertThroughFooter.aspx`ページで、`EnhancedGridView`フォルダーと、デザイナーの GridView s を設定するのには、ツールボックスからドラッグ GridView`ID`プロパティを`Products`します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-121">Start by opening the `InsertThroughFooter.aspx` page in the `EnhancedGridView` folder and drag a GridView from the Toolbox onto the Designer, setting the GridView s `ID` property to `Products`.</span></span> <span data-ttu-id="1d21b-122">次に、GridView s のスマート タグをという名前の新しい ObjectDataSource にバインドを使用して`ProductsDataSource`します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-122">Next, use the GridView s smart tag to bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span>


<span data-ttu-id="1d21b-123">[![ProductsDataSource という名前の新しい ObjectDataSource を作成します。](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="1d21b-123">[![Create a New ObjectDataSource Named ProductsDataSource](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image2.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.png)</span></span>

<span data-ttu-id="1d21b-124">**図 2**: 名前付き新しい ObjectDataSource 作成`ProductsDataSource`([フルサイズの画像を表示する をクリックします](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.png))。</span><span class="sxs-lookup"><span data-stu-id="1d21b-124">**Figure 2**: Create a New ObjectDataSource Named `ProductsDataSource` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.png))</span></span>


<span data-ttu-id="1d21b-125">構成を使用する ObjectDataSource、`ProductsBLL`クラスの`GetProducts()`製品情報を取得します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-125">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method to retrieve product information.</span></span> <span data-ttu-id="1d21b-126">このチュートリアルでは、挿入機能を追加するのには厳密に注目できるようにし、編集および削除について心配ありません。</span><span class="sxs-lookup"><span data-stu-id="1d21b-126">For this tutorial, let s focus strictly on adding inserting capabilities and not worry about editing and deleting.</span></span> <span data-ttu-id="1d21b-127">そのため、[挿入] タブで、ドロップダウン リストに設定されていることを確認`AddProduct()`UPDATE および DELETE の各タブで、ドロップダウン リストが (なし) に設定されているとします。</span><span class="sxs-lookup"><span data-stu-id="1d21b-127">Therefore, make sure that the drop-down list in the INSERT tab is set to `AddProduct()` and that the drop-down lists in the UPDATE and DELETE tabs are set to (None) .</span></span>


<span data-ttu-id="1d21b-128">[![マップ ObjectDataSource s insert() AddProduct メソッド](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="1d21b-128">[![Map the AddProduct Method to the ObjectDataSource s Insert() Method](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image3.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.png)</span></span>

<span data-ttu-id="1d21b-129">**図 3**: マップ、 `AddProduct` ObjectDataSource s メソッド`Insert()`メソッド ([フルサイズの画像を表示する をクリックします](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.png))。</span><span class="sxs-lookup"><span data-stu-id="1d21b-129">**Figure 3**: Map the `AddProduct` Method to the ObjectDataSource s `Insert()` Method ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.png))</span></span>


<span data-ttu-id="1d21b-130">[![(なし) を更新および削除のタブのドロップダウン リストを設定します。](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="1d21b-130">[![Set the UPDATE and DELETE Tabs Drop-Down Lists to (None)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image4.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.png)</span></span>

<span data-ttu-id="1d21b-131">**図 4**: (None) に、更新プログラムとタブ ドロップダウン リストの削除を設定 ([フルサイズの画像を表示する をクリックします](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.png))。</span><span class="sxs-lookup"><span data-stu-id="1d21b-131">**Figure 4**: Set the UPDATE and DELETE Tabs Drop-Down Lists to (None) ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.png))</span></span>


<span data-ttu-id="1d21b-132">ObjectDataSource s のデータ ソース構成ウィザードを完了するは、対応するデータ フィールドの各 GridView にフィールドを Visual Studio が自動的に追加されます。</span><span class="sxs-lookup"><span data-stu-id="1d21b-132">After completing the ObjectDataSource s Configure Data Source wizard, Visual Studio will automatically add fields to the GridView for each of the corresponding data fields.</span></span> <span data-ttu-id="1d21b-133">ここでは、すべての Visual Studio によって追加されたフィールドのままにします。</span><span class="sxs-lookup"><span data-stu-id="1d21b-133">For now, leave all of the fields added by Visual Studio.</span></span> <span data-ttu-id="1d21b-134">戻ってが削除され、このチュートリアルの後半では、新しいレコードを追加するときに指定するいくつかのフィールドの値がない必要があります。</span><span class="sxs-lookup"><span data-stu-id="1d21b-134">Later in this tutorial we'll come back and remove some of the fields whose values don t need to be specified when adding a new record.</span></span>

<span data-ttu-id="1d21b-135">データベースに 80 の製品の近くにある、ので、ユーザーが新しいレコードを追加するには、web ページの下部までスクロールする必要があります。</span><span class="sxs-lookup"><span data-stu-id="1d21b-135">Since there are close to 80 products in the database, a user will have to scroll all the way down to the bottom of the web page in order to add a new record.</span></span> <span data-ttu-id="1d21b-136">そのため、%s より見やすくて、アクセス可能な挿入インターフェイスにページングを有効にすることができます。</span><span class="sxs-lookup"><span data-stu-id="1d21b-136">Therefore, let s enable paging to make the inserting interface more visible and accessible.</span></span> <span data-ttu-id="1d21b-137">ページングを有効にするには、GridView s のスマート タグからページングを有効にするチェック ボックスをオンだけです。</span><span class="sxs-lookup"><span data-stu-id="1d21b-137">To turn on paging, simply check the Enable Paging checkbox from the GridView s smart tag.</span></span>

<span data-ttu-id="1d21b-138">この時点では、GridView コントロールと ObjectDataSource s の宣言型マークアップは、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="1d21b-138">At this point, the GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample1.aspx)]


<span data-ttu-id="1d21b-139">[![製品のすべてのデータ フィールドはページングされた GridView に表示されます。](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="1d21b-139">[![All Product Data Fields are Displayed in a Paged GridView](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image5.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.png)</span></span>

<span data-ttu-id="1d21b-140">**図 5**: ページングされた GridView で製品のすべてのデータ フィールドが表示されます ([フルサイズの画像を表示する をクリックします](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.png))。</span><span class="sxs-lookup"><span data-stu-id="1d21b-140">**Figure 5**: All Product Data Fields are Displayed in a Paged GridView ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.png))</span></span>


## <a name="step-2-adding-a-footer-row"></a><span data-ttu-id="1d21b-141">手順 2: フッター行を追加します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-141">Step 2: Adding a Footer Row</span></span>

<span data-ttu-id="1d21b-142">およびそのヘッダーとデータ行は、GridView には、フッター行が含まれています。</span><span class="sxs-lookup"><span data-stu-id="1d21b-142">Along with its header and data rows, the GridView includes a footer row.</span></span> <span data-ttu-id="1d21b-143">GridView の秒の値に応じて、ヘッダーとフッター行の表示[ `ShowHeader` ](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showheader.aspx)と[ `ShowFooter` ](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showfooter.aspx)プロパティ。</span><span class="sxs-lookup"><span data-stu-id="1d21b-143">The header and footer rows are displayed depending on the values of the GridView s [`ShowHeader`](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showheader.aspx) and [`ShowFooter`](https://msdn.microsoft.com/en-gb/library/system.web.ui.webcontrols.gridview.showfooter.aspx) properties.</span></span> <span data-ttu-id="1d21b-144">フッター行を表示する設定、`ShowFooter`プロパティを`True`します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-144">To show the footer row, simply set the `ShowFooter` property to `True`.</span></span> <span data-ttu-id="1d21b-145">図 6 に示すように、設定、`ShowFooter`プロパティを`True`フッター行をグリッドに追加します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-145">As Figure 6 illustrates, setting the `ShowFooter` property to `True` adds a footer row to the grid.</span></span>


<span data-ttu-id="1d21b-146">[![フッター行を表示するには、True に ShowFooter を設定します。](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="1d21b-146">[![To Display the Footer Row, Set ShowFooter to True](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image6.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.png)</span></span>

<span data-ttu-id="1d21b-147">**図 6**: 表示する、フッター行設定`ShowFooter`に`True`([フルサイズの画像を表示する をクリックします](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.png))。</span><span class="sxs-lookup"><span data-stu-id="1d21b-147">**Figure 6**: To Display the Footer Row, Set `ShowFooter` to `True` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.png))</span></span>


<span data-ttu-id="1d21b-148">フッター行が濃い赤の背景色を持つことに注意してください。</span><span class="sxs-lookup"><span data-stu-id="1d21b-148">Note that the footer row has a dark red background color.</span></span> <span data-ttu-id="1d21b-149">これは DataWebControls テーマを作成し、すべてのページに適用されるために戻り、 [、ObjectDataSource でデータを表示する](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md)チュートリアル。</span><span class="sxs-lookup"><span data-stu-id="1d21b-149">This is due to the DataWebControls Theme we created and applied to all pages back in the [Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-vb.md) tutorial.</span></span> <span data-ttu-id="1d21b-150">具体的には、`GridView.skin`ファイルの構成、`FooterStyle`プロパティなどが使用されて、 `FooterStyle` CSS クラス。</span><span class="sxs-lookup"><span data-stu-id="1d21b-150">Specifically, the `GridView.skin` file configures the `FooterStyle` property such that is uses the `FooterStyle` CSS class.</span></span> <span data-ttu-id="1d21b-151">`FooterStyle`でクラスが定義されている`Styles.css`次のようにします。</span><span class="sxs-lookup"><span data-stu-id="1d21b-151">The `FooterStyle` class is defined in `Styles.css` as follows:</span></span>


[!code-css[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample2.css)]

> [!NOTE]
> <span data-ttu-id="1d21b-152">私たち GridView のフッター行を使用して、前のチュートリアルで説明します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-152">We ve explored using the GridView s footer row in previous tutorials.</span></span> <span data-ttu-id="1d21b-153">必要な場合に戻って、 [GridView のフッターに概要情報を表示する](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md)リフレッシャーのチュートリアル。</span><span class="sxs-lookup"><span data-stu-id="1d21b-153">If needed, refer back to the [Displaying Summary Information in the GridView's Footer](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) tutorial for a refresher.</span></span>


<span data-ttu-id="1d21b-154">設定した後、`ShowFooter`プロパティを`True`、時間、ブラウザーで、出力を表示するのにはかかりません。</span><span class="sxs-lookup"><span data-stu-id="1d21b-154">After setting the `ShowFooter` property to `True`, take a moment to view the output in a browser.</span></span> <span data-ttu-id="1d21b-155">現在、フッター行は t には、任意のテキストまたは Web コントロールが含まれます。</span><span class="sxs-lookup"><span data-stu-id="1d21b-155">Currently the footer row doesn t contain any text or Web controls.</span></span> <span data-ttu-id="1d21b-156">手順 3. では、GridView の各フィールドのフッターを変更して、適切な挿入インターフェイスが含まれるようにします。</span><span class="sxs-lookup"><span data-stu-id="1d21b-156">In Step 3 we'll modify the footer for each GridView field so that it includes the appropriate inserting interface.</span></span>


<span data-ttu-id="1d21b-157">[![空のフッター行は表示上、ページング インターフェイス コントロールです。](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="1d21b-157">[![The Empty Footer Row is Displayed Above the Paging Interface Controls](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image7.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image13.png)</span></span>

<span data-ttu-id="1d21b-158">**図 7**:、空のフッター行は表示上、ページング インターフェイス コントロール ([フルサイズの画像を表示する をクリックします](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image14.png))。</span><span class="sxs-lookup"><span data-stu-id="1d21b-158">**Figure 7**: The Empty Footer Row is Displayed Above the Paging Interface Controls ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image14.png))</span></span>


## <a name="step-3-customizing-the-footer-row"></a><span data-ttu-id="1d21b-159">手順 3: フッター行をカスタマイズします。</span><span class="sxs-lookup"><span data-stu-id="1d21b-159">Step 3: Customizing the Footer Row</span></span>

<span data-ttu-id="1d21b-160">戻り、 [GridView コントロールで TemplateFields を使用して](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md)チュートリアル BoundFields または CheckBoxFields) はなく TemplateFields を使用する特定の GridView 列の表示を大幅にカスタマイズする方法を説明しましたで[。データ変更インターフェイスをカスタマイズ](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md)GridView で編集インターフェイスをカスタマイズ TemplateFields を使用しました。</span><span class="sxs-lookup"><span data-stu-id="1d21b-160">Back in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-vb.md) tutorial we saw how to greatly customize the display of a particular GridView column using TemplateFields (as opposed to BoundFields or CheckBoxFields); in [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) we looked at using TemplateFields to customize the editing interface in a GridView.</span></span> <span data-ttu-id="1d21b-161">TemplateField、マークアップ、Web コントロール、およびデータ バインディング構文の組み合わせを定義するテンプレートの数で構成が再現率は、特定の行の種類に使用します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-161">Recall that a TemplateField is composed of a number of templates that defines the mix of markup, Web controls, and databinding syntax used for certain types of rows.</span></span> <span data-ttu-id="1d21b-162">`ItemTemplate`、たとえば、読み取り専用の行で使用するテンプレートを指定します中に、`EditItemTemplate`テンプレート編集可能な行を定義します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-162">The `ItemTemplate`, for example, specifies the template used for read-only rows, while the `EditItemTemplate` defines the template for the editable row.</span></span>

<span data-ttu-id="1d21b-163">と共に、`ItemTemplate`と`EditItemTemplate`、TemplateField にも含まれています、`FooterTemplate`フッター行のコンテンツを指定します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-163">Along with the `ItemTemplate` and `EditItemTemplate`, the TemplateField also includes a `FooterTemplate` that specifies the content for the footer row.</span></span> <span data-ttu-id="1d21b-164">そのためにインターフェイスを挿入する各フィールドのために必要な Web コントロールを付け加えて、`FooterTemplate`します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-164">Therefore, we can add the Web controls needed for each field s inserting interface into the `FooterTemplate`.</span></span> <span data-ttu-id="1d21b-165">開始するには、TemplateFields を GridView のフィールドのすべてを変換します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-165">To start, convert all of the fields in the GridView to TemplateFields.</span></span> <span data-ttu-id="1d21b-166">これ行う GridView s スマート タグに、左下隅で各フィールドを選択し、このフィールドに変換を TemplateField リンクをクリックすると、列の編集リンクをクリックします。</span><span class="sxs-lookup"><span data-stu-id="1d21b-166">This can be done by clicking the Edit Columns link in the GridView s smart tag, selecting each field in the lower left corner, and clicking the Convert this field into a TemplateField link.</span></span>


![各フィールドを TemplateField に変換します。](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image8.gif)

<span data-ttu-id="1d21b-168">**図 8**: 各フィールドを TemplateField に変換します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-168">**Figure 8**: Convert Each Field Into a TemplateField</span></span>


<span data-ttu-id="1d21b-169">このフィールドを TemplateField に変換をクリックすると、同等の TemplateField に現在のフィールドの種類がオンにします。</span><span class="sxs-lookup"><span data-stu-id="1d21b-169">Clicking the Convert this field into a TemplateField turns the current field type into an equivalent TemplateField.</span></span> <span data-ttu-id="1d21b-170">TemplateField に各 BoundField は置き換えなど、`ItemTemplate`対応するデータ フィールドを表示するラベルを格納していると、 `EditItemTemplate`  ボックスに、データ フィールドを表示します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-170">For example, each BoundField is replaced by a TemplateField with an `ItemTemplate` that contains a Label that displays the corresponding data field and an `EditItemTemplate` that displays the data field in a TextBox.</span></span> <span data-ttu-id="1d21b-171">`ProductName` BoundField が次の TemplateField マークアップに変換されています。</span><span class="sxs-lookup"><span data-stu-id="1d21b-171">The `ProductName` BoundField has been converted into the following TemplateField markup:</span></span>


[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample3.aspx)]

<span data-ttu-id="1d21b-172">同様に、 `Discontinued` CheckBoxField に変換された TemplateField 持つ`ItemTemplate`と`EditItemTemplate`CheckBox Web コントロールを含む (で、 `ItemTemplate` s 無効になっているチェック ボックスをオン)。</span><span class="sxs-lookup"><span data-stu-id="1d21b-172">Likewise, the `Discontinued` CheckBoxField has been converted into a TemplateField whose `ItemTemplate` and `EditItemTemplate` contain a CheckBox Web control (with the `ItemTemplate` s CheckBox disabled).</span></span> <span data-ttu-id="1d21b-173">読み取り専用`ProductID`BoundField が両方のラベル コントロールを TemplateField に変換された、`ItemTemplate`と`EditItemTemplate`します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-173">The read-only `ProductID` BoundField has been converted into a TemplateField with a Label control in both the `ItemTemplate` and `EditItemTemplate`.</span></span> <span data-ttu-id="1d21b-174">フィールドを TemplateField は、既存のフィールドの機能を失うことがなくカスタマイズをより TemplateField に切り替えるに迅速かつ簡単な方法を簡単に言えばは既存の GridView に変換します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-174">In short, converting an existing GridView field into a TemplateField is a quick and easy way to switch to the more customizable TemplateField without losing any of the existing field s functionality.</span></span>

<span data-ttu-id="1d21b-175">以降、GridView 操作は t サポート編集して自由に削除、`EditItemTemplate`だけ残して、各 TemplateField から、`ItemTemplate`します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-175">Since the GridView we re working with doesn t support editing, feel free to remove the `EditItemTemplate` from each TemplateField, leaving just the `ItemTemplate`.</span></span> <span data-ttu-id="1d21b-176">これを行う、次のように GridView s の宣言型マークアップになります。</span><span class="sxs-lookup"><span data-stu-id="1d21b-176">After doing this, your GridView s declarative markup should look like the following:</span></span>


[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample4.aspx)]

<span data-ttu-id="1d21b-177">GridView の各フィールドを TemplateField に変換すると、これで、適切な挿入インターフェイスには、各フィールドの入力できます`FooterTemplate`します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-177">Now that each GridView field has been converted into a TemplateField, we can enter the appropriate inserting interface into each field s `FooterTemplate`.</span></span> <span data-ttu-id="1d21b-178">一部のフィールドは挿入のインターフェイスを持ちません (`ProductID`、たとえば)。 他のユーザーは新しい製品の情報を収集するために使用する Web コントロールで異なります。</span><span class="sxs-lookup"><span data-stu-id="1d21b-178">Some of the fields will not have an inserting interface (`ProductID`, for instance); others will vary in the Web controls used to collect the new product s information.</span></span>

<span data-ttu-id="1d21b-179">編集インターフェイスを作成するには、GridView s のスマート タグからテンプレートの編集リンクを選択します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-179">To create the editing interface, choose the Edit Templates link from the GridView s smart tag.</span></span> <span data-ttu-id="1d21b-180">次に、ドロップダウン リストから適切なフィールドの s を選択`FooterTemplate`し、適切なコントロールをツールボックスからデザイナーにドラッグします。</span><span class="sxs-lookup"><span data-stu-id="1d21b-180">Then, from the drop-down list, select the appropriate field s `FooterTemplate` and drag the appropriate control from the Toolbox onto the Designer.</span></span>


<span data-ttu-id="1d21b-181">[![各フィールドの後に、適切な挿入のインターフェイスを追加します。](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="1d21b-181">[![Add the Appropriate Inserting Interface to Each Field s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image9.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image15.png)</span></span>

<span data-ttu-id="1d21b-182">**図 9**: 各フィールドに適切な挿入のインターフェイスを追加`FooterTemplate`([フルサイズの画像を表示する をクリックします](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image16.png))。</span><span class="sxs-lookup"><span data-stu-id="1d21b-182">**Figure 9**: Add the Appropriate Inserting Interface to Each Field s `FooterTemplate` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image16.png))</span></span>


<span data-ttu-id="1d21b-183">次の箇条書きリストは、追加する挿入のインターフェイスを指定する、GridView フィールドを列挙します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-183">The following bulleted list enumerates the GridView fields, specifying the inserting interface to add:</span></span>

- <span data-ttu-id="1d21b-184">`ProductID` None です。</span><span class="sxs-lookup"><span data-stu-id="1d21b-184">`ProductID` none.</span></span>
- <span data-ttu-id="1d21b-185">`ProductName` テキスト ボックスを追加し、設定、`ID`に`NewProductName`します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-185">`ProductName` add a TextBox and set its `ID` to `NewProductName`.</span></span> <span data-ttu-id="1d21b-186">RequiredFieldValidator コントロールを追加すると、ユーザーが新しい製品の名前の値を入力することを確認します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-186">Add a RequiredFieldValidator control as well to ensure that the user enters a value for the new product s name.</span></span>
- <span data-ttu-id="1d21b-187">`SupplierID` None です。</span><span class="sxs-lookup"><span data-stu-id="1d21b-187">`SupplierID` none.</span></span>
- <span data-ttu-id="1d21b-188">`CategoryID` None です。</span><span class="sxs-lookup"><span data-stu-id="1d21b-188">`CategoryID` none.</span></span>
- <span data-ttu-id="1d21b-189">`QuantityPerUnit` 設定、テキスト ボックスを追加、`ID`に`NewQuantityPerUnit`します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-189">`QuantityPerUnit` add a TextBox, setting its `ID` to `NewQuantityPerUnit`.</span></span>
- <span data-ttu-id="1d21b-190">`UnitPrice` という名前のテキスト ボックスを追加`NewUnitPrice`入力された値に確実に CompareValidator は通貨の値より大きいまたは 0 に等しいとします。</span><span class="sxs-lookup"><span data-stu-id="1d21b-190">`UnitPrice` add a TextBox named `NewUnitPrice` and a CompareValidator that ensures the value entered is a currency value greater than or equal to zero.</span></span>
- <span data-ttu-id="1d21b-191">`UnitsInStock` テキスト ボックスを使用している`ID`に設定されている`NewUnitsInStock`します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-191">`UnitsInStock` use a TextBox whose `ID` is set to `NewUnitsInStock`.</span></span> <span data-ttu-id="1d21b-192">入力された値が 0 以上の整数値であることを確認する CompareValidator が含まれます。</span><span class="sxs-lookup"><span data-stu-id="1d21b-192">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="1d21b-193">`UnitsOnOrder` テキスト ボックスを使用している`ID`に設定されている`NewUnitsOnOrder`します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-193">`UnitsOnOrder` use a TextBox whose `ID` is set to `NewUnitsOnOrder`.</span></span> <span data-ttu-id="1d21b-194">入力された値が 0 以上の整数値であることを確認する CompareValidator が含まれます。</span><span class="sxs-lookup"><span data-stu-id="1d21b-194">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="1d21b-195">`ReorderLevel` テキスト ボックスを使用している`ID`に設定されている`NewReorderLevel`します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-195">`ReorderLevel` use a TextBox whose `ID` is set to `NewReorderLevel`.</span></span> <span data-ttu-id="1d21b-196">入力された値が 0 以上の整数値であることを確認する CompareValidator が含まれます。</span><span class="sxs-lookup"><span data-stu-id="1d21b-196">Include a CompareValidator that ensures that the value entered is an integer value greater than or equal to zero.</span></span>
- <span data-ttu-id="1d21b-197">`Discontinued` 設定のチェック ボックスを追加、`ID`に`NewDiscontinued`します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-197">`Discontinued` add a CheckBox, setting its `ID` to `NewDiscontinued`.</span></span>
- <span data-ttu-id="1d21b-198">`CategoryName` DropDownList を追加し、設定、`ID`に`NewCategoryID`します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-198">`CategoryName` add a DropDownList and set its `ID` to `NewCategoryID`.</span></span> <span data-ttu-id="1d21b-199">という名前の新しい ObjectDataSource にバインド`CategoriesDataSource`を使用するように構成し、`CategoriesBLL`クラスの`GetCategories()`メソッド。</span><span class="sxs-lookup"><span data-stu-id="1d21b-199">Bind it to a new ObjectDataSource named `CategoriesDataSource` and configure it to use the `CategoriesBLL` class s `GetCategories()` method.</span></span> <span data-ttu-id="1d21b-200">DropDownList s がある`ListItem`s の表示、`CategoryName`データ フィールドを使用して、`CategoryID`データ フィールドの値として。</span><span class="sxs-lookup"><span data-stu-id="1d21b-200">Have the DropDownList s `ListItem` s display the `CategoryName` data field, using the `CategoryID` data field as their values.</span></span>
- <span data-ttu-id="1d21b-201">`SupplierName` DropDownList を追加し、設定、`ID`に`NewSupplierID`します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-201">`SupplierName` add a DropDownList and set its `ID` to `NewSupplierID`.</span></span> <span data-ttu-id="1d21b-202">という名前の新しい ObjectDataSource にバインド`SuppliersDataSource`を使用するように構成し、`SuppliersBLL`クラスの`GetSuppliers()`メソッド。</span><span class="sxs-lookup"><span data-stu-id="1d21b-202">Bind it to a new ObjectDataSource named `SuppliersDataSource` and configure it to use the `SuppliersBLL` class s `GetSuppliers()` method.</span></span> <span data-ttu-id="1d21b-203">DropDownList s がある`ListItem`s の表示、`CompanyName`データ フィールドを使用して、`SupplierID`データ フィールドの値として。</span><span class="sxs-lookup"><span data-stu-id="1d21b-203">Have the DropDownList s `ListItem` s display the `CompanyName` data field, using the `SupplierID` data field as their values.</span></span>

<span data-ttu-id="1d21b-204">検証コントロールごとに、クリア、`ForeColor`プロパティように、 `FooterStyle` CSS クラス s 白い前景色の色を赤の既定の代わりに使用されます。</span><span class="sxs-lookup"><span data-stu-id="1d21b-204">For each of the validation controls, clear out the `ForeColor` property so that the `FooterStyle` CSS class s white foreground color will be used in place of the default red.</span></span> <span data-ttu-id="1d21b-205">使用しても、`ErrorMessage`の詳細については、プロパティが設定が、`Text`をアスタリスクのプロパティ。</span><span class="sxs-lookup"><span data-stu-id="1d21b-205">Also use the `ErrorMessage` property for a detailed description, but set the `Text` property to an asterisk.</span></span> <span data-ttu-id="1d21b-206">検証コントロールのテキストが原因で、挿入インターフェイスに 2 つの行に折り返すことを防ぐためには、設定、 `FooterStyle` s`Wrap`プロパティを false ごとに、`FooterTemplate`検証コントロールを使用します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-206">To prevent the validation control s text from causing the inserting interface to wrap to two lines, set the `FooterStyle` s `Wrap` property to false for each of the `FooterTemplate` s that use a validation control.</span></span> <span data-ttu-id="1d21b-207">最後に、GridView とセットの下にある ValidationSummary コントロールを追加、`ShowMessageBox`プロパティを`True`とその`ShowSummary`プロパティを`False`します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-207">Finally, add a ValidationSummary control beneath the GridView and set its `ShowMessageBox` property to `True` and its `ShowSummary` property to `False`.</span></span>

<span data-ttu-id="1d21b-208">新しい製品を追加するときに提供する必要があります、`CategoryID`と`SupplierID`します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-208">When adding a new product, we need to provide the `CategoryID` and `SupplierID`.</span></span> <span data-ttu-id="1d21b-209">フッターのセルの Dropdownlist でこの情報がキャプチャされた、`CategoryName`と`SupplierName`フィールド。</span><span class="sxs-lookup"><span data-stu-id="1d21b-209">This information is captured through the DropDownLists in the footer cells for the `CategoryName` and `SupplierName` fields.</span></span> <span data-ttu-id="1d21b-210">使用して、これらのフィールドではなく、`CategoryID`と`SupplierID`TemplateFields のためグリッドのデータ行も、ユーザーが可能性がありますより興味の ID 値ではなく、category と supplier の名前を表示します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-210">I chose to use these fields as opposed to the `CategoryID` and `SupplierID` TemplateFields because in the grid s data rows the user is likely more interested in seeing the category and supplier names rather than their ID values.</span></span> <span data-ttu-id="1d21b-211">`CategoryID`と`SupplierID`値でキャプチャされるようになりましたが、`CategoryName`と`SupplierName`フィールド s の挿入のインターフェイスを削除できる、`CategoryID`と`SupplierID`TemplateFields GridView から。</span><span class="sxs-lookup"><span data-stu-id="1d21b-211">Since the `CategoryID` and `SupplierID` values are now being captured in the `CategoryName` and `SupplierName` field s inserting interfaces, we can remove the `CategoryID` and `SupplierID` TemplateFields from the GridView.</span></span>

<span data-ttu-id="1d21b-212">同様に、`ProductID`新製品を追加するときに使用されませんので、 `ProductID` TemplateField をも削除することができます。</span><span class="sxs-lookup"><span data-stu-id="1d21b-212">Similarly, the `ProductID` is not used when adding a new product, so the `ProductID` TemplateField can be removed as well.</span></span> <span data-ttu-id="1d21b-213">ただし、秒のままにできるように、`ProductID`グリッドでフィールド。</span><span class="sxs-lookup"><span data-stu-id="1d21b-213">However, let s leave the `ProductID` field in the grid.</span></span> <span data-ttu-id="1d21b-214">テキスト ボックス、Dropdownlist、チェック ボックス、および挿入インターフェイスを構成する検証コントロール、に加えても必要があります、追加ボタンをクリックすると、データベースに新しい製品を追加するロジックを実行します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-214">In addition to the TextBoxes, DropDownLists, CheckBoxes, and validation controls that make up the inserting interface, we'll also need an Add button that, when clicked, performs the logic to add the new product to the database.</span></span> <span data-ttu-id="1d21b-215">手順 4. で挿入インターフェイスで、[追加] ボタンを含めます、 `ProductID` TemplateField の`FooterTemplate`します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-215">In Step 4 we'll include an Add button in the inserting interface in the `ProductID` TemplateField s `FooterTemplate`.</span></span>

<span data-ttu-id="1d21b-216">GridView のさまざまなフィールドの外観を向上させるためにもかまいません。</span><span class="sxs-lookup"><span data-stu-id="1d21b-216">Feel free to improve the appearance of the various GridView fields.</span></span> <span data-ttu-id="1d21b-217">書式を設定するなど、`UnitPrice`値を通貨、右揃え、 `UnitsInStock`、 `UnitsOnOrder`、および`ReorderLevel`フィールド、および更新プログラム、 `HeaderText` TemplateFields の値。</span><span class="sxs-lookup"><span data-stu-id="1d21b-217">For example, you might want to format the `UnitPrice` values as a currency, right-align the `UnitsInStock`, `UnitsOnOrder`, and `ReorderLevel` fields, and update the `HeaderText` values for the TemplateFields.</span></span>

<span data-ttu-id="1d21b-218">挿入でインターフェイスの高速移動機能を作成した後、 `FooterTemplate` s、削除、`SupplierID`と`CategoryID`TemplateFields、して書式設定と TemplateFields、GridView s 宣言型のアラインメントをグリッドの外観を向上させるマークアップは、次のようになります。</span><span class="sxs-lookup"><span data-stu-id="1d21b-218">After creating the slew of inserting interfaces in the `FooterTemplate` s, removing the `SupplierID`, and `CategoryID` TemplateFields, and improving the aesthetics of the grid through formatting and aligning the TemplateFields, your GridView s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample5.aspx)]

<span data-ttu-id="1d21b-219">ブラウザーで表示、ときに GridView のフッター行が含まれています、完成したインターフェイスの挿入 (図 10 参照)。</span><span class="sxs-lookup"><span data-stu-id="1d21b-219">When viewed through a browser, the GridView s footer row now includes the completed inserting interface (see Figure 10).</span></span> <span data-ttu-id="1d21b-220">この時点では、挿入のインターフェイスは t には、ユーザーが彼女 s 新しい製品のデータを入力し、データベースに新しいレコードを挿入する必要があるを指定するための手段が含まれます。</span><span class="sxs-lookup"><span data-stu-id="1d21b-220">At this point, the inserting interface doesn t include a means for the user to indicate that she s entered the data for the new product and wants to insert a new record into the database.</span></span> <span data-ttu-id="1d21b-221">ここではまた、フッターに入力されたデータで新しいレコードに変換する方法に対処するには、まだ ve、`Products`データベース。</span><span class="sxs-lookup"><span data-stu-id="1d21b-221">Also, we ve yet to address how the data entered into the footer will translate into a new record in the `Products` database.</span></span> <span data-ttu-id="1d21b-222">挿入インターフェイスに、[追加] ボタンを追加する方法とでコードを実行する方法について説明します、手順 4. でポストバックの場合、s をクリックします。</span><span class="sxs-lookup"><span data-stu-id="1d21b-222">In Step 4 we'll look at how to include an Add button to the inserting interface and how to execute code on postback when it s clicked.</span></span> <span data-ttu-id="1d21b-223">手順 5 では、フッターからデータを使用して新しいレコードを挿入する方法を示します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-223">Step 5 shows how to insert a new record using the data from the footer.</span></span>


<span data-ttu-id="1d21b-224">[![GridView のフッターは、新しいレコードを追加するインターフェイスを提供します](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="1d21b-224">[![The GridView Footer Provides an Interface for Adding a New Record](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image10.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image17.png)</span></span>

<span data-ttu-id="1d21b-225">**図 10**: GridView のフッターは、新しいレコードを追加するインターフェイスを提供します ([フルサイズの画像を表示する をクリックします](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image18.png))。</span><span class="sxs-lookup"><span data-stu-id="1d21b-225">**Figure 10**: The GridView Footer Provides an Interface for Adding a New Record ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image18.png))</span></span>


## <a name="step-4-including-an-add-button-in-the-inserting-interface"></a><span data-ttu-id="1d21b-226">手順 4: 挿入インターフェイスで、[追加] ボタンを含む</span><span class="sxs-lookup"><span data-stu-id="1d21b-226">Step 4: Including an Add Button in the Inserting Interface</span></span>

<span data-ttu-id="1d21b-227">インターフェイスの挿入を現在フッター行のユーザーが新しい製品の情報の入力を終了したことを指定するための手段がないため挿入インターフェイスにどこか、[追加] ボタンを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="1d21b-227">We need to include an Add button somewhere in the inserting interface since the footer row s inserting interface currently lacks the means for the user to indicate that they have completed entering the new product s information.</span></span> <span data-ttu-id="1d21b-228">これは、既存のいずれかに入れられます。 `FooterTemplate` 、または列を追加新しいグリッドにこの目的のためです。</span><span class="sxs-lookup"><span data-stu-id="1d21b-228">This could be placed in one of the existing `FooterTemplate` s or we could add a new column to the grid for this purpose.</span></span> <span data-ttu-id="1d21b-229">このチュートリアルでは、let s 配置に追加 ボタン、 `ProductID` TemplateField の`FooterTemplate`します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-229">For this tutorial, let s place the Add button in the `ProductID` TemplateField s `FooterTemplate`.</span></span>

<span data-ttu-id="1d21b-230">デザイナーでは、GridView s のスマート タグにテンプレートの編集リンクをクリックし、、`ProductID`フィールドの`FooterTemplate`ドロップダウン リストから。</span><span class="sxs-lookup"><span data-stu-id="1d21b-230">From the Designer, click on the Edit Templates link in the GridView s smart tag and then choose the `ProductID` field s `FooterTemplate` from the drop-down list.</span></span> <span data-ttu-id="1d21b-231">テンプレートにその ID に設定 ボタンの Web コントロール (または LinkButton または ImageButton、使用する場合) を追加`AddProduct`その`CommandName`挿入 をその`Text`図 11 に示すように追加するプロパティ。</span><span class="sxs-lookup"><span data-stu-id="1d21b-231">Add a Button Web control (or a LinkButton or ImageButton, if you prefer) to the template, setting its ID to `AddProduct`, its `CommandName` to Insert, and its `Text` property to Add as shown in Figure 11.</span></span>


<span data-ttu-id="1d21b-232">[![ProductID TemplateField s の後に追加 ボタンを配置します。](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="1d21b-232">[![Place the Add Button in the ProductID TemplateField s FooterTemplate](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image11.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image19.png)</span></span>

<span data-ttu-id="1d21b-233">**図 11**: で、[追加] ボタンを配置、 `ProductID` TemplateField s `FooterTemplate` ([フルサイズの画像を表示する をクリックします](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image20.png))。</span><span class="sxs-lookup"><span data-stu-id="1d21b-233">**Figure 11**: Place the Add Button in the `ProductID` TemplateField s `FooterTemplate` ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image20.png))</span></span>


<span data-ttu-id="1d21b-234">Ve するには、[追加] ボタンが含まれているとは、ブラウザーでページをテストします。</span><span class="sxs-lookup"><span data-stu-id="1d21b-234">Once you ve included the Add button, test out the page in a browser.</span></span> <span data-ttu-id="1d21b-235">無効なデータを挿入するインターフェイスの追加 ボタンをクリックすると、ポストバックは短いサーキットをメモし、ValidationSummary コントロール (図 12 を参照してください)、無効なデータを示します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-235">Note that when clicking the Add button with invalid data in the inserting interface, the postback is short circuited and the ValidationSummary control indicates the invalid data (see Figure 12).</span></span> <span data-ttu-id="1d21b-236">適切なデータ入力を追加 ボタンをクリックするとポストバックが発生します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-236">With appropriate data entered, clicking the Add button causes a postback.</span></span> <span data-ttu-id="1d21b-237">レコードがないデータベースに追加、ただし。</span><span class="sxs-lookup"><span data-stu-id="1d21b-237">No record is added to the database, however.</span></span> <span data-ttu-id="1d21b-238">実際に挿入を実行するコードを少し記述する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1d21b-238">We will need to write a bit of code to actually perform the insert.</span></span>


<span data-ttu-id="1d21b-239">[![ボタンの追加 s ポストバックは短いサーキット挿入インターフェイスに無効なデータがある場合](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="1d21b-239">[![The Add Button s Postback is Short Circuited if There is Invalid Data in the Inserting Interface](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image12.gif)](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image21.png)</span></span>

<span data-ttu-id="1d21b-240">**図 12**: ボタンの追加 s ポストバック サーキットの短い挿入インターフェイスに無効なデータがある場合は、([フルサイズの画像を表示する をクリックします](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image22.png))。</span><span class="sxs-lookup"><span data-stu-id="1d21b-240">**Figure 12**: The Add Button s Postback is Short Circuited if There is Invalid Data in the Inserting Interface ([Click to view full-size image](inserting-a-new-record-from-the-gridview-s-footer-vb/_static/image22.png))</span></span>


> [!NOTE]
> <span data-ttu-id="1d21b-241">挿入インターフェイスに検証コントロールが、検証グループに割り当てられていません。</span><span class="sxs-lookup"><span data-stu-id="1d21b-241">The validation controls in the inserting interface were not assigned to a validation group.</span></span> <span data-ttu-id="1d21b-242">挿入のインターフェイスが、ページの検証コントロールの唯一のセットが正しく動作します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-242">This works fine so long as the inserting interface is the only set of validation controls on the page.</span></span> <span data-ttu-id="1d21b-243">挿入検証コントロールがインターフェイスし、s のボタンを追加する場合、ただし、(グリッドの編集インターフェイスに検証コントロール) など、ページ上の他の検証コントロールがある、`ValidationGroup`プロパティに同じ値を割り当てる必要がありますを soこれらのコントロールを特定の検証グループに関連付けます。</span><span class="sxs-lookup"><span data-stu-id="1d21b-243">If, however, there are other validation controls on the page (such as validation controls in the grid s editing interface), the validation controls in the inserting interface and Add button s `ValidationGroup` properties should be assigned the same value so as to associate these controls with a particular validation group.</span></span> <span data-ttu-id="1d21b-244">参照してください[詳細に分析する ASP.NET 2.0 の検証コントロール](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx)検証グループへの検証コントロールとボタンを 1 ページのパーティション分割の詳細についてはします。</span><span class="sxs-lookup"><span data-stu-id="1d21b-244">See [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx) for more information on partitioning the validation controls and buttons on a page into validation groups.</span></span>


## <a name="step-5-inserting-a-new-record-into-theproductstable"></a><span data-ttu-id="1d21b-245">手順 5: に新しいレコードの挿入、`Products`テーブル</span><span class="sxs-lookup"><span data-stu-id="1d21b-245">Step 5: Inserting a New Record Into the`Products`Table</span></span>

<span data-ttu-id="1d21b-246">GridView の組み込みの編集機能を利用する場合、GridView に自動的に更新プログラムを実行するために必要な作業のすべてを処理します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-246">When utilizing the built-in editing features of the GridView, the GridView automatically handles all of the work necessary for performing the update.</span></span> <span data-ttu-id="1d21b-247">具体的には、[更新] ボタンがクリックされたときにコピー編集インターフェイスから ObjectDataSource のパラメーターに入力された値`UpdateParameters`コレクションとが開始され、ObjectDataSource s を呼び出すことによって更新をオフ`Update()`メソッド。</span><span class="sxs-lookup"><span data-stu-id="1d21b-247">In particular, when the Update button is clicked it copies the values entered from the editing interface to the parameters in the ObjectDataSource s `UpdateParameters` collection and kicks off the update by invoking the ObjectDataSource s `Update()` method.</span></span> <span data-ttu-id="1d21b-248">ObjectDataSource s を呼び出すコードを実装する必要があります、GridView が挿入するためのような組み込み機能を提供していないため`Insert()`メソッドと ObjectDataSource s インターフェイスの挿入、値コピー`InsertParameters`コレクション.</span><span class="sxs-lookup"><span data-stu-id="1d21b-248">Since the GridView does not provide such built-in functionality for inserting, we must implement code that calls the ObjectDataSource s `Insert()` method and copies the values from the inserting interface to the ObjectDataSource s `InsertParameters` collection.</span></span>

<span data-ttu-id="1d21b-249">[追加] ボタンがクリックしてされた後、この挿入のロジックを実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1d21b-249">This insert logic should be executed after the Add button has been clicked.</span></span> <span data-ttu-id="1d21b-250">説明したように、[を追加して GridView にボタンに応答する](../custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb.md)チュートリアルでは、ボタン、LinkButton、または、GridView で ImageButton がクリックされた GridView s ときにいつでも`RowCommand`ポストバック イベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-250">As discussed in the [Adding and Responding to Buttons in a GridView](../custom-button-actions/adding-and-responding-to-buttons-to-a-gridview-vb.md) tutorial, anytime a Button, LinkButton, or ImageButton in a GridView is clicked, the GridView s `RowCommand` event fires on postback.</span></span> <span data-ttu-id="1d21b-251">このイベントが発生するかどうかボタンや LinkButton、ImageButton が明示的に追加など、フッター行の追加 ボタンまたは GridView で自動的に追加されたかどうか (並べ替えを有効にする機能が選択されている場合は、各列の上部にあるなど、またはLinkbutton でページングを有効にするを選択すると、ページング インターフェイス)。</span><span class="sxs-lookup"><span data-stu-id="1d21b-251">This event fires whether the Button, LinkButton, or ImageButton was added explicitly such as the Add button in the footer row or if it was automatically added by the GridView (such as the LinkButtons at the top of each column when Enable Sorting is selected, or the LinkButtons in the paging interface when Enable Paging is selected).</span></span>

<span data-ttu-id="1d21b-252">そのためを追加 ボタンをクリックすると、ユーザーに応答する必要があります、GridView のイベント ハンドラーを作成する`RowCommand`イベント。</span><span class="sxs-lookup"><span data-stu-id="1d21b-252">Therefore, to respond to the user clicking the Add button, we need to create an event handler for the GridView s `RowCommand` event.</span></span> <span data-ttu-id="1d21b-253">ときにこのイベントが起動するため*任意*ボタンや LinkButton、ImageButton、GridView では、クリックすると、その s ことだけに進むロジックを挿入する場合に重要な`CommandName`プロパティが、にイベントハンドラーのマップに渡されます`CommandName`追加ボタン (Insert) の値。</span><span class="sxs-lookup"><span data-stu-id="1d21b-253">Since this event fires whenever *any* Button, LinkButton, or ImageButton in the GridView is clicked, it s vital that we only proceed with the inserting logic if the `CommandName` property passed into the event handler maps to the `CommandName` value of the Add button ( Insert ).</span></span> <span data-ttu-id="1d21b-254">さらに、必要がありますものみ進みます検証コントロールが有効なデータを報告する場合。</span><span class="sxs-lookup"><span data-stu-id="1d21b-254">Moreover, we should also only proceed if the validation controls report valid data.</span></span> <span data-ttu-id="1d21b-255">これに合わせて、イベント ハンドラーを作成、`RowCommand`次のコードでイベント。</span><span class="sxs-lookup"><span data-stu-id="1d21b-255">To accommodate this, create an event handler for the `RowCommand` event with the following code:</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample6.vb)]

> [!NOTE]
> <span data-ttu-id="1d21b-256">でしょうか、イベント ハンドラーのチェックが許容できない理由、`Page.IsValid`プロパティ。</span><span class="sxs-lookup"><span data-stu-id="1d21b-256">You may be wondering why the event handler bothers checking the `Page.IsValid` property.</span></span> <span data-ttu-id="1d21b-257">結局のところ、受注 t、ポストバックでは、無効なデータが挿入インターフェイスに指定されている場合を抑制するか。</span><span class="sxs-lookup"><span data-stu-id="1d21b-257">After all, won t the postback be suppressed if invalid data is provided in the inserting interface?</span></span> <span data-ttu-id="1d21b-258">そうでは、ユーザーは、JavaScript が無効またはクライアント側検証ロジックを回避する手段である限り正しい。</span><span class="sxs-lookup"><span data-stu-id="1d21b-258">This assumption is correct as long as the user has not disabled JavaScript or has taken steps to circumvent the client-side validation logic.</span></span> <span data-ttu-id="1d21b-259">つまり、1 つ必要がありますに依存しないように厳密にクライアント側の検証サーバー側の有効性チェックは、データを操作する前に常に実行する必要があります。</span><span class="sxs-lookup"><span data-stu-id="1d21b-259">In short, one should never rely strictly on client-side validation; a server-side check for validity should always be performed before working with the data.</span></span>


<span data-ttu-id="1d21b-260">手順 1. で作成した、 `ProductsDataSource` ObjectDataSource ようにその`Insert()`をメソッドにマップされて、`ProductsBLL`クラスの`AddProduct`メソッド。</span><span class="sxs-lookup"><span data-stu-id="1d21b-260">In Step 1 we created the `ProductsDataSource` ObjectDataSource such that its `Insert()` method is mapped to the `ProductsBLL` class s `AddProduct` method.</span></span> <span data-ttu-id="1d21b-261">新しいレコードを挿入するのには、`Products`テーブル、ObjectDataSource s を単に呼び出すことができます`Insert()`メソッド。</span><span class="sxs-lookup"><span data-stu-id="1d21b-261">To insert the new record into the `Products` table, we can simply invoke the ObjectDataSource s `Insert()` method:</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample7.vb)]

<span data-ttu-id="1d21b-262">これで、`Insert()`メソッドが呼び出されてに渡されたままの挿入のインターフェイスからパラメーターに値をコピーするは、`ProductsBLL`クラスの`AddProduct`メソッド。</span><span class="sxs-lookup"><span data-stu-id="1d21b-262">Now that the `Insert()` method has been invoked, all that remains is to copy the values from the inserting interface to the parameters passed to the `ProductsBLL` class s `AddProduct` method.</span></span> <span data-ttu-id="1d21b-263">説明したように、 [、イベントに関連付けられている挿入、更新、および削除の確認](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)チュートリアルでは、これは、ObjectDataSource s を通じて実現できます`Inserting`イベント。</span><span class="sxs-lookup"><span data-stu-id="1d21b-263">As we saw back in the [Examining the Events Associated with Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) tutorial, this can be accomplished through the ObjectDataSource s `Inserting` event.</span></span> <span data-ttu-id="1d21b-264">`Inserting`イベントからコントロールをプログラムで参照する必要があります、 `Products` GridView のフッター行し、それらの値を割り当てる、`e.InputParameters`コレクション。</span><span class="sxs-lookup"><span data-stu-id="1d21b-264">In the `Inserting` event we need to programmatically reference the controls from the `Products` GridView s footer row and assign their values to the `e.InputParameters` collection.</span></span> <span data-ttu-id="1d21b-265">ユーザーは、終了などの値を指定しない場合、`ReorderLevel`テキスト ボックスに空のデータベースに挿入された値があることを指定する必要があります`NULL`します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-265">If the user omits a value such as leaving the `ReorderLevel` TextBox blank we need to specify that the value inserted into the database should be `NULL`.</span></span> <span data-ttu-id="1d21b-266">以降、`AddProducts`メソッドは null 許容のデータベース フィールドに null 許容型を受け取ります null 許容型を使用して、単にその値に設定`Nothing`の場合はユーザー入力を省略するとします。</span><span class="sxs-lookup"><span data-stu-id="1d21b-266">Since the `AddProducts` method accepts nullable types for the nullable database fields, simply use a nullable type and set its value to `Nothing` in the case where user input is omitted.</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample8.vb)]

<span data-ttu-id="1d21b-267">`Inserting`イベント ハンドラーが完了した、新しいレコードに追加することができます、 `Products` GridView のフッター行を使用してデータベース テーブル。</span><span class="sxs-lookup"><span data-stu-id="1d21b-267">With the `Inserting` event handler completed, new records can be added to the `Products` database table via the GridView s footer row.</span></span> <span data-ttu-id="1d21b-268">さあ、いくつかの新しい製品を追加してみてください。</span><span class="sxs-lookup"><span data-stu-id="1d21b-268">Go ahead and try adding several new products.</span></span>

## <a name="enhancing-and-customizing-the-add-operation"></a><span data-ttu-id="1d21b-269">拡張およびカスタマイズするには、操作の追加</span><span class="sxs-lookup"><span data-stu-id="1d21b-269">Enhancing and Customizing the Add Operation</span></span>

<span data-ttu-id="1d21b-270">現時点では、[追加] ボタンをクリックすると、データベース テーブルに新しいレコードを追加は提供されませんあらゆる種類の視覚的なフィードバック、レコードが正常に追加されたこと。</span><span class="sxs-lookup"><span data-stu-id="1d21b-270">Currently, clicking the Add button adds a new record to the database table but does not provide any sort of visual feedback that the record has successfully been added.</span></span> <span data-ttu-id="1d21b-271">理想的には、Label Web コントロールやクライアント側の警告ボックスは、正常に完了しましたが、挿入をユーザーに通知します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-271">Ideally, a Label Web control or client-side alert box would inform the user that their insert has completed with success.</span></span> <span data-ttu-id="1d21b-272">ままを演習として、リーダーの。</span><span class="sxs-lookup"><span data-stu-id="1d21b-272">I leave this as an exercise for the reader.</span></span>

<span data-ttu-id="1d21b-273">このチュートリアルで使用される GridView では、以下の製品には、任意の並べ替え順序は当てはまりませんもデータを並べ替えるには、エンドユーザーは許可します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-273">The GridView used in this tutorial does not apply any sort order to the listed products, nor does it allow the end user to sort the data.</span></span> <span data-ttu-id="1d21b-274">その結果、レコードは、主キー フィールドでは、データベースのように並べ替えられます。</span><span class="sxs-lookup"><span data-stu-id="1d21b-274">Consequently, the records are ordered as they are in the database by their primary key field.</span></span> <span data-ttu-id="1d21b-275">新しい各レコードがあるため、`ProductID`最後の 1 つのグリッドの最後に数行の新しい製品が追加されるたびにより大きい値です。</span><span class="sxs-lookup"><span data-stu-id="1d21b-275">Since each new record has a `ProductID` value greater than the last one, every time a new product is added it is tacked on to the end of the grid.</span></span> <span data-ttu-id="1d21b-276">そのため、新しいレコードを追加した後、GridView の最後のページにユーザーを自動的に送信したい場合があります。</span><span class="sxs-lookup"><span data-stu-id="1d21b-276">Therefore, you may want to automatically send the user to the last page of the GridView after adding a new record.</span></span> <span data-ttu-id="1d21b-277">これは、呼び出しの後に次のコード行を追加することで実現できます`ProductsDataSource.Insert()`で、`RowCommand`をユーザーが最後のページ内にデータを GridView にバインドした後は送信する必要があることを示すためにイベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="1d21b-277">This can be accomplished by adding the following line of code after the call to `ProductsDataSource.Insert()` in the `RowCommand` event handler to indicate that the user needs to be sent to the last page after binding the data to the GridView:</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample9.vb)]

<span data-ttu-id="1d21b-278">`SendUserToLastPage` 値が割り当てられますが最初にページ レベルのブール値変数`False`します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-278">`SendUserToLastPage` is a page-level Boolean variable that is initially assigned a value of `False`.</span></span> <span data-ttu-id="1d21b-279">GridView s`DataBound`イベント ハンドラーを場合`SendUserToLastPage`が false の場合、`PageIndex`最後のページをユーザーに送信するプロパティを更新します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-279">In the GridView s `DataBound` event handler, if `SendUserToLastPage` is false, the `PageIndex` property is updated to send the user to the last page.</span></span>


[!code-vb[Main](inserting-a-new-record-from-the-gridview-s-footer-vb/samples/sample10.vb)]

<span data-ttu-id="1d21b-280">理由、`PageIndex`プロパティで設定されて、`DataBound`イベント ハンドラー (ではなく、`RowCommand`イベント ハンドラー) がときに、`RowCommand`イベント ハンドラーを起動新しいレコードを追加するには、まだ ve、`Products`データベース テーブル。</span><span class="sxs-lookup"><span data-stu-id="1d21b-280">The reason the `PageIndex` property is set in the `DataBound` event handler (as opposed to the `RowCommand` event handler) is because when the `RowCommand` event handler fires we ve yet to add the new record to the `Products` database table.</span></span> <span data-ttu-id="1d21b-281">そのため、`RowCommand`イベント ハンドラーの最後のページ インデックス (`PageCount - 1`) 最後のページ インデックスを表す*する前に*新製品が追加されました。</span><span class="sxs-lookup"><span data-stu-id="1d21b-281">Therefore, in the `RowCommand` event handler the last page index (`PageCount - 1`) represents the last page index *before* the new product has been added.</span></span> <span data-ttu-id="1d21b-282">追加されている製品のほとんどは、最後のページ インデックスは、同じを新しい製品を追加した後です。</span><span class="sxs-lookup"><span data-stu-id="1d21b-282">For the majority of products being added, the last page index is the same after adding the new product.</span></span> <span data-ttu-id="1d21b-283">正しくない更新と、新しい最後のページ インデックスに追加された製品が発生する場合は、`PageIndex`で、`RowCommand`そのイベント ハンドラーは新しい最後のページの i ではなくの 2 番目の最後のページ (新しい製品を追加する前に最後のページ インデックス) に移動しますあります。</span><span class="sxs-lookup"><span data-stu-id="1d21b-283">But when the added product results in a new last page index, if we incorrectly update the `PageIndex` in the `RowCommand` event handler then we'll be taken to the second to last page (the last page index prior to adding the new product) as opposed to the new last page index.</span></span> <span data-ttu-id="1d21b-284">以降、`DataBound`イベント ハンドラーが、新しい成果物が追加され、データが設定して、グリッドに再バインド後に起動、`PageIndex`プロパティがありますがわかっています re 正しいの最後のページ インデックスを取得します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-284">Since the `DataBound` event handler fires after the new product has been added and the data rebound to the grid, by setting the `PageIndex` property there we know we re getting the correct last page index.</span></span>

<span data-ttu-id="1d21b-285">最後に、このチュートリアルで使用される GridView が新しい製品を追加するために収集する必要がありますフィールドの数が非常にさまざまです。</span><span class="sxs-lookup"><span data-stu-id="1d21b-285">Finally, the GridView used in this tutorial is quite wide due to the number of fields that must be collected for adding a new product.</span></span> <span data-ttu-id="1d21b-286">この幅のため DetailsView s の縦方向のレイアウトが優先される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="1d21b-286">Due to this width, a DetailsView s vertical layout might be preferred.</span></span> <span data-ttu-id="1d21b-287">GridView の秒数の入力を収集することによって削減できた全体の幅。</span><span class="sxs-lookup"><span data-stu-id="1d21b-287">The GridView s overall width could be reduced by collecting fewer inputs.</span></span> <span data-ttu-id="1d21b-288">おそらくことを収集する必要はありません、 `UnitsOnOrder`、 `UnitsInStock`、および`ReorderLevel`フィールドの新しい製品を追加するときに GridView から場合これらのフィールドを削除できます。</span><span class="sxs-lookup"><span data-stu-id="1d21b-288">Perhaps we don t need to collect the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields when adding a new product, in which case these fields could be removed from the GridView.</span></span>

<span data-ttu-id="1d21b-289">収集されたデータを調整するには、2 つの方法のいずれかを使用できます。</span><span class="sxs-lookup"><span data-stu-id="1d21b-289">To adjust the data collected, we can use one of two approaches:</span></span>

- <span data-ttu-id="1d21b-290">引き続き使用する、`AddProduct`の値を必要とするメソッド、 `UnitsOnOrder`、 `UnitsInStock`、および`ReorderLevel`フィールド。</span><span class="sxs-lookup"><span data-stu-id="1d21b-290">Continue to use the `AddProduct` method that expects values for the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields.</span></span> <span data-ttu-id="1d21b-291">`Inserting`イベント ハンドラーでは、ハード コーディングされた提供、既定の挿入のインターフェイスから削除されたこれらの入力に使用する値。</span><span class="sxs-lookup"><span data-stu-id="1d21b-291">In the `Inserting` event handler, provide hard-coded, default values to use for these inputs that have been removed from the inserting interface.</span></span>
- <span data-ttu-id="1d21b-292">新しいオーバー ロードを作成、`AddProduct`メソッドで、`ProductsBLL`の入力を受け付けないクラス、 `UnitsOnOrder`、 `UnitsInStock`、および`ReorderLevel`フィールド。</span><span class="sxs-lookup"><span data-stu-id="1d21b-292">Create a new overload of the `AddProduct` method in the `ProductsBLL` class that does not accept inputs for the `UnitsOnOrder`, `UnitsInStock`, and `ReorderLevel` fields.</span></span> <span data-ttu-id="1d21b-293">次に、ASP.NET ページでは、この新しいオーバー ロードを使用する ObjectDataSource を構成します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-293">Then, in the ASP.NET page, configure the ObjectDataSource to use this new overload.</span></span>

<span data-ttu-id="1d21b-294">いずれかのオプションはも同様に動作します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-294">Either option will work equally as well.</span></span> <span data-ttu-id="1d21b-295">過去のチュートリアルを使用して、後者のオプションの複数のオーバー ロードを作成、`ProductsBLL`クラスの`UpdateProduct`メソッド。</span><span class="sxs-lookup"><span data-stu-id="1d21b-295">In past tutorials we used the latter option, creating multiple overloads for the `ProductsBLL` class s `UpdateProduct` method.</span></span>

## <a name="summary"></a><span data-ttu-id="1d21b-296">まとめ</span><span class="sxs-lookup"><span data-stu-id="1d21b-296">Summary</span></span>

<span data-ttu-id="1d21b-297">GridView、DetailsView や FormView、組み込みの挿入機能が不足していますが、少しの努力でフッター行に挿入のインターフェイスを追加できます。</span><span class="sxs-lookup"><span data-stu-id="1d21b-297">The GridView lacks the built-in inserting capabilities found in the DetailsView and FormView, but with a bit of effort an inserting interface can be added to the footer row.</span></span> <span data-ttu-id="1d21b-298">単に GridView のフッター行を表示する次のように設定します。 その`ShowFooter`プロパティを`True`します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-298">To display the footer row in a GridView simply set its `ShowFooter` property to `True`.</span></span> <span data-ttu-id="1d21b-299">フィールドを TemplateField に変換すると、各フィールドのフッター行の内容をカスタマイズでき、挿入を追加するためのインターフェイス、`FooterTemplate`します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-299">The footer row content can be customized for each field by converting the field to a TemplateField and adding the inserting interface to the `FooterTemplate`.</span></span> <span data-ttu-id="1d21b-300">このチュートリアルで説明したように、`FooterTemplate`ボタン、テキスト ボックス、Dropdownlist、チェック ボックス、Dropdownlist) などのデータ ドリブンの Web コントロールを設定するためのデータ ソース コントロール、および検証コントロールを含めることができます。</span><span class="sxs-lookup"><span data-stu-id="1d21b-300">As we saw in this tutorial, the `FooterTemplate` can contain Buttons, TextBoxes, DropDownLists, CheckBoxes, data source controls for populating data-driven Web controls (such as DropDownLists), and validation controls.</span></span> <span data-ttu-id="1d21b-301">ユーザーの入力を収集するためのコントロール、と共に、ボタンの追加、LinkButton や ImageButton が必要です。</span><span class="sxs-lookup"><span data-stu-id="1d21b-301">Along with controls for collecting the user s input, an Add Button, LinkButton, or ImageButton is needed.</span></span>

<span data-ttu-id="1d21b-302">[追加] ボタンがクリックされたとき、ObjectDataSource の`Insert()`挿入のワークフローを開始するメソッドが呼び出されます。</span><span class="sxs-lookup"><span data-stu-id="1d21b-302">When the Add button is clicked, the ObjectDataSource s `Insert()` method is invoked to start the inserting workflow.</span></span> <span data-ttu-id="1d21b-303">ObjectDataSource は、構成されている insert メソッドを呼び出して (、`ProductsBLL`クラスの`AddProduct`メソッドは、このチュートリアルでは)。</span><span class="sxs-lookup"><span data-stu-id="1d21b-303">The ObjectDataSource will then call the configured insert method (the `ProductsBLL` class s `AddProduct` method, in this tutorial).</span></span> <span data-ttu-id="1d21b-304">ObjectDataSource にインターフェイスを挿入する GridView s から値をコピーする必要があります`InsertParameters`insert メソッドが呼び出される前に収集します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-304">We must copy the values from the GridView s inserting interface to the ObjectDataSource s `InsertParameters` collection prior to the insert method being invoked.</span></span> <span data-ttu-id="1d21b-305">これは、ObjectDataSource s で挿入インターフェイス Web コントロールをプログラムで参照することで実現できます`Inserting`イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="1d21b-305">This can be accomplished by programmatically referencing the inserting interface Web controls in the ObjectDataSource s `Inserting` event handler.</span></span>

<span data-ttu-id="1d21b-306">このチュートリアルでは、GridView の外観を強化するための手法で、外観を完了します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-306">This tutorial completes our look at techniques for enhancing the GridView s appearance.</span></span> <span data-ttu-id="1d21b-307">次の一連のチュートリアルは、画像、Pdf、Word 文書などのバイナリ データを操作する方法とデータ Web コントロールを調べます。</span><span class="sxs-lookup"><span data-stu-id="1d21b-307">The next set of tutorials will examine how to work with binary data such as images, PDFs, Word documents, and so on and the data Web controls.</span></span>

<span data-ttu-id="1d21b-308">満足のプログラミングです。</span><span class="sxs-lookup"><span data-stu-id="1d21b-308">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="1d21b-309">執筆者紹介</span><span class="sxs-lookup"><span data-stu-id="1d21b-309">About the Author</span></span>

<span data-ttu-id="1d21b-310">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)、7 つ受け取りますブックおよびの創設者の著者[4GuysFromRolla.com](http://www.4guysfromrolla.com)、Microsoft Web テクノロジと 1998 年から携わっています。</span><span class="sxs-lookup"><span data-stu-id="1d21b-310">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="1d21b-311">Scott は、フリーのコンサルタント、トレーナー、およびライターとして動作します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-311">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="1d21b-312">最新の著書は[ *Sams 教える自分で ASP.NET 2.0 24 時間以内に*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-312">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="1d21b-313">彼に到達できる[mitchell@4GuysFromRolla.comします。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="1d21b-313">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="1d21b-314">彼のブログにあるでまたは[ http://ScottOnWriting.NET](http://ScottOnWriting.NET)します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-314">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="1d21b-315">特別なに感謝します。</span><span class="sxs-lookup"><span data-stu-id="1d21b-315">Special Thanks To</span></span>

<span data-ttu-id="1d21b-316">このチュートリアル シリーズは、多くの便利なレビュー担当者によってレビューされました。</span><span class="sxs-lookup"><span data-stu-id="1d21b-316">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="1d21b-317">このチュートリアルでは、潜在顧客レビュー担当者は、「社長補佐 Leigh でした。</span><span class="sxs-lookup"><span data-stu-id="1d21b-317">Lead reviewer for this tutorial was Bernadette Leigh.</span></span> <span data-ttu-id="1d21b-318">今後、MSDN の記事を確認したいですか。</span><span class="sxs-lookup"><span data-stu-id="1d21b-318">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="1d21b-319">場合は、筆者に[mitchell@4GuysFromRolla.comします。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="1d21b-319">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="1d21b-320">前へ</span><span class="sxs-lookup"><span data-stu-id="1d21b-320">Previous</span></span>](adding-a-gridview-column-of-checkboxes-vb.md)
