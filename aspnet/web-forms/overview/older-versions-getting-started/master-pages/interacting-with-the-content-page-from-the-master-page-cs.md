---
uid: web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-content-page-from-the-master-page-cs
title: マスター ページ (c#) からコンテンツ ページと対話する |Microsoft Docs
author: rick-anderson
description: メソッドを呼び出す、マスター ページのコードから、[コンテンツ] ページのプロパティなどを設定する方法について説明します。
ms.author: aspnetcontent
ms.date: 07/11/2008
ms.assetid: 3282df5e-516c-4972-8666-313828b90fb5
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/interacting-with-the-content-page-from-the-master-page-cs
msc.type: authoredcontent
ms.openlocfilehash: 293e4dab6142393c9d57836a2f04244388e54cec
ms.sourcegitcommit: b28cd0313af316c051c2ff8549865bff67f2fbb4
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 07/05/2018
ms.locfileid: "37808367"
---
<a name="interacting-with-the-content-page-from-the-master-page-c"></a><span data-ttu-id="40ed8-103">マスター ページ (c#) からコンテンツ ページと対話します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-103">Interacting with the Content Page from the Master Page (C#)</span></span>
====================
<span data-ttu-id="40ed8-104">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="40ed8-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="40ed8-105">[コードのダウンロード](http://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_07_CS.zip)または[PDF のダウンロード](http://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_07_CS.pdf)</span><span class="sxs-lookup"><span data-stu-id="40ed8-105">[Download Code](http://download.microsoft.com/download/1/8/4/184e24fa-fcc8-47fa-ac99-4b6a52d41e97/ASPNET_MasterPages_Tutorial_07_CS.zip) or [Download PDF](http://download.microsoft.com/download/e/b/4/eb4abb10-c416-4ba4-9899-32577715b1bd/ASPNET_MasterPages_Tutorial_07_CS.pdf)</span></span>

> <span data-ttu-id="40ed8-106">メソッドを呼び出す、マスター ページのコードから、[コンテンツ] ページのプロパティなどを設定する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-106">Examines how to call methods, set properties, etc. of the Content Page from code in the Master Page.</span></span>


## <a name="introduction"></a><span data-ttu-id="40ed8-107">はじめに</span><span class="sxs-lookup"><span data-stu-id="40ed8-107">Introduction</span></span>

<span data-ttu-id="40ed8-108">上記のチュートリアルでは、コンテンツ ページがそのマスター ページとプログラムでやり取りする方法を調査します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-108">The preceding tutorial examined how to have the content page programmatically interact with its master page.</span></span> <span data-ttu-id="40ed8-109">再現率が最も最近、5 つを表示する GridView コントロールに含めるマスター ページを更新しましたでは、製品を追加します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-109">Recall that we updated the master page to include a GridView control that listed the five most recently added products.</span></span> <span data-ttu-id="40ed8-110">[コンテンツ] ページのユーザーが新しい製品を追加でしたを作成しました。</span><span class="sxs-lookup"><span data-stu-id="40ed8-110">We then created a content page from which the user could add a new product.</span></span> <span data-ttu-id="40ed8-111">新しい製品を追加すると、マスター ページだけで追加された製品にが含ま ために、GridView を更新するように指示するコンテンツ ページが必要です。</span><span class="sxs-lookup"><span data-stu-id="40ed8-111">Upon adding a new product, the content page needed to instruct the master page to refresh its GridView so that it would include the just-added product.</span></span> <span data-ttu-id="40ed8-112">この機能は、更新されたデータにバインドされている、GridView では、マスター ページをパブリック メソッドを追加し、[コンテンツ] ページからそのメソッドを呼び出すいました。</span><span class="sxs-lookup"><span data-stu-id="40ed8-112">This functionality was accomplished by adding a public method to the master page that refreshed the data bound to the GridView, and then invoking that method from the content page.</span></span>

<span data-ttu-id="40ed8-113">コンテンツとマスター ページの相互作用の最も一般的な形式は、[コンテンツ] ページから発生します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-113">The most common form of content and master page interaction originates from the content page.</span></span> <span data-ttu-id="40ed8-114">ただしの操作に現在のコンテンツ ページを rouse にマスター ページの可能性があり、マスター ページには、ユーザーが [コンテンツ] ページにも表示されているデータを変更できるユーザー インターフェイス要素が含まれている場合、このような機能が必要な場合があります。</span><span class="sxs-lookup"><span data-stu-id="40ed8-114">However, it is possible for the master page to rouse the current content page into action, and such functionality may be needed if the master page contains user interface elements that enable users to modify data that is also displayed on the content page.</span></span> <span data-ttu-id="40ed8-115">コンテンツ ページがクリックされたときに、ボタンを含むマスター ページ コントロールを GridView の製品情報は、制御が表示されます、すべての製品の価格を倍にします。</span><span class="sxs-lookup"><span data-stu-id="40ed8-115">Consider a content page that displays the products information in a GridView control and a master page that includes a Button control that, when clicked, doubles the prices of all products.</span></span> <span data-ttu-id="40ed8-116">前のチュートリアルで例と同様、GridView が二重の価格、新しい価格を表示するようにボタンがクリックされた後に更新する必要がありますが、このシナリオでは、[コンテンツ] ページを rouse がアクションにする必要があるマスター ページ。</span><span class="sxs-lookup"><span data-stu-id="40ed8-116">Much like the example in the preceding tutorial, the GridView needs to be refreshed after the double price Button is clicked so that it displays the new prices, but in this scenario it's the master page that needs to rouse the content page into action.</span></span>

<span data-ttu-id="40ed8-117">このチュートリアルでは、マスター ページ、[コンテンツ] ページで定義されている機能を起動する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-117">This tutorial explores how to have the master page invoke functionality defined in the content page.</span></span>

### <a name="instigating-programmatic-interaction-via-an-event-and-event-handlers"></a><span data-ttu-id="40ed8-118">イベントとイベント ハンドラーを使用してプログラムの対話を仕掛ける</span><span class="sxs-lookup"><span data-stu-id="40ed8-118">Instigating Programmatic Interaction via an Event and Event Handlers</span></span>

<span data-ttu-id="40ed8-119">マスター ページからコンテンツ ページの機能を呼び出すことは、別の方法よりもより困難になります。</span><span class="sxs-lookup"><span data-stu-id="40ed8-119">Invoking content page functionality from a master page is more challenging than the other way around.</span></span> <span data-ttu-id="40ed8-120">コンテンツ ページからプログラムの対話を仕掛けるときに、コンテンツ ページが単一のマスター ページは、どのようなパブリック メソッドとプロパティは、自由に、わかっています。</span><span class="sxs-lookup"><span data-stu-id="40ed8-120">Because a content page has a single master page, when instigating the programmatic interaction from the content page we know what public methods and properties are at our disposal.</span></span> <span data-ttu-id="40ed8-121">マスター ページ、ただし、多くの異なるコンテンツ ページ、それぞれに独自のプロパティとメソッドのセットもかまいません。</span><span class="sxs-lookup"><span data-stu-id="40ed8-121">A master page, however, can have many different content pages, each with its own set of properties and methods.</span></span> <span data-ttu-id="40ed8-122">方法については、次に、記述すればコード実行時までにどのようなコンテンツ ページが呼び出されますがわからないときに、そのコンテンツのページで何らかのアクションを実行するマスター ページのでしょうか。</span><span class="sxs-lookup"><span data-stu-id="40ed8-122">How, then, can we write code in the master page to perform some action in its content page when we don't know what content page will be invoked until runtime?</span></span>

<span data-ttu-id="40ed8-123">ボタン コントロールなどの ASP.NET Web コントロールを検討してください。</span><span class="sxs-lookup"><span data-stu-id="40ed8-123">Consider an ASP.NET Web control, such as the Button control.</span></span> <span data-ttu-id="40ed8-124">ボタン コントロールは、任意の数の ASP.NET ページに表示できるし、メカニズムを知らせることができます、ページがクリックしてされたことが必要です。</span><span class="sxs-lookup"><span data-stu-id="40ed8-124">A Button control can appear on any number of ASP.NET pages and needs a mechanism by which it can alert the page that it has been clicked.</span></span> <span data-ttu-id="40ed8-125">これは*イベント*します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-125">This is accomplished using *events*.</span></span> <span data-ttu-id="40ed8-126">具体的には、ボタン コントロールを発生させますその`Click`イベント ボタンを含む ASP.NET ページが経由でその通知に応答できるオプションをクリックすると、*イベント ハンドラー*します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-126">In particular, the Button control raises its `Click` event when it is clicked; the ASP.NET page that contains the Button can optionally respond to that notification via an *event handler*.</span></span>

<span data-ttu-id="40ed8-127">これと同じパターンは、そのコンテンツのページで、マスター ページのトリガー機能させるために使用できます。</span><span class="sxs-lookup"><span data-stu-id="40ed8-127">This same pattern can be used to have a master page trigger functionality in its content pages:</span></span>

1. <span data-ttu-id="40ed8-128">イベントは、マスター ページを追加します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-128">Add an event to the master page.</span></span>
2. <span data-ttu-id="40ed8-129">マスター ページは、そのコンテンツ ページと通信する必要があるときにイベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-129">Raise the event whenever the master page needs to communicate with its content page.</span></span> <span data-ttu-id="40ed8-130">たとえば、マスター ページは、ユーザーには、価格が倍増したの [コンテンツ] ページにアラートを生成する必要があります、そのイベントは発生します価格が 2 倍にした直後に。</span><span class="sxs-lookup"><span data-stu-id="40ed8-130">For example, if the master page needs to alert its content page that the user has doubled the prices, its event would be raised immediately after the prices have been doubled.</span></span>
3. <span data-ttu-id="40ed8-131">いくつかの操作を行う必要のあるコンテンツ ページで、イベント ハンドラーを作成します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-131">Create an event handler in those content pages that need to take some action.</span></span>

<span data-ttu-id="40ed8-132">このチュートリアルの残りの部分実装; 概要で説明した例具体的には、データベース内の製品を一覧表示されたコンテンツ ページとボタンを含むマスター ページは、価格の 2 倍に制御します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-132">This remainder of this tutorial implements the example outlined in the Introduction; namely, a content page that lists the products in the database and a master page that includes a Button control to double the prices.</span></span>

## <a name="step-1-displaying-products-in-a-content-page"></a><span data-ttu-id="40ed8-133">手順 1: コンテンツのページで製品を表示します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-133">Step 1: Displaying Products in a Content Page</span></span>

<span data-ttu-id="40ed8-134">最初の注文のビジネスでは、Northwind データベースから製品を一覧表示されたコンテンツ ページを作成します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-134">Our first order of business is to create a content page that lists the products from the Northwind database.</span></span> <span data-ttu-id="40ed8-135">(前のチュートリアルでは、プロジェクトに Northwind データベースを追加しました[*コンテンツ ページからマスター ページと対話する*](interacting-with-the-master-page-from-the-content-page-cs.md))。新しい ASP.NET ページを追加して、開始、`~/Admin`という名前のフォルダー`Products.aspx`を確実にそれをバインドに、`Site.master`マスター ページ。</span><span class="sxs-lookup"><span data-stu-id="40ed8-135">(We added the Northwind database to the project in the preceding tutorial, [*Interacting with the Master Page from the Content Page*](interacting-with-the-master-page-from-the-content-page-cs.md).) Start by adding a new ASP.NET page to the `~/Admin` folder named `Products.aspx`, making sure to bind it to the `Site.master` master page.</span></span> <span data-ttu-id="40ed8-136">図 1 は、このページは、web サイトに追加した後、ソリューション エクスプ ローラーを示します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-136">Figure 1 shows the Solution Explorer after this page has been added to the website.</span></span>


<span data-ttu-id="40ed8-137">[![Admin フォルダーに新しい ASP.NET ページを追加します。](interacting-with-the-content-page-from-the-master-page-cs/_static/image2.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="40ed8-137">[![Add a New ASP.NET Page to the Admin Folder](interacting-with-the-content-page-from-the-master-page-cs/_static/image2.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image1.png)</span></span>

<span data-ttu-id="40ed8-138">**図 01**: に新しい ASP.NET ページの追加、`Admin`フォルダー ([フルサイズの画像を表示する をクリックします](interacting-with-the-content-page-from-the-master-page-cs/_static/image3.png))。</span><span class="sxs-lookup"><span data-stu-id="40ed8-138">**Figure 01**: Add a New ASP.NET Page to the `Admin` Folder ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image3.png))</span></span>


<span data-ttu-id="40ed8-139">そのことを思い出してください、 [*マスター ページのタイトル、メタ タグ、およびその他の HTML ヘッダーを指定する*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-cs.md)という名前のカスタム ベース ページ クラスを作成したチュートリアル`BasePage`でない場合は、ページのタイトルを生成します。明示的に設定します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-139">Recall that in the [*Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page*](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-cs.md) tutorial we created a custom base page class named `BasePage` that generates the page's title if it is not explicitly set.</span></span> <span data-ttu-id="40ed8-140">移動して、`Products.aspx`ページの分離コード クラスし、派生させる`BasePage`(の代わりにから`System.Web.UI.Page`)。</span><span class="sxs-lookup"><span data-stu-id="40ed8-140">Go to the `Products.aspx` page's code-behind class and have it derive from `BasePage` (instead of from `System.Web.UI.Page`).</span></span>

<span data-ttu-id="40ed8-141">最後に、更新、`Web.sitemap`このレッスンのエントリを追加するファイル。</span><span class="sxs-lookup"><span data-stu-id="40ed8-141">Finally, update the `Web.sitemap` file to include an entry for this lesson.</span></span> <span data-ttu-id="40ed8-142">下に次のマークアップを追加、`<siteMapNode>`コンテンツをマスター ページの相互作用のレッスン。</span><span class="sxs-lookup"><span data-stu-id="40ed8-142">Add the following markup beneath the `<siteMapNode>` for the Content to Master Page Interaction lesson:</span></span>


[!code-xml[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample1.xml)]

<span data-ttu-id="40ed8-143">この追加`<siteMapNode>`要素は、レッスンに反映されます (図 5 参照) を一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-143">The addition of this `<siteMapNode>` element is reflected in the Lessons list (see Figure 5).</span></span>

<span data-ttu-id="40ed8-144">戻り`Products.aspx`します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-144">Return to `Products.aspx`.</span></span> <span data-ttu-id="40ed8-145">コンテンツ コントロールで`MainContent`GridView コントロールを追加し、名前、`ProductsGrid`します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-145">In the Content control for `MainContent`, add a GridView control and name it `ProductsGrid`.</span></span> <span data-ttu-id="40ed8-146">GridView をという名前の新しい SqlDataSource コントロールにバインド`ProductsDataSource`します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-146">Bind the GridView to a new SqlDataSource control named `ProductsDataSource`.</span></span>


<span data-ttu-id="40ed8-147">[![GridView を新しい SqlDataSource コントロールにバインドします。](interacting-with-the-content-page-from-the-master-page-cs/_static/image5.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="40ed8-147">[![Bind the GridView to a New SqlDataSource Control](interacting-with-the-content-page-from-the-master-page-cs/_static/image5.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image4.png)</span></span>

<span data-ttu-id="40ed8-148">**図 02**: 新しい SqlDataSource コントロールを GridView にバインド ([フルサイズの画像を表示する をクリックします](interacting-with-the-content-page-from-the-master-page-cs/_static/image6.png))。</span><span class="sxs-lookup"><span data-stu-id="40ed8-148">**Figure 02**: Bind the GridView to a New SqlDataSource Control  ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image6.png))</span></span>


<span data-ttu-id="40ed8-149">ウィザードは、Northwind データベースを使用するように構成します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-149">Configure the wizard so that it uses the Northwind database.</span></span> <span data-ttu-id="40ed8-150">かどうかは、前のチュートリアルを実行して、名前付き接続文字列が必要`NorthwindConnectionString`で`Web.config`します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-150">If you worked through the previous tutorial then you should already have a connection string named `NorthwindConnectionString` in `Web.config`.</span></span> <span data-ttu-id="40ed8-151">図 3 に示すように、この接続文字列をドロップダウン リストから選択します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-151">Choose this connection string from the drop-down list, as shown in Figure 3.</span></span>


<span data-ttu-id="40ed8-152">[![Northwind データベースを使用する SqlDataSource を構成します。](interacting-with-the-content-page-from-the-master-page-cs/_static/image8.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="40ed8-152">[![Configure the SqlDataSource to Use the Northwind Database](interacting-with-the-content-page-from-the-master-page-cs/_static/image8.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image7.png)</span></span>

<span data-ttu-id="40ed8-153">**図 03**: Northwind データベースを使用する SqlDataSource の構成 ([フルサイズの画像を表示する をクリックします](interacting-with-the-content-page-from-the-master-page-cs/_static/image9.png))。</span><span class="sxs-lookup"><span data-stu-id="40ed8-153">**Figure 03**: Configure the SqlDataSource to Use the Northwind Database  ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image9.png))</span></span>


<span data-ttu-id="40ed8-154">データ ソース コントロールを次に、指定`SELECT`ステートメント、Products テーブルのドロップダウン リストから選択し、返すことによって、`ProductName`と`UnitPrice`列 (図 4 参照)。</span><span class="sxs-lookup"><span data-stu-id="40ed8-154">Next, specify the data source control's `SELECT` statement by choosing the Products table from the drop-down list and returning the `ProductName` and `UnitPrice` columns (see Figure 4).</span></span> <span data-ttu-id="40ed8-155">[次へ] をクリックし、データ ソースの構成ウィザードを完了し、[完了] します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-155">Click Next and then Finish to complete the Configure Data Source wizard.</span></span>


<span data-ttu-id="40ed8-156">[![Products テーブルから、ProductName と UnitPrice フィールドを返す](interacting-with-the-content-page-from-the-master-page-cs/_static/image11.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="40ed8-156">[![Return the ProductName and UnitPrice Fields from the Products Table](interacting-with-the-content-page-from-the-master-page-cs/_static/image11.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image10.png)</span></span>

<span data-ttu-id="40ed8-157">**図 04**: 返す、`ProductName`と`UnitPrice`フィールドから、`Products`テーブル ([フルサイズの画像を表示する をクリックします](interacting-with-the-content-page-from-the-master-page-cs/_static/image12.png))。</span><span class="sxs-lookup"><span data-stu-id="40ed8-157">**Figure 04**: Return the `ProductName` and `UnitPrice` Fields from the `Products` Table  ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image12.png))</span></span>


<span data-ttu-id="40ed8-158">GridView を ObjectDataSource にバインドされているユーザーのブラウザーでページ上の空白の領域でどのマークアップもレンダリングしません。</span><span class="sxs-lookup"><span data-stu-id="40ed8-158">That's all there is to it!</span></span> <span data-ttu-id="40ed8-159">ウィザードの完了後は、Visual Studio は、GridView が SqlDataSource コントロールによって返される 2 つのフィールドをミラー化するに 2 つの BoundFields を追加します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-159">After completing the wizard Visual Studio adds two BoundFields to the GridView to mirror the two fields returned by the SqlDataSource control.</span></span> <span data-ttu-id="40ed8-160">GridView と SqlDataSource コントロールのマークアップに従います。</span><span class="sxs-lookup"><span data-stu-id="40ed8-160">The GridView and SqlDataSource controls' markup follows.</span></span> <span data-ttu-id="40ed8-161">図 5 は、ブラウザーで表示した場合の結果を示します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-161">Figure 5 shows the results when viewed through a browser.</span></span>


[!code-aspx[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample2.aspx)]


<span data-ttu-id="40ed8-162">[![各製品とその価格は、GridView で表示されます。](interacting-with-the-content-page-from-the-master-page-cs/_static/image14.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="40ed8-162">[![Each Product and its Price is Listed in the GridView](interacting-with-the-content-page-from-the-master-page-cs/_static/image14.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image13.png)</span></span>

<span data-ttu-id="40ed8-163">**図 05**: 各製品とその価格は、GridView で表示されます ([フルサイズの画像を表示する をクリックします](interacting-with-the-content-page-from-the-master-page-cs/_static/image15.png))。</span><span class="sxs-lookup"><span data-stu-id="40ed8-163">**Figure 05**: Each Product and its Price is Listed in the GridView  ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image15.png))</span></span>


> [!NOTE]
> <span data-ttu-id="40ed8-164">自由に、GridView の外観をクリーンアップできます。</span><span class="sxs-lookup"><span data-stu-id="40ed8-164">Feel free to clean up the appearance of the GridView.</span></span> <span data-ttu-id="40ed8-165">通貨として表示される UnitPrice の値を書式設定して、背景色とフォントを使用して、グリッドの外観を改善するいくつかの候補が含まれます。</span><span class="sxs-lookup"><span data-stu-id="40ed8-165">Some suggestions include formatting the displayed UnitPrice value as a currency and using background colors and fonts to improve the grid's appearance.</span></span> <span data-ttu-id="40ed8-166">表示して、ASP.NET でのデータの書式設定の詳細についてを参照してください、[チュートリアル シリーズのデータの操作](../../data-access/index.md)します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-166">For more information on displaying and formatting data in ASP.NET, refer to my [Working with Data tutorial series](../../data-access/index.md).</span></span>


## <a name="step-2-adding-a-double-prices-button-to-the-master-page"></a><span data-ttu-id="40ed8-167">手順 2: マスター ページへの二重価格ボタンの追加</span><span class="sxs-lookup"><span data-stu-id="40ed8-167">Step 2: Adding a Double Prices Button to the Master Page</span></span>

<span data-ttu-id="40ed8-168">次のタスクでは、マスターに Button Web コントロールでは追加するページで、クリックすると、倍精度浮動小数点、データベース内のすべての製品の価格です。</span><span class="sxs-lookup"><span data-stu-id="40ed8-168">Our next task is to add a Button Web control to the master page that, when clicked, will double the price of all products in the database.</span></span> <span data-ttu-id="40ed8-169">開く、`Site.master`マスター ページと、デザイナーの下に配置するのには、ツールボックスからボタンをドラッグ、 `RecentProductsDataSource` SqlDataSource コントロールの前のチュートリアルで追加しました。</span><span class="sxs-lookup"><span data-stu-id="40ed8-169">Open the `Site.master` master page and drag a Button from the Toolbox onto the Designer, placing it beneath the `RecentProductsDataSource` SqlDataSource control we added in the previous tutorial.</span></span> <span data-ttu-id="40ed8-170">ボタンの設定`ID`プロパティを`DoublePrice`とその`Text`「二重製品価格」プロパティです。</span><span class="sxs-lookup"><span data-stu-id="40ed8-170">Set the Button's `ID` property to `DoublePrice` and its `Text` property to "Double Product Prices".</span></span>

<span data-ttu-id="40ed8-171">次に、その名前を付け、マスター ページに、SqlDataSource コントロールを追加`DoublePricesDataSource`します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-171">Next, add a SqlDataSource control to the master page, naming it `DoublePricesDataSource`.</span></span> <span data-ttu-id="40ed8-172">実行に使用されるこの SqlDataSource、`UPDATE`ステートメントのすべての価格の 2 倍にします。</span><span class="sxs-lookup"><span data-stu-id="40ed8-172">This SqlDataSource will be used to execute the `UPDATE` statement to double all prices.</span></span> <span data-ttu-id="40ed8-173">具体的には、設定する必要があります、`ConnectionString`と`UpdateCommand`を適切な接続文字列プロパティと`UPDATE`ステートメント。</span><span class="sxs-lookup"><span data-stu-id="40ed8-173">Specifically, we need to set its `ConnectionString` and `UpdateCommand` properties to the appropriate connection string and `UPDATE` statement.</span></span> <span data-ttu-id="40ed8-174">この SqlDataSource コントロールを呼び出す必要がありますし、`Update`メソッドと、`DoublePrice`ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="40ed8-174">Then we need to call this SqlDataSource control's `Update` method when the `DoublePrice` Button is clicked.</span></span> <span data-ttu-id="40ed8-175">設定する、`ConnectionString`と`UpdateCommand`プロパティ、SqlDataSource コントロールを選択し、[プロパティ] ウィンドウに移動します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-175">To set the `ConnectionString` and `UpdateCommand` properties, select the SqlDataSource control and then go to the Properties window.</span></span> <span data-ttu-id="40ed8-176">`ConnectionString`プロパティ リストに既に格納されているこれらの接続文字列`Web.config`をドロップダウン リストで選択、`NorthwindConnectionString`図 6 に示すようにオプションします。</span><span class="sxs-lookup"><span data-stu-id="40ed8-176">The `ConnectionString` property lists those connection strings already stored in `Web.config` in a drop-down list; choose the `NorthwindConnectionString` option as shown in Figure 6.</span></span>


<span data-ttu-id="40ed8-177">[![SqlDataSource、NorthwindConnectionString を使用する構成します。](interacting-with-the-content-page-from-the-master-page-cs/_static/image17.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="40ed8-177">[![Configure the SqlDataSource to Use the NorthwindConnectionString](interacting-with-the-content-page-from-the-master-page-cs/_static/image17.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image16.png)</span></span>

<span data-ttu-id="40ed8-178">**図 06**: 構成に使用する SqlDataSource、 `NorthwindConnectionString` ([フルサイズの画像を表示する をクリックします](interacting-with-the-content-page-from-the-master-page-cs/_static/image18.png))。</span><span class="sxs-lookup"><span data-stu-id="40ed8-178">**Figure 06**: Configure the SqlDataSource to Use the `NorthwindConnectionString` ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image18.png))</span></span>


<span data-ttu-id="40ed8-179">設定する、`UpdateCommand`プロパティ、プロパティ ウィンドウで、UpdateQuery オプションを検索します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-179">To set the `UpdateCommand` property, locate the UpdateQuery option in the Properties window.</span></span> <span data-ttu-id="40ed8-180">選択した場合、このプロパティで省略記号 [;] ボタンを表示します。図 7 に示すようにコマンドおよびパラメーターのエディター ダイアログ ボックスを表示するには、このボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="40ed8-180">This property, when selected, displays a button with ellipses; click this button to display the Command and Parameter Editor dialog box shown in Figure 7.</span></span> <span data-ttu-id="40ed8-181">次に入力して`UPDATE`ステートメント ダイアログ ボックスのテキスト ボックスに。</span><span class="sxs-lookup"><span data-stu-id="40ed8-181">Type the following `UPDATE` statement into the dialog box's textbox:</span></span>


[!code-sql[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample3.sql)]

<span data-ttu-id="40ed8-182">実行すると、このステートメントが 2 倍、`UnitPrice`内の各レコードの値、`Products`テーブル。</span><span class="sxs-lookup"><span data-stu-id="40ed8-182">This statement, when executed, will double the `UnitPrice` value for each record in the `Products` table.</span></span>


<span data-ttu-id="40ed8-183">[![SqlDataSource の UpdateCommand プロパティを設定します。](interacting-with-the-content-page-from-the-master-page-cs/_static/image20.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="40ed8-183">[![Set SqlDataSource's UpdateCommand Property](interacting-with-the-content-page-from-the-master-page-cs/_static/image20.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image19.png)</span></span>

<span data-ttu-id="40ed8-184">**図 07**: 設定 SqlDataSource の`UpdateCommand`プロパティ ([フルサイズの画像を表示する をクリックします](interacting-with-the-content-page-from-the-master-page-cs/_static/image21.png))。</span><span class="sxs-lookup"><span data-stu-id="40ed8-184">**Figure 07**: Set SqlDataSource's `UpdateCommand` Property  ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image21.png))</span></span>


<span data-ttu-id="40ed8-185">これらのプロパティを設定した後に、ボタンをクリックし、SqlDataSource コントロールの宣言型マークアップは、次のようなになります。</span><span class="sxs-lookup"><span data-stu-id="40ed8-185">After setting these properties, your Button and SqlDataSource controls' declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample4.aspx)]

<span data-ttu-id="40ed8-186">残っているを呼び出すその`Update`メソッドと、`DoublePrice`ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="40ed8-186">All that remains is to call its `Update` method when the `DoublePrice` Button is clicked.</span></span> <span data-ttu-id="40ed8-187">作成、`Click`のイベント ハンドラー、`DoublePrice`ボタンをクリックし、次のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-187">Create a `Click` event handler for the `DoublePrice` Button and add the following code:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample5.cs)]

<span data-ttu-id="40ed8-188">この機能をテストするを参照してください。、`~/Admin/Products.aspx`ページの手順 1. で作成し、"Double 製品価格"ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="40ed8-188">To test this functionality, visit the `~/Admin/Products.aspx` page we created in Step 1 and click the "Double Product Prices" button.</span></span> <span data-ttu-id="40ed8-189">ポストバックが発生するボタンをクリックし、実行、`DoublePrice`ボタンの`Click`イベント ハンドラー、すべての製品の価格を倍増します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-189">Clicking the button causes a postback and executes the `DoublePrice` Button's `Click` event handler, doubling the prices of all products.</span></span> <span data-ttu-id="40ed8-190">ページが再表示し、マークアップが返され、ブラウザーに再表示されます。</span><span class="sxs-lookup"><span data-stu-id="40ed8-190">The page is then re-rendered and the markup is returned and re-displayed in the browser.</span></span> <span data-ttu-id="40ed8-191">ただし、コンテンツ ページで、GridView は、ボタンがクリックされた「二重製品価格」の前に、同じ価格が一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-191">The GridView in the content page, however, lists the same prices as before the "Double Product Prices" button was clicked.</span></span> <span data-ttu-id="40ed8-192">これは、GridView に最初に読み込まれたデータがあるその状態をビューステートに格納されるため、それ以外の場合に指示がない限り、ポストバックでは読み込まれませんので。</span><span class="sxs-lookup"><span data-stu-id="40ed8-192">This is because the data initially loaded in the GridView had its state stored in view state, so it's not reloaded on postbacks unless instructed otherwise.</span></span> <span data-ttu-id="40ed8-193">別のページにアクセスし、後に戻るかどうか、`~/Admin/Products.aspx`ページが更新された価格が表示されます。</span><span class="sxs-lookup"><span data-stu-id="40ed8-193">If you visit a different page and then return to the `~/Admin/Products.aspx` page you'll see the updated prices.</span></span>

## <a name="step-3-raising-an-event-when-the-prices-are-doubled"></a><span data-ttu-id="40ed8-194">手順 3: は二重に発生し、イベント時の価格</span><span class="sxs-lookup"><span data-stu-id="40ed8-194">Step 3: Raising an Event When the Prices are Doubled</span></span>

<span data-ttu-id="40ed8-195">に GridView、`~/Admin/Products.aspx`ページはすぐに反映されませんが価格の 2 倍、ユーザー数は当然と考えが、「Double 製品価格」ボタンをクリックしなかったことや、実行できませんでした。</span><span class="sxs-lookup"><span data-stu-id="40ed8-195">Because the GridView in the `~/Admin/Products.aspx` page does not immediately reflect the price doubling, a user may understandably think that they did not click the "Double Product Prices" button, or that it didn't work.</span></span> <span data-ttu-id="40ed8-196">しようとするかもしれません、ボタンをクリックすると時間、繰り返し価格を倍増さらにいくつか。</span><span class="sxs-lookup"><span data-stu-id="40ed8-196">They may try clicking the button a few more times, doubling the prices again and again.</span></span> <span data-ttu-id="40ed8-197">コンテンツで、グリッドする必要がありますこれを解決するには、ページは、これらは 2 倍にした直後に新しい料金を表示します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-197">To fix this we need to have the grid in the content page display the new prices immediately after they are doubled.</span></span>

<span data-ttu-id="40ed8-198">このチュートリアルで前述したよう、ユーザーがクリックされるたびに、マスター ページでイベントを発生させる必要があります、`DoublePrice`ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="40ed8-198">As discussed earlier in this tutorial, we need to raise an event in the master page whenever the user clicks the `DoublePrice` Button.</span></span> <span data-ttu-id="40ed8-199">イベントは、別に一連の興味深いが発生したその他のクラス (イベント サブスクライバー) を通知するには、1 つのクラス (イベント パブリッシャー) の方法です。</span><span class="sxs-lookup"><span data-stu-id="40ed8-199">An event is a way for one class (an event publisher) to notify another a set of other classes (the event subscribers) that something interesting has occurred.</span></span> <span data-ttu-id="40ed8-200">この例でマスター ページは、イベント パブリッシャーです。これらのコンテンツの場合を考慮するページ、`DoublePrice`ボタンがクリックされた、サブスクライブしています。</span><span class="sxs-lookup"><span data-stu-id="40ed8-200">In this example, the master page is the event publisher; those content pages that care about when the `DoublePrice` Button is clicked are the subscribers.</span></span>

<span data-ttu-id="40ed8-201">クラスが作成してイベントにサブスクライブ、*イベント ハンドラー*、発生するイベントへの応答で実行されるメソッドであります。</span><span class="sxs-lookup"><span data-stu-id="40ed8-201">A class subscribes to an event by creating an *event handler*, which is a method that is executed in response to the event being raised.</span></span> <span data-ttu-id="40ed8-202">パブリッシャーは、自分で定義することで発生させるイベントを定義、*イベント デリゲート*します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-202">The publisher defines the events he raises by defining an *event delegate*.</span></span> <span data-ttu-id="40ed8-203">イベントのデリゲートには、どのような入力パラメーターが、イベント ハンドラーに同意する必要がありますを指定します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-203">The event delegate specifies what input parameters the event handler must accept.</span></span> <span data-ttu-id="40ed8-204">.NET Framework で、イベント デリゲートがない任意の値を返すし、2 つの入力パラメーターをそのまま使用しないでください。</span><span class="sxs-lookup"><span data-stu-id="40ed8-204">In the .NET Framework, event delegates do not return any value and accept two input parameters:</span></span>

- <span data-ttu-id="40ed8-205">`Object`、イベント ソースを識別します、</span><span class="sxs-lookup"><span data-stu-id="40ed8-205">An `Object`, which identifies the event source, and</span></span>
- <span data-ttu-id="40ed8-206">派生したクラス `System.EventArgs`</span><span class="sxs-lookup"><span data-stu-id="40ed8-206">A class derived from `System.EventArgs`</span></span>

<span data-ttu-id="40ed8-207">イベント ハンドラーに渡される 2 番目のパラメーターは、イベントに関する追加情報を含めることができます。</span><span class="sxs-lookup"><span data-stu-id="40ed8-207">The second parameter passed to an event handler can include additional information about the event.</span></span> <span data-ttu-id="40ed8-208">基本の中に`EventArgs`クラスはない情報を渡す、.NET Framework には、多数拡張クラスにはが含まれています。 `EventArgs` encompass の追加のプロパティとします。</span><span class="sxs-lookup"><span data-stu-id="40ed8-208">While the base `EventArgs` class does not pass along any information, the .NET Framework includes a number of classes that extend `EventArgs` and encompass additional properties.</span></span> <span data-ttu-id="40ed8-209">たとえば、`CommandEventArgs`インスタンスに応答するイベント ハンドラーに渡されます、`Command`イベント、2 つの情報プロパティが含まれています:`CommandArgument`と`CommandName`します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-209">For example, a `CommandEventArgs` instance is passed to event handlers that respond to the `Command` event, and includes two informational properties: `CommandArgument` and `CommandName`.</span></span>

> [!NOTE]
> <span data-ttu-id="40ed8-210">発生させる、およびイベントを処理の作成の詳細については、の参照[イベントとデリゲート](https://msdn.microsoft.com/library/17sde2xt.aspx)と[イベント デリゲートで単純な英語](http://www.codeproject.com/KB/cs/eventdelegates.aspx)します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-210">For more information on creating, raising, and handling events, see [Events and Delegates](https://msdn.microsoft.com/library/17sde2xt.aspx) and [Event Delegates in Simple English](http://www.codeproject.com/KB/cs/eventdelegates.aspx).</span></span>


<span data-ttu-id="40ed8-211">定義には、イベントは、次の構文を使用します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-211">To define an event use the following syntax:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample6.cs)]

<span data-ttu-id="40ed8-212">のみ、[コンテンツ] ページをユーザーがクリックされたときにアラートを生成する必要がありますので、`DoublePrice`ボタンしその他の追加情報を渡す必要はありません、イベント デリゲートを使用できます`EventHandler`、として 2 番目のオペランドを受け取るイベント ハンドラーを定義します。パラメーターの型のオブジェクト`System.EventArgs`します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-212">Because we only need to alert the content page when the user has clicked the `DoublePrice` Button and do not need to pass along any other additional information, we can use the event delegate `EventHandler`, which defines an event handler that accepts as its second parameter an object of type `System.EventArgs`.</span></span> <span data-ttu-id="40ed8-213">マスター ページで、イベントを作成するには、マスター ページの分離コード クラスに次のコード行を追加します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-213">To create the event in the master page, add the following line of code to the master page's code-behind class:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample7.cs)]

<span data-ttu-id="40ed8-214">上記のコードは、という名前のマスター ページにパブリック イベントを追加します`PricesDoubled`します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-214">The above code adds a public event to the master page named `PricesDoubled`.</span></span> <span data-ttu-id="40ed8-215">これで、価格が 2 倍にした後は、このイベントを発生させる必要があります。</span><span class="sxs-lookup"><span data-stu-id="40ed8-215">We now need to raise this event after the prices have been doubled.</span></span> <span data-ttu-id="40ed8-216">イベントを発生させるには、次の構文を使用します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-216">To raise an event use the following syntax:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample8.cs)]

<span data-ttu-id="40ed8-217">場所*送信者*と*eventArgs*は、サブスクライバーのイベント ハンドラーに渡す値になります。</span><span class="sxs-lookup"><span data-stu-id="40ed8-217">Where *sender* and *eventArgs* are the values you want to pass to the subscriber's event handler.</span></span>

<span data-ttu-id="40ed8-218">更新プログラム、 `DoublePrice` `Click`イベント ハンドラーを次のコード。</span><span class="sxs-lookup"><span data-stu-id="40ed8-218">Update the `DoublePrice` `Click` event handler with the following code:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample9.cs)]

<span data-ttu-id="40ed8-219">同様に、`Click`イベント ハンドラーを呼び出すことで起動、 `DoublePricesDataSource` SqlDataSource コントロールの`Update`メソッドすべての製品の価格の 2 倍にします。</span><span class="sxs-lookup"><span data-stu-id="40ed8-219">As before, the `Click` event handler starts by calling the `DoublePricesDataSource` SqlDataSource control's `Update` method to double the prices of all products.</span></span> <span data-ttu-id="40ed8-220">次のイベント ハンドラーに 2 つの追加機能があること。</span><span class="sxs-lookup"><span data-stu-id="40ed8-220">Following that there are two additions to the event handler.</span></span> <span data-ttu-id="40ed8-221">まず、 `RecentProducts` GridView のデータを更新します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-221">First, the `RecentProducts` GridView's data is refreshed.</span></span> <span data-ttu-id="40ed8-222">この GridView では、前のチュートリアルでは、マスター ページに追加されたし、最近追加した 5 つの製品を表示します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-222">This GridView was added to the master page in the preceding tutorial and displays the five most recently-added products.</span></span> <span data-ttu-id="40ed8-223">これら 5 つの製品だけ 2 倍に価格が表示されるように、このグリッドを更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="40ed8-223">We need to refresh this grid so that it shows the just-doubled prices for these five products.</span></span> <span data-ttu-id="40ed8-224">次に、`PricesDoubled`イベントが発生します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-224">Following that, the `PricesDoubled` event is raised.</span></span> <span data-ttu-id="40ed8-225">マスター ページ自体への参照 (`this`) は、イベント ソースと、空としてイベント ハンドラーに送信`EventArgs`オブジェクトは、イベントの引数として送信します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-225">A reference to the master page itself (`this`) is sent to the event handler as the event source and an empty `EventArgs` object is sent as the event arguments.</span></span>

## <a name="step-4-handling-the-event-in-the-content-page"></a><span data-ttu-id="40ed8-226">手順 4: [コンテンツ] ページでイベントを処理します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-226">Step 4: Handling the Event in the Content Page</span></span>

<span data-ttu-id="40ed8-227">この時点で、マスター ページを発生させますその`PricesDoubled`イベントたびに、`DoublePrice`ボタン コントロールがクリックされました。</span><span class="sxs-lookup"><span data-stu-id="40ed8-227">At this point the master page raises its `PricesDoubled` event whenever the `DoublePrice` Button control is clicked.</span></span> <span data-ttu-id="40ed8-228">ただし、これは半ばで-サブスクライバーにイベントを処理する必要があります。</span><span class="sxs-lookup"><span data-stu-id="40ed8-228">However, this is only half the battle - we still need to handle the event in the subscriber.</span></span> <span data-ttu-id="40ed8-229">これは、2 つの手順: イベント ハンドラーを作成し、イベントが発生したときにイベント ハンドラーが実行されるようにイベント配線のコードを追加します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-229">This involves two steps: creating the event handler and adding event wiring code so that when the event is raised the event handler is executed.</span></span>

<span data-ttu-id="40ed8-230">名前付きイベント ハンドラーを作成して開始`Master_PricesDoubled`します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-230">Start by creating an event handler named `Master_PricesDoubled`.</span></span> <span data-ttu-id="40ed8-231">定義したため、`PricesDoubled`マスター ページ内のイベントの種類のイベント ハンドラーの 2 つの入力パラメーターがある必要があります`Object`と`EventArgs`、それぞれします。</span><span class="sxs-lookup"><span data-stu-id="40ed8-231">Because of how we defined the `PricesDoubled` event in the master page the event handler's two input parameters must be of types `Object` and `EventArgs`, respectively.</span></span> <span data-ttu-id="40ed8-232">イベント ハンドラーの呼び出しで、 `ProductsGrid` GridView の`DataBind`グリッドにデータを再バインドするメソッド。</span><span class="sxs-lookup"><span data-stu-id="40ed8-232">In the event handler call the `ProductsGrid` GridView's `DataBind` method to rebind the data to the grid.</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample10.cs)]

<span data-ttu-id="40ed8-233">イベント ハンドラーのコードが完了しましたが、まだ、マスター ページのワイヤ`PricesDoubled`イベントをこのイベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="40ed8-233">The code for the event handler is complete but we've yet to wire the master page's `PricesDoubled` event to this event handler.</span></span> <span data-ttu-id="40ed8-234">サブスクライバーでは、次の構文を使用してイベント ハンドラーにイベントがその接続します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-234">The subscriber wires an event to an event handler via the following syntax:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample11.cs)]

<span data-ttu-id="40ed8-235">*パブリッシャー*イベントを提供するオブジェクトへの参照は、 *eventName*、および*methodName*に対応するシグネチャを持つサブスクライバーで定義されているイベント ハンドラーの名前を指定します*eventDelegate*します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-235">*publisher* is a reference to the object that offers the event *eventName*, and *methodName* is the name of the event handler defined in the subscriber that has a signature corresponding to the *eventDelegate*.</span></span> <span data-ttu-id="40ed8-236">つまり、イベントのデリゲートの場合は`EventHandler`、し*methodName*値を返さず、2 つの入力の型のパラメーターを受け取るサブスクライバーでのメソッドの名前を指定する必要があります`Object`と`EventArgs`、それぞれします。</span><span class="sxs-lookup"><span data-stu-id="40ed8-236">In other words, if the event delegate is `EventHandler`, then *methodName* must be the name of a method in the subscriber that does not return a value and accepts two input parameters of types `Object` and `EventArgs`, respectively.</span></span>

<span data-ttu-id="40ed8-237">このイベントの配線コードでは、以降のポストバックでは、最初のページ アクセスで実行する必要があり、イベントが発生する可能性がありますの前のページのライフ サイクルの時点で発生する必要があります。</span><span class="sxs-lookup"><span data-stu-id="40ed8-237">This event wiring code must be executed on the first page visit and subsequent postbacks and should occur at a point in the page lifecycle that precedes when the event may be raised.</span></span> <span data-ttu-id="40ed8-238">イベント接続コードを追加すると良いでは、PreInit ステージでは、ページのライフ サイクルの初期段階で発生します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-238">A good time to add event wiring code is in the PreInit stage, which occurs very early in the page lifecycle.</span></span>

<span data-ttu-id="40ed8-239">開いている`~/Admin/Products.aspx`を作成し、`Page_PreInit`イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="40ed8-239">Open `~/Admin/Products.aspx` and create a `Page_PreInit` event handler:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample12.cs)]

<span data-ttu-id="40ed8-240">この配線コードを完了するには、[コンテンツ] ページからマスター ページへのプログラムによる参照が必要です。</span><span class="sxs-lookup"><span data-stu-id="40ed8-240">In order to complete this wiring code we need a programmatic reference to the master page from the content page.</span></span> <span data-ttu-id="40ed8-241">前述の前のチュートリアルでは、これを行う 2 つの方法があります。</span><span class="sxs-lookup"><span data-stu-id="40ed8-241">As noted in the previous tutorial, there are two ways to do this:</span></span>

- <span data-ttu-id="40ed8-242">厳密に型をキャストすることによって`Page.Master`プロパティを適切なマスター ページの種類、または</span><span class="sxs-lookup"><span data-stu-id="40ed8-242">By casting the loosely-typed `Page.Master` property to the appropriate master page type, or</span></span>
- <span data-ttu-id="40ed8-243">追加することで、`@MasterType`ディレクティブで、`.aspx`ページと厳密に型指定を使用して`Master`プロパティ。</span><span class="sxs-lookup"><span data-stu-id="40ed8-243">By adding a `@MasterType` directive in the `.aspx` page and then using the strongly-typed `Master` property.</span></span>

<span data-ttu-id="40ed8-244">後者のアプローチを使用してみましょう。</span><span class="sxs-lookup"><span data-stu-id="40ed8-244">Let's use the latter approach.</span></span> <span data-ttu-id="40ed8-245">次の追加`@MasterType`ディレクティブを宣言型マークアップをページの上部に。</span><span class="sxs-lookup"><span data-stu-id="40ed8-245">Add the following `@MasterType` directive to the top of the page's declarative markup:</span></span>


[!code-aspx[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample13.aspx)]

<span data-ttu-id="40ed8-246">次のイベントの配線コードを追加し、`Page_PreInit`イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="40ed8-246">Then add the following event wiring code in the `Page_PreInit` event handler:</span></span>


[!code-csharp[Main](interacting-with-the-content-page-from-the-master-page-cs/samples/sample14.cs)]

<span data-ttu-id="40ed8-247">配置でこのコードでは、[コンテンツ] ページに GridView が更新されるたびに、`DoublePrice`ボタンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="40ed8-247">With this code in place, the GridView in the content page is refreshed whenever the `DoublePrice` Button is clicked.</span></span>

<span data-ttu-id="40ed8-248">図 8 と 9 は、この動作を示しています。</span><span class="sxs-lookup"><span data-stu-id="40ed8-248">Figures 8 and 9 illustrate this behavior.</span></span> <span data-ttu-id="40ed8-249">図 8 は、最初にアクセスする際、ページを示します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-249">Figure 8 shows the page when first visited.</span></span> <span data-ttu-id="40ed8-250">両方の値を価格に注意してください、 `RecentProducts` (マスター ページの左側の列) で GridView と`ProductsGrid`GridView (で、[コンテンツ] ページ)。</span><span class="sxs-lookup"><span data-stu-id="40ed8-250">Note that price values in both the `RecentProducts` GridView (in the left column of the master page) and the `ProductsGrid` GridView (in the content page).</span></span> <span data-ttu-id="40ed8-251">図 9 番組の直後に画面と同じ、`DoublePrice`ボタンがクリックしてされました。</span><span class="sxs-lookup"><span data-stu-id="40ed8-251">Figure 9 shows the same screen immediately after the `DoublePrice` Button has been clicked.</span></span> <span data-ttu-id="40ed8-252">ご覧のように、新しい料金が両方の Gridview で瞬時に反映されます。</span><span class="sxs-lookup"><span data-stu-id="40ed8-252">As you can see, the new prices are instantaneously reflected in both GridViews.</span></span>


<span data-ttu-id="40ed8-253">[![価格の初期値](interacting-with-the-content-page-from-the-master-page-cs/_static/image23.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="40ed8-253">[![The Initial Price Values](interacting-with-the-content-page-from-the-master-page-cs/_static/image23.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image22.png)</span></span>

<span data-ttu-id="40ed8-254">**図 08**: 初期価格値 ([フルサイズの画像を表示する をクリックします](interacting-with-the-content-page-from-the-master-page-cs/_static/image24.png))。</span><span class="sxs-lookup"><span data-stu-id="40ed8-254">**Figure 08**: The Initial Price Values  ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image24.png))</span></span>


<span data-ttu-id="40ed8-255">[![Just-Doubled 価格は、Gridview に表示されます。](interacting-with-the-content-page-from-the-master-page-cs/_static/image26.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="40ed8-255">[![The Just-Doubled Prices are Displayed in the GridViews](interacting-with-the-content-page-from-the-master-page-cs/_static/image26.png)](interacting-with-the-content-page-from-the-master-page-cs/_static/image25.png)</span></span>

<span data-ttu-id="40ed8-256">**図 09**: The Just-Doubled 価格は、Gridview に表示されます ([フルサイズの画像を表示する をクリックします](interacting-with-the-content-page-from-the-master-page-cs/_static/image27.png))。</span><span class="sxs-lookup"><span data-stu-id="40ed8-256">**Figure 09**: The Just-Doubled Prices are Displayed in the GridViews  ([Click to view full-size image](interacting-with-the-content-page-from-the-master-page-cs/_static/image27.png))</span></span>


## <a name="summary"></a><span data-ttu-id="40ed8-257">まとめ</span><span class="sxs-lookup"><span data-stu-id="40ed8-257">Summary</span></span>

<span data-ttu-id="40ed8-258">理想的には、マスター ページとそのコンテンツ ページは互いから完全に分離し、操作のレベルは必要ありません。</span><span class="sxs-lookup"><span data-stu-id="40ed8-258">Ideally, a master page and its content pages are completely separate from one another and require no level of interaction.</span></span> <span data-ttu-id="40ed8-259">ただし、マスター ページまたはマスター ページまたは [コンテンツ] ページから変更可能なデータを表示するコンテンツのページがある場合する必要がありますアラートの [コンテンツ] ページ (または、逆に) マスター ページが存在する、表示を更新できるようにデータが変更されたとき。</span><span class="sxs-lookup"><span data-stu-id="40ed8-259">However, if you have a master page or content page that displays data that can be modified from the master page or content page, then you may need to have the master page alert the content page (or vice-a-versa) when data is modified so that the display can be updated.</span></span> <span data-ttu-id="40ed8-260">前のチュートリアルではコンテンツ ページがそのマスター ページとプログラムでやり取りする方法を説明しましたこのチュートリアルでは、マスター ページの開始、相互作用する方法を説明しました。</span><span class="sxs-lookup"><span data-stu-id="40ed8-260">In the preceding tutorial we saw how to have a content page programmatically interact with its master page; in this tutorial we looked at how to have a master page initiate the interaction.</span></span>

<span data-ttu-id="40ed8-261">コンテンツとマスター ページの間のプログラムによる操作は、コンテンツまたはマスター ページから取得できます、発信元の依存対話パターンを使用します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-261">While programmatic interaction between a content and master page can originate from either the content or master page, the interaction pattern used depends on the origination.</span></span> <span data-ttu-id="40ed8-262">違いは、原因という事実にコンテンツ ページが単一のマスター ページですが多くのさまざまなコンテンツ ページにマスター ページを使用できます。</span><span class="sxs-lookup"><span data-stu-id="40ed8-262">The differences are due to the fact that a content page has a single master page, but a master page can have many different content pages.</span></span> <span data-ttu-id="40ed8-263">マスター ページのコンテンツ ページと直接対話するのではなくより優れたアプローチはいくつかの動作が発生したことを通知するイベントを発生させるマスター ページが存在するがします。</span><span class="sxs-lookup"><span data-stu-id="40ed8-263">Rather than having a master page directly interact with a content page, a better approach is to have the master page raise an event to signal that some action has taken place.</span></span> <span data-ttu-id="40ed8-264">アクションを考慮するそれらのコンテンツ ページには、イベント ハンドラーを作成できます。</span><span class="sxs-lookup"><span data-stu-id="40ed8-264">Those content pages that care about the action can create event handlers.</span></span>

<span data-ttu-id="40ed8-265">満足のプログラミングです。</span><span class="sxs-lookup"><span data-stu-id="40ed8-265">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="40ed8-266">関連項目</span><span class="sxs-lookup"><span data-stu-id="40ed8-266">Further Reading</span></span>

<span data-ttu-id="40ed8-267">このチュートリアルで説明したトピックの詳細については、次の情報を参照してください。</span><span class="sxs-lookup"><span data-stu-id="40ed8-267">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="40ed8-268">アクセスして、ASP.NET のデータの更新</span><span class="sxs-lookup"><span data-stu-id="40ed8-268">Accessing and Updating Data in ASP.NET</span></span>](http://aspnet.4guysfromrolla.com/articles/011106-1.aspx)
- [<span data-ttu-id="40ed8-269">イベントとデリゲート</span><span class="sxs-lookup"><span data-stu-id="40ed8-269">Events and Delegates</span></span>](https://msdn.microsoft.com/library/17sde2xt.aspx)
- [<span data-ttu-id="40ed8-270">コンテンツとマスター ページの情報を渡す</span><span class="sxs-lookup"><span data-stu-id="40ed8-270">Passing Information Between Content and Master Pages</span></span>](http://aspnet.4guysfromrolla.com/articles/013107-1.aspx)
- [<span data-ttu-id="40ed8-271">ASP.NET のチュートリアルでのデータの使用</span><span class="sxs-lookup"><span data-stu-id="40ed8-271">Working with Data in ASP.NET Tutorials</span></span>](../../data-access/index.md)

### <a name="about-the-author"></a><span data-ttu-id="40ed8-272">執筆者紹介</span><span class="sxs-lookup"><span data-stu-id="40ed8-272">About the Author</span></span>

<span data-ttu-id="40ed8-273">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)作成者の複数受け取りますブックと 4GuysFromRolla.com の創設者で、携わって Microsoft Web テクノロジ 1998 年からです。</span><span class="sxs-lookup"><span data-stu-id="40ed8-273">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="40ed8-274">Scott は、フリーのコンサルタント、トレーナー、およびライターとして動作します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-274">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="40ed8-275">最新の著書は[ *Sams 教える自分で ASP.NET 3.5 in 24 時間*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco)します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-275">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672329972/4guysfromrollaco).</span></span> <span data-ttu-id="40ed8-276">Scott に到達できる[ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com)または彼のブログ[ http://ScottOnWriting.NET](http://scottonwriting.net/)します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-276">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="40ed8-277">特別なに感謝します。</span><span class="sxs-lookup"><span data-stu-id="40ed8-277">Special Thanks To</span></span>

<span data-ttu-id="40ed8-278">このチュートリアル シリーズは、多くの便利なレビュー担当者によってレビューされました。</span><span class="sxs-lookup"><span data-stu-id="40ed8-278">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="40ed8-279">このチュートリアルでは、潜在顧客レビュー担当者が、Suchi 著。</span><span class="sxs-lookup"><span data-stu-id="40ed8-279">Lead reviewer for this tutorial was Suchi Banerjee.</span></span> <span data-ttu-id="40ed8-280">今後、MSDN の記事を確認したいですか。</span><span class="sxs-lookup"><span data-stu-id="40ed8-280">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="40ed8-281">場合は、筆者に [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="40ed8-281">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="40ed8-282">[前へ](interacting-with-the-master-page-from-the-content-page-cs.md)
> [次へ](master-pages-and-asp-net-ajax-cs.md)</span><span class="sxs-lookup"><span data-stu-id="40ed8-282">[Previous](interacting-with-the-master-page-from-the-content-page-cs.md)
[Next](master-pages-and-asp-net-ajax-cs.md)</span></span>
