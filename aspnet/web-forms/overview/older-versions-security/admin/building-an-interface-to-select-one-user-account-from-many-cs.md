---
uid: web-forms/overview/older-versions-security/admin/building-an-interface-to-select-one-user-account-from-many-cs
title: 多数 (c#) から 1 つのユーザー アカウントを選択するインターフェイスの構築 |Microsoft Docs
author: rick-anderson
description: このチュートリアルでは、ページング、フィルター可能の grid でのユーザー インターフェイスを作成します。 具体的には、ユーザー インターフェイスは、一連の Linkbutton ので構成されます.
ms.author: riande
ms.date: 04/01/2008
ms.assetid: 9e4e687c-b4ec-434f-a4ef-edb0b8f365e4
msc.legacyurl: /web-forms/overview/older-versions-security/admin/building-an-interface-to-select-one-user-account-from-many-cs
msc.type: authoredcontent
ms.openlocfilehash: 863ac36ae6a94ece841088db925c04deb3bf36c9
ms.sourcegitcommit: 45ac74e400f9f2b7dbded66297730f6f14a4eb25
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/16/2018
ms.locfileid: "41830322"
---
<a name="building-an-interface-to-select-one-user-account-from-many-c"></a><span data-ttu-id="50c0a-104">多数 (c#) から 1 つのユーザー アカウントを選択するインターフェイスの構築</span><span class="sxs-lookup"><span data-stu-id="50c0a-104">Building an Interface to Select One User Account from Many (C#)</span></span>
====================
<span data-ttu-id="50c0a-105">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="50c0a-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="50c0a-106">[コードのダウンロード](http://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/CS.12.zip)または[PDF のダウンロード](http://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/aspnet_tutorial12_SelectUser_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="50c0a-106">[Download Code](http://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/CS.12.zip) or [Download PDF](http://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/aspnet_tutorial12_SelectUser_cs.pdf)</span></span>

> <span data-ttu-id="50c0a-107">このチュートリアルでは、ページング、フィルター可能の grid でのユーザー インターフェイスを作成します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-107">In this tutorial we will build a user interface with a paged, filterable grid.</span></span> <span data-ttu-id="50c0a-108">具体的には、ユーザー インターフェイスは、ユーザー名と一致するユーザーを表示する GridView コントロールの開始文字に基づく結果をフィルター処理するためのある一連の構成されます。</span><span class="sxs-lookup"><span data-stu-id="50c0a-108">In particular, our user interface will consist of a series of LinkButtons for filtering the results based on the starting letter of the username, and a GridView control to show the matching users.</span></span> <span data-ttu-id="50c0a-109">まず、GridView でユーザー アカウントのすべてを一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-109">We'll start by listing all of the user accounts in a GridView.</span></span> <span data-ttu-id="50c0a-110">次に、手順 3 であるフィルターを追加します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-110">Then, in Step 3, we will add the filter LinkButtons.</span></span> <span data-ttu-id="50c0a-111">手順 4 がフィルター処理された結果をページングします。</span><span class="sxs-lookup"><span data-stu-id="50c0a-111">Step 4 looks at paging the filtered results.</span></span> <span data-ttu-id="50c0a-112">特定のユーザー アカウントの管理タスクを実行するは、後のチュートリアルから 4 までの手順 2 で構築されたインターフェイスを使用するされます。</span><span class="sxs-lookup"><span data-stu-id="50c0a-112">The interface constructed in Steps 2 through 4 will be used in the subsequent tutorials to perform administrative tasks for a particular user account.</span></span>


## <a name="introduction"></a><span data-ttu-id="50c0a-113">はじめに</span><span class="sxs-lookup"><span data-stu-id="50c0a-113">Introduction</span></span>

<span data-ttu-id="50c0a-114"><a id="_msoanchor_1"> </a> [*ユーザー ロールの割り当て*](../roles/assigning-roles-to-users-cs.md)チュートリアルでは、管理者がユーザーを選択し、自分のロールを管理する基本的なインターフェイスを作成しました。</span><span class="sxs-lookup"><span data-stu-id="50c0a-114">In the <a id="_msoanchor_1"></a>[*Assigning Roles to Users*](../roles/assigning-roles-to-users-cs.md) tutorial, we created a rudimentary interface for an administrator to select a user and manage her roles.</span></span> <span data-ttu-id="50c0a-115">具体的には、インターフェイスでは、すべてのユーザーのドロップダウン リストで、管理者が表示されます。</span><span class="sxs-lookup"><span data-stu-id="50c0a-115">Specifically, the interface presented the administrator with a drop-down list of all of the users.</span></span> <span data-ttu-id="50c0a-116">このようなインターフェイスはありますが、数十個ものユーザー アカウントします、ははるかに数百または数千のアカウントを持つサイトの場合に適しています。</span><span class="sxs-lookup"><span data-stu-id="50c0a-116">Such an interface is suitable when there are but a dozen or so user accounts, but is unwieldy for sites with hundreds or thousands of accounts.</span></span> <span data-ttu-id="50c0a-117">ページング、フィルター可能グリッドとは、大規模なユーザー ベースの web サイトの方が適切なユーザー インターフェイスです。</span><span class="sxs-lookup"><span data-stu-id="50c0a-117">A paged, filterable grid is more suitable user interface for websites with large user bases.</span></span>

<span data-ttu-id="50c0a-118">このチュートリアルでは、このようなユーザー インターフェイスを作成します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-118">In this tutorial we will build such a user interface.</span></span> <span data-ttu-id="50c0a-119">具体的には、ユーザー インターフェイスは、ユーザー名と一致するユーザーを表示する GridView コントロールの開始文字に基づく結果をフィルター処理するためのある一連の構成されます。</span><span class="sxs-lookup"><span data-stu-id="50c0a-119">In particular, our user interface will consist of a series of LinkButtons for filtering the results based on the starting letter of the username, and a GridView control to show the matching users.</span></span> <span data-ttu-id="50c0a-120">まず、GridView でユーザー アカウントのすべてを一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-120">We'll start by listing all of the user accounts in a GridView.</span></span> <span data-ttu-id="50c0a-121">次に、手順 3 であるフィルターを追加します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-121">Then, in Step 3, we will add the filter LinkButtons.</span></span> <span data-ttu-id="50c0a-122">手順 4 がフィルター処理された結果をページングします。</span><span class="sxs-lookup"><span data-stu-id="50c0a-122">Step 4 looks at paging the filtered results.</span></span> <span data-ttu-id="50c0a-123">特定のユーザー アカウントの管理タスクを実行するは、後のチュートリアルから 4 までの手順 2 で構築されたインターフェイスを使用するされます。</span><span class="sxs-lookup"><span data-stu-id="50c0a-123">The interface constructed in Steps 2 through 4 will be used in the subsequent tutorials to perform administrative tasks for a particular user account.</span></span>

<span data-ttu-id="50c0a-124">それでは、始めましょう!</span><span class="sxs-lookup"><span data-stu-id="50c0a-124">Let's get started!</span></span>

## <a name="step-1-adding-new-aspnet-pages"></a><span data-ttu-id="50c0a-125">手順 1: 新しい ASP.NET ページの追加</span><span class="sxs-lookup"><span data-stu-id="50c0a-125">Step 1: Adding New ASP.NET Pages</span></span>

<span data-ttu-id="50c0a-126">このチュートリアルで次の 2 つ検査さまざまな管理関連の機能と機能します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-126">In this tutorial and the next two we will be examining various administration-related functions and capabilities.</span></span> <span data-ttu-id="50c0a-127">一連のトピックでは、このチュートリアルで調査を実装するために ASP.NET ページを必要になります。</span><span class="sxs-lookup"><span data-stu-id="50c0a-127">We will need a series of ASP.NET pages to implement the topics examined throughout these tutorials.</span></span> <span data-ttu-id="50c0a-128">これらのページを作成して、サイト マップを更新してみましょう。</span><span class="sxs-lookup"><span data-stu-id="50c0a-128">Let's create these pages and update the site map.</span></span>

<span data-ttu-id="50c0a-129">という名前のプロジェクトで新しいフォルダーを作成して開始`Administration`します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-129">Start by creating a new folder in the project named `Administration`.</span></span> <span data-ttu-id="50c0a-130">次に、2 つの新しい ASP.NET ページを使用する各ページのリンク、フォルダーに追加、`Site.master`マスター ページ。</span><span class="sxs-lookup"><span data-stu-id="50c0a-130">Next, add two new ASP.NET pages to the folder, linking each page with the `Site.master` master page.</span></span> <span data-ttu-id="50c0a-131">ページの名前を付けます。</span><span class="sxs-lookup"><span data-stu-id="50c0a-131">Name the pages:</span></span>

- `ManageUsers.aspx`
- `UserInformation.aspx`

<span data-ttu-id="50c0a-132">2 つのページを web サイトのルート ディレクトリに追加することも:`ChangePassword.aspx`と`RecoverPassword.aspx`します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-132">Also add two pages to the website's root directory: `ChangePassword.aspx` and `RecoverPassword.aspx`.</span></span>

<span data-ttu-id="50c0a-133">これら 4 つのページが、マスター ページの ContentPlaceHolders ごとに 1 つ、2 つのコンテンツ コントロールがある必要があります、この時点では、:`MainContent`と`LoginContent`します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-133">These four pages should, at this point, have two Content controls, one for each of the master page's ContentPlaceHolders: `MainContent` and `LoginContent`.</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample1.aspx)]

<span data-ttu-id="50c0a-134">マスター ページの既定のマークアップを表示する、`LoginContent`これらのページのプレース ホルダーです。</span><span class="sxs-lookup"><span data-stu-id="50c0a-134">We want to show the master page's default markup for the `LoginContent` ContentPlaceHolder for these pages.</span></span> <span data-ttu-id="50c0a-135">そのため、宣言型マークアップを削除する、`Content2`コンテンツ コントロール。</span><span class="sxs-lookup"><span data-stu-id="50c0a-135">Therefore, remove the declarative markup for the `Content2` Content control.</span></span> <span data-ttu-id="50c0a-136">その後、ページのマークアップは、1 つだけのコンテンツ コントロールを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="50c0a-136">After doing so, the pages' markup should contain just one Content control.</span></span>

<span data-ttu-id="50c0a-137">ASP.NET ページで、`Administration`管理者のユーザー専用のフォルダーが対象としています。</span><span class="sxs-lookup"><span data-stu-id="50c0a-137">The ASP.NET pages in the `Administration` folder are intended solely for administrative users.</span></span> <span data-ttu-id="50c0a-138">システム管理者の役割を追加しました、 <a id="_msoanchor_2"> </a> [*ロールの管理の作成と*](../roles/creating-and-managing-roles-cs.md)チュートリアル; このロールにこれら 2 つのページへのアクセスを制限します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-138">We added an Administrators role to the system in the <a id="_msoanchor_2"></a>[*Creating and Managing Roles*](../roles/creating-and-managing-roles-cs.md) tutorial; restrict access to these two pages to this role.</span></span> <span data-ttu-id="50c0a-139">これを行うには、追加、`Web.config`ファイルを`Administration`フォルダーを構成して、`<authorization>`管理者ロールのユーザーを正直に言うと、他のすべてを拒否する要素。</span><span class="sxs-lookup"><span data-stu-id="50c0a-139">To accomplish this, add a `Web.config` file to the `Administration` folder and configure its `<authorization>` element to admit users in the Administrators role and to deny all others.</span></span>

[!code-xml[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample2.xml)]

<span data-ttu-id="50c0a-140">この時点で、プロジェクトのソリューション エクスプ ローラーのスクリーン ショット、図 1 に示すようなはずです。</span><span class="sxs-lookup"><span data-stu-id="50c0a-140">At this point your project's Solution Explorer should look similar to the screen shot shown in Figure 1.</span></span>


<span data-ttu-id="50c0a-141">[![4 つの新しいページと Web.config ファイルが web サイトに追加されました](building-an-interface-to-select-one-user-account-from-many-cs/_static/image2.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="50c0a-141">[![Four New Pages and a Web.config File Have Been Added to the Website](building-an-interface-to-select-one-user-account-from-many-cs/_static/image2.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image1.png)</span></span>

<span data-ttu-id="50c0a-142">**図 1**: 4 つの新しいページと`Web.config`ファイルは、web サイトに追加されている ([フルサイズの画像を表示する をクリックします](building-an-interface-to-select-one-user-account-from-many-cs/_static/image3.png))。</span><span class="sxs-lookup"><span data-stu-id="50c0a-142">**Figure 1**: Four New Pages and a `Web.config` File Have Been Added to the Website  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image3.png))</span></span>


<span data-ttu-id="50c0a-143">最後に、サイト マップを更新 (`Web.sitemap`) にエントリを含める、`ManageUsers.aspx`ページ。</span><span class="sxs-lookup"><span data-stu-id="50c0a-143">Finally, update the site map (`Web.sitemap`) to include an entry to the `ManageUsers.aspx` page.</span></span> <span data-ttu-id="50c0a-144">追加した後、次の XML、`<siteMapNode>`チュートリアルでは、ロールを追加しました。</span><span class="sxs-lookup"><span data-stu-id="50c0a-144">Add the following XML after the `<siteMapNode>` we added for the Roles tutorials.</span></span>

[!code-xml[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample3.xml)]

<span data-ttu-id="50c0a-145">更新サイト マップでは、ブラウザーを使用してサイトを参照してください。</span><span class="sxs-lookup"><span data-stu-id="50c0a-145">With the site map updated, visit the site through a browser.</span></span> <span data-ttu-id="50c0a-146">図 2 に示す、左側のナビゲーションには、管理のチュートリアルのアイテムが含まれます。</span><span class="sxs-lookup"><span data-stu-id="50c0a-146">As Figure 2 shows, the navigation on the left now includes items for the Administration tutorials.</span></span>


<span data-ttu-id="50c0a-147">[![サイト マップには、「ユーザーの管理ノードが含まれていますいます。](building-an-interface-to-select-one-user-account-from-many-cs/_static/image5.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="50c0a-147">[![The Site Map Includes a Node Titled User Administration](building-an-interface-to-select-one-user-account-from-many-cs/_static/image5.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image4.png)</span></span>

<span data-ttu-id="50c0a-148">**図 2**: サイト マップにはノードという名前のユーザー管理が含まれています ([フルサイズの画像を表示する をクリックします](building-an-interface-to-select-one-user-account-from-many-cs/_static/image6.png))。</span><span class="sxs-lookup"><span data-stu-id="50c0a-148">**Figure 2**: The Site Map Includes a Node Titled User Administration  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image6.png))</span></span>


## <a name="step-2-listing-all-user-accounts-in-a-gridview"></a><span data-ttu-id="50c0a-149">手順 2: GridView を内のすべてのユーザー アカウントを一覧表示します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-149">Step 2: Listing All User Accounts in a GridView</span></span>

<span data-ttu-id="50c0a-150">このチュートリアルでは、最終目標では、管理者が管理するユーザー アカウントを選択、ページング、フィルター可能グリッドを作成します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-150">Our end goal for this tutorial is to create a paged, filterable grid through which an administrator can select a user account to manage.</span></span> <span data-ttu-id="50c0a-151">一覧から始めましょう*すべて*GridView でのユーザー。</span><span class="sxs-lookup"><span data-stu-id="50c0a-151">Let's start by listing *all* users in a GridView.</span></span> <span data-ttu-id="50c0a-152">これが完了すると、フィルター処理とページング インターフェイスと機能を追加します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-152">Once this is complete, we will add the filtering and paging interfaces and functionality.</span></span>

<span data-ttu-id="50c0a-153">開く、`ManageUsers.aspx`ページで、`Administration`フォルダー、GridView では、追加の設定とその`ID`に`UserAccounts`します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-153">Open the `ManageUsers.aspx` page in the `Administration` folder and add a GridView, setting its `ID` to `UserAccounts`.</span></span> <span data-ttu-id="50c0a-154">GridView を使用して、一連のユーザー アカウントにバインドするコードを記述しています、すぐに、`Membership`クラスの`GetAllUsers`メソッド。</span><span class="sxs-lookup"><span data-stu-id="50c0a-154">In a moment, we will write code to bind the set of user accounts to the GridView using the `Membership` class's `GetAllUsers` method.</span></span> <span data-ttu-id="50c0a-155">前のチュートリアルで既に説明した、GetAllUsers メソッドを返します、`MembershipUserCollection`コレクションであるオブジェクトの`MembershipUser`オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="50c0a-155">As discussed in earlier tutorials, the GetAllUsers method returns a `MembershipUserCollection` object, which is a collection of `MembershipUser` objects.</span></span> <span data-ttu-id="50c0a-156">各`MembershipUser`コレクションにはなどのプロパティが含まれています。 `UserName`、 `Email`、`IsApproved`など。</span><span class="sxs-lookup"><span data-stu-id="50c0a-156">Each `MembershipUser` in the collection includes properties like `UserName`, `Email`, `IsApproved`, and so on.</span></span>

<span data-ttu-id="50c0a-157">GridView で目的のユーザー アカウントの情報を表示するために設定、GridView の`AutoGenerateColumns`プロパティを False の BoundFields を追加し、 `UserName`、 `Email`、および`Comment`プロパティとの CheckBoxFields、 `IsApproved`、`IsLockedOut`、および`IsOnline`プロパティ。</span><span class="sxs-lookup"><span data-stu-id="50c0a-157">In order to display the desired user account information in the GridView, set the GridView's `AutoGenerateColumns` property to False and add BoundFields for the `UserName`, `Email`, and `Comment` properties and CheckBoxFields for the `IsApproved`, `IsLockedOut`, and `IsOnline` properties.</span></span> <span data-ttu-id="50c0a-158">コントロールの宣言型マークアップまたはフィールド ダイアログ ボックスを使用して、この構成を適用できます。</span><span class="sxs-lookup"><span data-stu-id="50c0a-158">This configuration can be applied through the control's declarative markup or via the Fields dialog box.</span></span> <span data-ttu-id="50c0a-159">図 3 は、自動生成フィールド チェック ボックスがオフになっていると、BoundFields と CheckBoxFields が追加して構成した後に、フィールドのスクリーン ショットのダイアログ ボックスを示します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-159">Figure 3 shows a screen shot of the Fields dialog box after the Auto-generate fields checkbox has been unchecked and the BoundFields and CheckBoxFields have been added and configured.</span></span>


<span data-ttu-id="50c0a-160">[![GridView に 3 つ BoundFields と 3 つ CheckBoxFields を追加します。](building-an-interface-to-select-one-user-account-from-many-cs/_static/image8.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="50c0a-160">[![Add Three BoundFields and Three CheckBoxFields to the GridView](building-an-interface-to-select-one-user-account-from-many-cs/_static/image8.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image7.png)</span></span>

<span data-ttu-id="50c0a-161">**図 3**: 次の 3 つ BoundFields の追加と GridView に 3 つの CheckBoxFields ([フルサイズの画像を表示する をクリックします](building-an-interface-to-select-one-user-account-from-many-cs/_static/image9.png))。</span><span class="sxs-lookup"><span data-stu-id="50c0a-161">**Figure 3**: Add Three BoundFields and Three CheckBoxFields to the GridView  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image9.png))</span></span>


<span data-ttu-id="50c0a-162">GridView を構成した後、その宣言型マークアップが次のようなことを確認します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-162">After configuring your GridView, ensure that its declarative markup resembles the following:</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample4.aspx)]

<span data-ttu-id="50c0a-163">次に、ユーザー アカウントを GridView にバインドするコードを記述する必要があります。</span><span class="sxs-lookup"><span data-stu-id="50c0a-163">Next, we need to write code that binds the user accounts to the GridView.</span></span> <span data-ttu-id="50c0a-164">という名前のメソッドを作成する`BindUserAccounts`このタスクを実行してから呼び出して、`Page_Load`最初のページ アクセス時にイベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="50c0a-164">Create a method named `BindUserAccounts` to perform this task and then call it from the `Page_Load` event handler on the first page visit.</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample5.cs)]

<span data-ttu-id="50c0a-165">ブラウザーでページをテストする時間がかかります。</span><span class="sxs-lookup"><span data-stu-id="50c0a-165">Take a moment to test the page through a browser.</span></span> <span data-ttu-id="50c0a-166">図 4 に示すよう、 `UserAccounts` GridView がシステムにユーザー名、電子メール アドレス、およびすべてのユーザーの場合は、その他の関連するアカウント情報を一覧表示されます。</span><span class="sxs-lookup"><span data-stu-id="50c0a-166">As Figure 4 shows, the `UserAccounts` GridView lists the username, email address, and other pertinent account information for all users in the system.</span></span>


<span data-ttu-id="50c0a-167">[![ユーザーのアカウントは、gridview 一覧します。](building-an-interface-to-select-one-user-account-from-many-cs/_static/image11.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="50c0a-167">[![The User Accounts are Listed in the GridView](building-an-interface-to-select-one-user-account-from-many-cs/_static/image11.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image10.png)</span></span>

<span data-ttu-id="50c0a-168">**図 4**: GridView で、ユーザー アカウントが表示されている ([フルサイズの画像を表示する をクリックします](building-an-interface-to-select-one-user-account-from-many-cs/_static/image12.png))。</span><span class="sxs-lookup"><span data-stu-id="50c0a-168">**Figure 4**: The User Accounts are Listed in the GridView  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image12.png))</span></span>


## <a name="step-3-filtering-the-results-by-the-first-letter-of-the-username"></a><span data-ttu-id="50c0a-169">手順 3: ユーザー名の最初の文字で結果をフィルター処理</span><span class="sxs-lookup"><span data-stu-id="50c0a-169">Step 3: Filtering the Results by the First Letter of the Username</span></span>

<span data-ttu-id="50c0a-170">現在、 `UserAccounts` GridView 表示*すべて*のユーザー アカウント。</span><span class="sxs-lookup"><span data-stu-id="50c0a-170">Currently the `UserAccounts` GridView shows *all* of the user accounts.</span></span> <span data-ttu-id="50c0a-171">数百または何千ものユーザー アカウントの web サイトでは、そのユーザーが表示されているアカウントをすばやく縮小することが不可欠です。</span><span class="sxs-lookup"><span data-stu-id="50c0a-171">For websites with hundreds or thousands of user accounts, it is imperative that user be able to quickly pare down the displayed accounts.</span></span> <span data-ttu-id="50c0a-172">これは、Linkbutton をページにフィルターを追加することで実現できます。</span><span class="sxs-lookup"><span data-stu-id="50c0a-172">This can be accomplished by adding filtering LinkButtons to the page.</span></span> <span data-ttu-id="50c0a-173">27 Linkbutton をページに追加してみましょう。 アルファベットの各文字の 1 つの LinkButton と共にすべてという 1 つ。</span><span class="sxs-lookup"><span data-stu-id="50c0a-173">Let's add 27 LinkButtons to the page: one titled All along with one LinkButton for each letter of the alphabet.</span></span> <span data-ttu-id="50c0a-174">訪問者には、すべての LinkButton がクリックすると、GridView はすべてのユーザーに表示されます。</span><span class="sxs-lookup"><span data-stu-id="50c0a-174">If a visitor clicks the All LinkButton, the GridView will show all of the users.</span></span> <span data-ttu-id="50c0a-175">特定の文字をクリックすると、選択した文字から始まりますユーザー名を持つユーザーのみが表示されます。</span><span class="sxs-lookup"><span data-stu-id="50c0a-175">If they click a particular letter, only those users whose username starts with the selected letter will be displayed.</span></span>

<span data-ttu-id="50c0a-176">最初のタスクでは、27 LinkButton コントロールを追加します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-176">Our first task is to add the 27 LinkButton controls.</span></span> <span data-ttu-id="50c0a-177">ここでは、27 Linkbutton を作成する 1 つのオプションを一度に 1 つ。</span><span class="sxs-lookup"><span data-stu-id="50c0a-177">One option would be to create the 27 LinkButtons declaratively, one at a time.</span></span> <span data-ttu-id="50c0a-178">柔軟性の高いアプローチは、使用して、Repeater コントロールを使用する、 `ItemTemplate` linkbutton コントロールをレンダリングし、として Repeater にフィルター オプションをバインドする、`string`配列。</span><span class="sxs-lookup"><span data-stu-id="50c0a-178">A more flexible approach is to use a Repeater control with an `ItemTemplate` that renders a LinkButton and then binds the filtering options to the Repeater as a `string` array.</span></span>

<span data-ttu-id="50c0a-179">スタート ページの上部に、Repeater コントロールを追加することで、 `UserAccounts` GridView。</span><span class="sxs-lookup"><span data-stu-id="50c0a-179">Start by adding a Repeater control to the page above the `UserAccounts` GridView.</span></span> <span data-ttu-id="50c0a-180">設定、Repeater の`ID`プロパティを`FilteringUI`します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-180">Set the Repeater's `ID` property to `FilteringUI`.</span></span> <span data-ttu-id="50c0a-181">Repeater のテンプレートを構成するようにその`ItemTemplate`linkbutton コントロールをレンダリングが`Text`と`CommandName`プロパティ、現在の配列要素にバインドされます。</span><span class="sxs-lookup"><span data-stu-id="50c0a-181">Configure the Repeater's templates so that its `ItemTemplate` renders a LinkButton whose `Text` and `CommandName` properties are bound to the current array element.</span></span> <span data-ttu-id="50c0a-182">説明したように、 <a id="_msoanchor_3"> </a> [*ユーザー ロールの割り当て*](../roles/assigning-roles-to-users-cs.md)チュートリアルでは、これを使用して、`Container.DataItem`データ バインド構文。</span><span class="sxs-lookup"><span data-stu-id="50c0a-182">As we saw in the <a id="_msoanchor_3"></a>[*Assigning Roles to Users*](../roles/assigning-roles-to-users-cs.md) tutorial, this can be accomplished using the `Container.DataItem` databinding syntax.</span></span> <span data-ttu-id="50c0a-183">使用して、Repeater の`SeparatorTemplate`各リンクの間の垂直線を表示します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-183">Use the Repeater's `SeparatorTemplate` to display a vertical line between each link.</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample6.aspx)]

<span data-ttu-id="50c0a-184">この Repeater、目的のフィルター処理オプションを設定するには、という名前のメソッドを作成`BindFilteringUI`です。</span><span class="sxs-lookup"><span data-stu-id="50c0a-184">To populate this Repeater with the desired filtering options, create a method named `BindFilteringUI`.</span></span> <span data-ttu-id="50c0a-185">このメソッドを呼び出すことを確認する、`Page_Load`最初のページの読み込み時のイベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="50c0a-185">Be sure to call this method from the `Page_Load` event handler on the first page load.</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample7.cs)]

<span data-ttu-id="50c0a-186">このメソッド内の要素としてフィルター処理オプションを指定します、`string`配列`filterOptions`します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-186">This method specifies the filtering options as elements in the `string` array `filterOptions`.</span></span> <span data-ttu-id="50c0a-187">リピータが LinkButton を表示、配列内の各要素に対してその`Text`と`CommandName`配列要素の値に割り当てられたプロパティ。</span><span class="sxs-lookup"><span data-stu-id="50c0a-187">For each element in the array, the Repeater will render a LinkButton with its `Text` and `CommandName` properties assigned to the value of the array element.</span></span>

<span data-ttu-id="50c0a-188">図 5 は、`ManageUsers.aspx`ページをブラウザーで表示する場合。</span><span class="sxs-lookup"><span data-stu-id="50c0a-188">Figure 5 shows the `ManageUsers.aspx` page when viewed through a browser.</span></span>


<span data-ttu-id="50c0a-189">[![リピータが 27 のフィルタ リング Linkbutton を一覧表示します。](building-an-interface-to-select-one-user-account-from-many-cs/_static/image14.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="50c0a-189">[![The Repeater Lists 27 Filtering LinkButtons](building-an-interface-to-select-one-user-account-from-many-cs/_static/image14.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image13.png)</span></span>

<span data-ttu-id="50c0a-190">**図 5**:、Repeater を一覧表示 27 フィルター Linkbutton ([フルサイズの画像を表示する をクリックします](building-an-interface-to-select-one-user-account-from-many-cs/_static/image15.png))。</span><span class="sxs-lookup"><span data-stu-id="50c0a-190">**Figure 5**: The Repeater Lists 27 Filtering LinkButtons  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image15.png))</span></span>


> [!NOTE]
> <span data-ttu-id="50c0a-191">ユーザー名は、数字や句読点などの任意の文字で開始できます。</span><span class="sxs-lookup"><span data-stu-id="50c0a-191">Usernames may start with any character, including numbers and punctuation.</span></span> <span data-ttu-id="50c0a-192">これらのアカウントを表示するには、管理者はすべて LinkButton オプションを使用して、必要があります。</span><span class="sxs-lookup"><span data-stu-id="50c0a-192">In order to view these accounts, the administrator will have to use the All LinkButton option.</span></span> <span data-ttu-id="50c0a-193">または、LinkButton を返す数値で始まるすべてのユーザー アカウントを追加できます。</span><span class="sxs-lookup"><span data-stu-id="50c0a-193">Alternatively, you could add a LinkButton to return all user accounts that start with a number.</span></span> <span data-ttu-id="50c0a-194">ままを演習として、リーダーの。</span><span class="sxs-lookup"><span data-stu-id="50c0a-194">I leave this as an exercise for the reader.</span></span>


<span data-ttu-id="50c0a-195">ポストバックが発生するフィルターの Linkbutton をクリックすると、Repeater のさせ`ItemCommand`イベント、まだために、グリッド内の変更はありませんが、結果をフィルター処理するコードを記述します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-195">Clicking any of the filtering LinkButtons causes a postback and raises the Repeater's `ItemCommand` event, but there's no change in the grid because we've yet to write any code to filter the results.</span></span> <span data-ttu-id="50c0a-196">`Membership`クラスが含まれています、 [ `FindUsersByName`メソッド](https://technet.microsoft.com/library/system.web.security.membership.findusersbyname.aspx)ユーザー名を持つ指定した検索パターンに一致するユーザー アカウントを返します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-196">The `Membership` class includes a [`FindUsersByName` method](https://technet.microsoft.com/library/system.web.security.membership.findusersbyname.aspx) that returns those user accounts whose username matches a specified search pattern.</span></span> <span data-ttu-id="50c0a-197">このメソッドを使用しているユーザー名がで指定された文字で始まるには、これらのユーザー アカウントを取得することができます、`CommandName`フィルター選択された LinkButton がクリックされるのです。</span><span class="sxs-lookup"><span data-stu-id="50c0a-197">We can use this method to retrieve just those user accounts whose usernames start with the letter specified by the `CommandName` of the filtered LinkButton that was clicked.</span></span>

<span data-ttu-id="50c0a-198">更新することで開始、`ManageUser.aspx`ページの分離コード クラスという名前のプロパティが含まれるように`UsernameToMatch`します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-198">Start by updating the `ManageUser.aspx` page's code-behind class so that it includes a property named `UsernameToMatch`.</span></span> <span data-ttu-id="50c0a-199">このプロパティは、ポストバック間でユーザー名のフィルター文字列を永続化します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-199">This property persists the username filter string across postbacks:</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample8.cs)]

<span data-ttu-id="50c0a-200">`UsernameToMatch`プロパティに割り当てられている値が格納、 `ViewState` UsernameToMatch キーを使用してコレクション。</span><span class="sxs-lookup"><span data-stu-id="50c0a-200">The `UsernameToMatch` property stores its value it is assigned into the `ViewState` collection using the key UsernameToMatch.</span></span> <span data-ttu-id="50c0a-201">このプロパティの値は読み取り専用に値が存在するかどうかにチェック、`ViewState`はない場合、既定値、空の文字列を返します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-201">When this property's value is read, it checks to see if a value exists in the `ViewState` collection; if not, it returns the default value, an empty string.</span></span> <span data-ttu-id="50c0a-202">`UsernameToMatch`プロパティ namely プロパティに変更がポストバック間で永続化するために状態を表示する値を保持する、一般的なパターンが発生します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-202">The `UsernameToMatch` property exhibits a common pattern, namely persisting a value to view state so that any changes to the property are persisted across postbacks.</span></span> <span data-ttu-id="50c0a-203">このパターンの詳細については、読み取る[について ASP.NET ビュー ステート](https://msdn.microsoft.com/library/ms972976.aspx)します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-203">For more information on this pattern, read [Understanding ASP.NET View State](https://msdn.microsoft.com/library/ms972976.aspx).</span></span>

<span data-ttu-id="50c0a-204">次に、更新、`BindUserAccounts`メソッドを呼び出し元の代わりに`Membership.GetAllUsers`、呼び出します`Membership.FindUsersByName`の値で渡し、`UsernameToMatch`プロパティは、SQL ワイルドカード文字が付加されます %。</span><span class="sxs-lookup"><span data-stu-id="50c0a-204">Next, update the `BindUserAccounts` method so that instead of calling `Membership.GetAllUsers`, it calls `Membership.FindUsersByName`, passing in the value of the `UsernameToMatch` property appended with the SQL wildcard character, %.</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample9.cs)]

<span data-ttu-id="50c0a-205">文字 A で始まるがユーザー名には、これらのユーザーを表示するには、設定、 `UsernameToMatch` a プロパティを呼び出して`BindUserAccounts`します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-205">To display just those users whose username starts with the letter A, set the `UsernameToMatch` property to A and then call `BindUserAccounts`.</span></span> <span data-ttu-id="50c0a-206">呼び出しでこの結果は`Membership.FindUsersByName("A%")`、A. 同様に、返されるで始まるユーザー名を持つすべてのユーザーが返されます*すべて*、ユーザーの割り当てに空の文字列、`UsernameToMatch`プロパティように、`BindUserAccounts`メソッドには呼び出す`Membership.FindUsersByName("%")`のため、すべてのユーザー アカウントを取得します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-206">This would result in a call to `Membership.FindUsersByName("A%")`, which will return all users whose username starts with A. Likewise, to return *all* users, assign an empty string to the `UsernameToMatch` property so that the `BindUserAccounts` method will invoke `Membership.FindUsersByName("%")`, thereby returning all user accounts.</span></span>

<span data-ttu-id="50c0a-207">Repeater のイベント ハンドラーを作成`ItemCommand`イベント。</span><span class="sxs-lookup"><span data-stu-id="50c0a-207">Create an event handler for the Repeater's `ItemCommand` event.</span></span> <span data-ttu-id="50c0a-208">フィルター Linkbutton のいずれかがクリックされたときに、このイベントが発生しますクリックされた LinkButton の渡された`CommandName`値を通じて、`RepeaterCommandEventArgs`オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="50c0a-208">This event is raised whenever one of the filter LinkButtons is clicked; it is passed the clicked LinkButton's `CommandName` value through the `RepeaterCommandEventArgs` object.</span></span> <span data-ttu-id="50c0a-209">適切な値を代入する必要があります、`UsernameToMatch`プロパティと、呼び出し、`BindUserAccounts`メソッド。</span><span class="sxs-lookup"><span data-stu-id="50c0a-209">We need to assign the appropriate value to the `UsernameToMatch` property and then call the `BindUserAccounts` method.</span></span> <span data-ttu-id="50c0a-210">場合、`CommandName`はすべてに空の文字列を割り当てる`UsernameToMatch`すべてのユーザー アカウントが表示されるようにします。</span><span class="sxs-lookup"><span data-stu-id="50c0a-210">If the `CommandName` is All, assign an empty string to `UsernameToMatch` so that all user accounts are displayed.</span></span> <span data-ttu-id="50c0a-211">それ以外の場合、割り当て、`CommandName`値を`UsernameToMatch`します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-211">Otherwise, assign the `CommandName` value to `UsernameToMatch`.</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample10.cs)]

<span data-ttu-id="50c0a-212">このコードでフィルター処理の機能をテストします。</span><span class="sxs-lookup"><span data-stu-id="50c0a-212">With this code in place, test out the filtering functionality.</span></span> <span data-ttu-id="50c0a-213">ページが初めてアクセスした場合、すべてのユーザー アカウントが表示されます (バックアップは図 5 を参照してください)。</span><span class="sxs-lookup"><span data-stu-id="50c0a-213">When the page is first visited, all user accounts are displayed (refer back to Figure 5).</span></span> <span data-ttu-id="50c0a-214">A LinkButton をクリックすると、ポストバックが発生して、A で始まるユーザー アカウントのみを表示する、結果をフィルター処理します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-214">Clicking the A LinkButton causes a postback and filters the results, displaying only those user accounts that start with A .</span></span>


<span data-ttu-id="50c0a-215">[![フィルター処理の Linkbutton を使用して、ユーザー名は、特定の文字で始まるユーザーを表示するには](building-an-interface-to-select-one-user-account-from-many-cs/_static/image17.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="50c0a-215">[![Use the Filtering LinkButtons to Display those Users Whose Username Starts with a Certain Letter](building-an-interface-to-select-one-user-account-from-many-cs/_static/image17.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image16.png)</span></span>

<span data-ttu-id="50c0a-216">**図 6**: フィルター Linkbutton を使用して、それらのユーザーをで始まるユーザー名、特定の文字を表示する ([フルサイズの画像を表示する をクリックします](building-an-interface-to-select-one-user-account-from-many-cs/_static/image18.png))。</span><span class="sxs-lookup"><span data-stu-id="50c0a-216">**Figure 6**: Use the Filtering LinkButtons to Display those Users Whose Username Starts with a Certain Letter  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image18.png))</span></span>


## <a name="step-4-updating-the-gridview-to-use-paging"></a><span data-ttu-id="50c0a-217">手順 4: ページングを使用して、GridView を更新しています</span><span class="sxs-lookup"><span data-stu-id="50c0a-217">Step 4: Updating the GridView to Use Paging</span></span>

<span data-ttu-id="50c0a-218">図 5 および 6 に示すように、GridView では、すべてから返されるレコードの一覧表示、`FindUsersByName`メソッド。</span><span class="sxs-lookup"><span data-stu-id="50c0a-218">The GridView shown in Figures 5 and 6 lists all of the records returned from the `FindUsersByName` method.</span></span> <span data-ttu-id="50c0a-219">数百または何千ものユーザー アカウントがある場合、(この場合はすべての LinkButton をクリックすると、または最初に、ページにアクセスしたとき) と同様に、すべてのアカウントを表示するときにオーバー ロードにリードこのことができます。</span><span class="sxs-lookup"><span data-stu-id="50c0a-219">If there are hundreds or thousands of user accounts this can lead to information overload when viewing all of the accounts (as is the case when clicking the All LinkButton or when initially visiting the page).</span></span> <span data-ttu-id="50c0a-220">管理しやすいチャンク単位でユーザー アカウントを表示するには、一度に 10 個のユーザー アカウントを表示する GridView を構成しましょう。</span><span class="sxs-lookup"><span data-stu-id="50c0a-220">To help present the user accounts in more manageable chunks, let's configure the GridView to display 10 user accounts at a time.</span></span>

<span data-ttu-id="50c0a-221">GridView コントロールには、ページングの 2 つの種類があります。</span><span class="sxs-lookup"><span data-stu-id="50c0a-221">The GridView control offers two types of paging:</span></span>

- <span data-ttu-id="50c0a-222">**既定のページング**- 簡単に実装しますが、非効率的です。</span><span class="sxs-lookup"><span data-stu-id="50c0a-222">**Default paging** - easy to implement, but inefficient.</span></span> <span data-ttu-id="50c0a-223">簡単に言うと、既定値は、GridView のページングが必要ですが*すべて*のデータ ソースからレコード。</span><span class="sxs-lookup"><span data-stu-id="50c0a-223">In a nutshell, with default paging the GridView expects *all* of the records from its data source.</span></span> <span data-ttu-id="50c0a-224">のみが表示されます、適切なページのレコード。</span><span class="sxs-lookup"><span data-stu-id="50c0a-224">It then only displays the appropriate page of records.</span></span>
- <span data-ttu-id="50c0a-225">**カスタム ページング**-より多くの作業を実装する必要がありますが、カスタムのデータのページングとソースが表示するレコードの正確なセットのみを返すので、既定のページングよりも効率的です。</span><span class="sxs-lookup"><span data-stu-id="50c0a-225">**Custom paging** - requires more work to implement, but is more efficient than default paging because with custom paging the data source returns only the precise set of records to display.</span></span>

<span data-ttu-id="50c0a-226">数千のレコードをページングするときに、既定およびカスタム ページングのパフォーマンスの違いは大幅にできます。</span><span class="sxs-lookup"><span data-stu-id="50c0a-226">The performance difference between default and custom paging can be quite substantial when paging through thousands of records.</span></span> <span data-ttu-id="50c0a-227">構築されたためがいると仮定して、このインターフェイスが数百または何千ものユーザー アカウントを更新した後、カスタム ページングを使用してみましょう可能性があります。</span><span class="sxs-lookup"><span data-stu-id="50c0a-227">Because we are building this interface assuming that there may be hundreds or thousands of user accounts, let's use custom paging.</span></span>

> [!NOTE]
> <span data-ttu-id="50c0a-228">既定とカスタム ページング、さらにカスタム ページングを実装に伴う課題の違いの詳細についてを参照してください[効率的にページングを大規模な量のデータ](https://asp.net/learn/data-access/tutorial-25-cs.aspx)します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-228">For a more thorough discussion on the differences between default and custom paging, as well as the challenges involved in implementing custom paging, refer to [Efficiently Paging Through Large Amounts of Data](https://asp.net/learn/data-access/tutorial-25-cs.aspx).</span></span> <span data-ttu-id="50c0a-229">既定およびカスタム ページングのパフォーマンスの違いのいくつかの分析では、次を参照してください。 [SQL Server 2005 での ASP.NET でカスタム ページング](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx)します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-229">For some analysis of the performance difference between default and custom paging, see [Custom Paging in ASP.NET with SQL Server 2005](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx).</span></span>


<span data-ttu-id="50c0a-230">カスタム ページングを実装するために、GridView により表示されるレコードの正確なサブセットを取得するには、いくつかメカニズムまず必要あります。</span><span class="sxs-lookup"><span data-stu-id="50c0a-230">To implement custom paging we first need some mechanism by which to retrieve the precise subset of records being displayed by the GridView.</span></span> <span data-ttu-id="50c0a-231">良い知らせは、`Membership`クラスの`FindUsersByName`メソッドがページのインデックスと、ページ サイズを指定することができるようにするオーバー ロードと、そのレコードの範囲内にあるユーザー アカウントのみを返します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-231">The good news is that the `Membership` class's `FindUsersByName` method has an overload that allows us to specify the page index and page size, and returns only those user accounts that fall within that range of records.</span></span>

<span data-ttu-id="50c0a-232">具体的には、このオーバー ロードが、次のシグネチャを持つ: [ `FindUsersByName(usernameToMatch, pageIndex, pageSize, totalRecords)`](https://msdn.microsoft.com/library/fa5st8b2.aspx)します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-232">In particular, this overload has the following signature: [`FindUsersByName(usernameToMatch, pageIndex, pageSize, totalRecords)`](https://msdn.microsoft.com/library/fa5st8b2.aspx).</span></span>

<span data-ttu-id="50c0a-233">*PageIndex*パラメーターは、返されるユーザー アカウントのページを指定します。*pageSize*ページごとに表示するレコードの数を示します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-233">The *pageIndex* parameter specifies the page of user accounts to return; *pageSize* indicates how many records to display per page.</span></span> <span data-ttu-id="50c0a-234">*TotalRecords*パラメーターは、`out`ユーザー ストアに合計ユーザー アカウントの数を返すパラメーターです。</span><span class="sxs-lookup"><span data-stu-id="50c0a-234">The *totalRecords* parameter is an `out` parameter that returns the number of total user accounts in the user store.</span></span>

> [!NOTE]
> <span data-ttu-id="50c0a-235">によって返されるデータ`FindUsersByName`; ユーザー名で並べ替えられますが、並べ替えの条件をカスタマイズすることはできません。</span><span class="sxs-lookup"><span data-stu-id="50c0a-235">The data returned by `FindUsersByName` is sorted by username; the sort criteria cannot be customized.</span></span>


<span data-ttu-id="50c0a-236">GridView は、カスタムのページングを使用するが、ObjectDataSource コントロールにバインドした場合のみを構成できます。</span><span class="sxs-lookup"><span data-stu-id="50c0a-236">The GridView can be configured to utilize custom paging, but only when bound to an ObjectDataSource control.</span></span> <span data-ttu-id="50c0a-237">カスタム ページングを実装する ObjectDataSource コントロール、2 つの方法が必要ですが開始行インデックスおよび表示するにはレコードの最大数に渡される 1 つと正確な; スパン内に含まれるレコードのサブセットを返します。でレコードの合計数を返すメソッドのポケットベル通知します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-237">For the ObjectDataSource control to implement custom paging, it requires two methods: one that is passed a start row index and the maximum number of records to display, and returns the precise subset of records that fall within that span; and a method that returns the total number of records being paged through.</span></span> <span data-ttu-id="50c0a-238">`FindUsersByName`オーバー ロードは、ページのインデックスと、ページ サイズを受け入れるし、使用してレコードの合計数を返します、`out`パラメーター。</span><span class="sxs-lookup"><span data-stu-id="50c0a-238">The `FindUsersByName` overload accepts a page index and page size, and returns the total number of records through an `out` parameter.</span></span> <span data-ttu-id="50c0a-239">したがって、インターフェイスの不一致があります。</span><span class="sxs-lookup"><span data-stu-id="50c0a-239">So there is an interface mismatch here.</span></span>

<span data-ttu-id="50c0a-240">1 つのオプションが、ObjectDataSource が必要ですと内部的に呼び出すインターフェイスを公開するプロキシ クラスを作成すると、`FindUsersByName`メソッド。</span><span class="sxs-lookup"><span data-stu-id="50c0a-240">One option would be to create a proxy class that exposes the interface the ObjectDataSource expects, and then internally calls the `FindUsersByName` method.</span></span> <span data-ttu-id="50c0a-241">別のオプション - および使用してこの記事のいずれかで独自のページング インターフェイスを作成し、GridView の組み込みのページング インターフェイスではなくを使用することです。</span><span class="sxs-lookup"><span data-stu-id="50c0a-241">Another option - and the one we'll use for this article - is to create our own paging interface and use that instead of the GridView's built-in paging interface.</span></span>

### <a name="creating-a-first-previous-next-last-paging-interface"></a><span data-ttu-id="50c0a-242">A まず、作成する前に、次に、最後のページング インターフェイス</span><span class="sxs-lookup"><span data-stu-id="50c0a-242">Creating a First, Previous, Next, Last Paging Interface</span></span>

<span data-ttu-id="50c0a-243">最初、Previous、次に、最後の Linkbutton とページング インターフェイスを構築してみましょう。</span><span class="sxs-lookup"><span data-stu-id="50c0a-243">Let's build a paging interface with First, Previous, Next, and Last LinkButtons.</span></span> <span data-ttu-id="50c0a-244">以前は前のページに彼の連絡先を返す一方、最初の LinkButton がクリックされるは、データの最初のページにユーザーになります。</span><span class="sxs-lookup"><span data-stu-id="50c0a-244">The First LinkButton, when clicked, will take the user to the first page of data, whereas Previous will return him to the previous page.</span></span> <span data-ttu-id="50c0a-245">同様に、次へと最終がユーザーへの移動 次へ と最後のページで、それぞれします。</span><span class="sxs-lookup"><span data-stu-id="50c0a-245">Likewise, Next and Last will move the user to the next and last page, respectively.</span></span> <span data-ttu-id="50c0a-246">下にある 4 つの LinkButton コントロールを追加、 `UserAccounts` GridView。</span><span class="sxs-lookup"><span data-stu-id="50c0a-246">Add the four LinkButton controls beneath the `UserAccounts` GridView.</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample11.aspx)]

<span data-ttu-id="50c0a-247">次に、LinkButton の各イベント ハンドラーを作成`Click`イベント。</span><span class="sxs-lookup"><span data-stu-id="50c0a-247">Next, create an event handler for each of the LinkButton's `Click` events.</span></span>

<span data-ttu-id="50c0a-248">図 7 では、Visual Web Developer のデザイン ビューで表示した場合は、次の 4 つ Linkbutton を示します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-248">Figure 7 shows the four LinkButtons when viewed through the Visual Web Developer Design view.</span></span>


<span data-ttu-id="50c0a-249">[![次に、まず、前を追加して、最後の GridView の下にあります。](building-an-interface-to-select-one-user-account-from-many-cs/_static/image20.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="50c0a-249">[![Add First, Previous, Next, and Last LinkButtons Beneath the GridView](building-an-interface-to-select-one-user-account-from-many-cs/_static/image20.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image19.png)</span></span>

<span data-ttu-id="50c0a-250">**図 7**: 最初の追加、前、[次へと最終 Linkbutton の下に、GridView ([フルサイズの画像を表示する] をクリックします](building-an-interface-to-select-one-user-account-from-many-cs/_static/image21.png))。</span><span class="sxs-lookup"><span data-stu-id="50c0a-250">**Figure 7**: Add First, Previous, Next, and Last LinkButtons Beneath the GridView  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image21.png))</span></span>


### <a name="keeping-track-of-the-current-page-index"></a><span data-ttu-id="50c0a-251">現在のページ インデックスの管理</span><span class="sxs-lookup"><span data-stu-id="50c0a-251">Keeping Track of the Current Page Index</span></span>

<span data-ttu-id="50c0a-252">ユーザーが最初にアクセスすると、`ManageUsers.aspx`ボタン、フィルター選択のいずれかのページまたは数回のクリック、GridView でデータの最初のページを表示するようにします。</span><span class="sxs-lookup"><span data-stu-id="50c0a-252">When a user first visits the `ManageUsers.aspx` page or clicks one of the filtering buttons, we want to display the first page of data in the GridView.</span></span> <span data-ttu-id="50c0a-253">ただし、ユーザーには、ナビゲーション Linkbutton の 1 つクリックすると、ときに、ページのインデックスを更新する必要があります。</span><span class="sxs-lookup"><span data-stu-id="50c0a-253">When the user clicks one of the navigation LinkButtons, however, we need to update the page index.</span></span> <span data-ttu-id="50c0a-254">ページのインデックスと 1 ページに表示するレコードの数を維持するには、ページの分離コード クラスに次の 2 つのプロパティを追加します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-254">To maintain the page index and the number of records to display per page, add the following two properties to the page's code-behind class:</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample12.cs)]

<span data-ttu-id="50c0a-255">ように、`UsernameToMatch`プロパティ、`PageIndex`プロパティは、状態を表示するには、その値を永続化します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-255">Like the `UsernameToMatch` property, the `PageIndex` property persists its value to view state.</span></span> <span data-ttu-id="50c0a-256">読み取り専用`PageSize`10、ハード コーディングされた値を返します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-256">The read-only `PageSize` property returns a hard-coded value, 10.</span></span> <span data-ttu-id="50c0a-257">招待興味を持った読者と同様のパターンを使用するには、このプロパティを更新するには`PageIndex`、しを増やすために、`ManageUsers.aspx`ページごとに表示するユーザー アカウントの数のページ、ページにアクセスするユーザーを指定できるようにします。</span><span class="sxs-lookup"><span data-stu-id="50c0a-257">I invite the interested reader to update this property to use the same pattern as `PageIndex`, and then to augment the `ManageUsers.aspx` page such that the person visiting the page can specify how many user accounts to display per page.</span></span>

### <a name="retrieving-just-the-current-pages-records-updating-the-page-index-and-enabling-and-disabling-the-paging-interface-linkbuttons"></a><span data-ttu-id="50c0a-258">現在のページのレコードだけを取得する、ページのインデックスを更新および有効化とページング インターフェイスの Linkbutton を無効にします。</span><span class="sxs-lookup"><span data-stu-id="50c0a-258">Retrieving Just the Current Page's Records, Updating the Page Index, and Enabling and Disabling the Paging Interface LinkButtons</span></span>

<span data-ttu-id="50c0a-259">配置でのページング インターフェイスと`PageIndex`と`PageSize`プロパティの追加、更新する準備ができました、`BindUserAccounts`メソッドを使用する適切なので`FindUsersByName`オーバー ロードします。</span><span class="sxs-lookup"><span data-stu-id="50c0a-259">With the paging interface in place and the `PageIndex` and `PageSize` properties added, we are ready to update the `BindUserAccounts` method so that it uses the appropriate `FindUsersByName` overload.</span></span> <span data-ttu-id="50c0a-260">さらに、このメソッドを有効にするかによって、どのようなページが表示されているページング インターフェイスを無効にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="50c0a-260">Additionally, we need to have this method enable or disable the paging interface depending on what page is being displayed.</span></span> <span data-ttu-id="50c0a-261">データの最初のページを表示すると、最初と前のリンクを無効にする必要があります。最後のページを表示するときに、次に、最後を無効にする必要があります。</span><span class="sxs-lookup"><span data-stu-id="50c0a-261">When viewing the first page of data, the First and Previous links should be disabled; Next and Last should be disabled when viewing the last page.</span></span>

<span data-ttu-id="50c0a-262">`BindUserAccounts` メソッドを次のコードで更新します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-262">Update the `BindUserAccounts` method with the following code:</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample13.cs)]

<span data-ttu-id="50c0a-263">ポケットベル通知でレコードの合計数がの最後のパラメーターによって決定されるに注意してください、`FindUsersByName`メソッド。</span><span class="sxs-lookup"><span data-stu-id="50c0a-263">Note that the total number of records being paged through is determined by the last parameter of the `FindUsersByName` method.</span></span> <span data-ttu-id="50c0a-264">これは、`out`パラメーターは、まずこの値を保持する変数を宣言する必要があります (`totalRecords`) とプレフィックスと、`out`キーワード。</span><span class="sxs-lookup"><span data-stu-id="50c0a-264">This is an `out` parameter, so we need to first declare a variable to hold this value (`totalRecords`) and then prefix it with the `out` keyword.</span></span>

<span data-ttu-id="50c0a-265">ユーザー アカウントの指定したページが返された後、4 つあるか、有効または無効に、データの最初と最後のページが表示されているかどうかに応じて。</span><span class="sxs-lookup"><span data-stu-id="50c0a-265">After the specified page of user accounts are returned, the four LinkButtons are either enabled or disabled, depending on whether the first or last page of data is being viewed.</span></span>

<span data-ttu-id="50c0a-266">最後の手順では 4 つの Linkbutton のコードを記述する`Click`イベント ハンドラー。</span><span class="sxs-lookup"><span data-stu-id="50c0a-266">The last step is to write the code for the four LinkButtons' `Click` event handlers.</span></span> <span data-ttu-id="50c0a-267">これらのイベント ハンドラーを更新する必要があります、`PageIndex`プロパティへの呼び出しを使用して GridView にデータをバインドし、`BindUserAccounts`します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-267">These event handlers need to update the `PageIndex` property and then rebind the data to the GridView via a call to `BindUserAccounts`.</span></span> <span data-ttu-id="50c0a-268">First、Previous、および次のイベント ハンドラーは、非常に単純です。</span><span class="sxs-lookup"><span data-stu-id="50c0a-268">The First, Previous, and Next event handlers are very simple.</span></span> <span data-ttu-id="50c0a-269">`Click`最後の LinkButton のイベント ハンドラーが複雑になるため、最後のページ インデックスを決定するために表示されるレコードの数を決定する必要があります。</span><span class="sxs-lookup"><span data-stu-id="50c0a-269">The `Click` event handler for the Last LinkButton, however, is a bit more complex because we need to determine how many records are being displayed in order to determine the last page index.</span></span>

[!code-csharp[Main](building-an-interface-to-select-one-user-account-from-many-cs/samples/sample14.cs)]

<span data-ttu-id="50c0a-270">図 8 と 9 は、アクションでカスタム ページング インターフェイスを表示します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-270">Figures 8 and 9 show the custom paging interface in action.</span></span> <span data-ttu-id="50c0a-271">図 8 は、`ManageUsers.aspx`ページすべてのユーザー アカウントのデータの最初のページを表示する場合。</span><span class="sxs-lookup"><span data-stu-id="50c0a-271">Figure 8 shows the `ManageUsers.aspx` page when viewing the first page of data for all user accounts.</span></span> <span data-ttu-id="50c0a-272">13 のアカウントの 10 個しかが表示されることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="50c0a-272">Note that only 10 of the 13 accounts are displayed.</span></span> <span data-ttu-id="50c0a-273">[次へ] または最後のリンクをクリックすると、ポストバックで更新プログラム、 `PageIndex` 1、およびバインド グリッドへのアカウントのユーザーの 2 ページ目に (図 9 参照)。</span><span class="sxs-lookup"><span data-stu-id="50c0a-273">Clicking the Next or Last link causes a postback, updates the `PageIndex` to 1, and binds the second page of user accounts to the grid (see Figure 9).</span></span>


<span data-ttu-id="50c0a-274">[![最初の 10 のユーザー アカウントが表示されます。](building-an-interface-to-select-one-user-account-from-many-cs/_static/image23.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="50c0a-274">[![The First 10 User Accounts are Displayed](building-an-interface-to-select-one-user-account-from-many-cs/_static/image23.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image22.png)</span></span>

<span data-ttu-id="50c0a-275">**図 8**:、最初の 10 のユーザー アカウントが表示されます ([フルサイズの画像を表示する をクリックします](building-an-interface-to-select-one-user-account-from-many-cs/_static/image24.png))。</span><span class="sxs-lookup"><span data-stu-id="50c0a-275">**Figure 8**: The First 10 User Accounts are Displayed  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image24.png))</span></span>


<span data-ttu-id="50c0a-276">[![次のリンクをクリックするとユーザー アカウントの 2 ページ目を表示します](building-an-interface-to-select-one-user-account-from-many-cs/_static/image26.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="50c0a-276">[![Clicking the Next Link Displays the Second Page of User Accounts](building-an-interface-to-select-one-user-account-from-many-cs/_static/image26.png)](building-an-interface-to-select-one-user-account-from-many-cs/_static/image25.png)</span></span>

<span data-ttu-id="50c0a-277">**図 9**: ユーザー アカウントの 2 番目のページの次のリンクをクリックすると表示されます ([フルサイズの画像を表示する をクリックします](building-an-interface-to-select-one-user-account-from-many-cs/_static/image27.png))。</span><span class="sxs-lookup"><span data-stu-id="50c0a-277">**Figure 9**: Clicking the Next Link Displays the Second Page of User Accounts  ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-cs/_static/image27.png))</span></span>


## <a name="summary"></a><span data-ttu-id="50c0a-278">まとめ</span><span class="sxs-lookup"><span data-stu-id="50c0a-278">Summary</span></span>

<span data-ttu-id="50c0a-279">多くの場合、管理者は、アカウントの一覧からユーザーを選択する必要があります。</span><span class="sxs-lookup"><span data-stu-id="50c0a-279">Administrators often need to select a user from the list of accounts.</span></span> <span data-ttu-id="50c0a-280">前のチュートリアルでは、ユーザーを含むドロップダウン リストを使用してしましたが、このアプローチが適切にスケーリングされません。</span><span class="sxs-lookup"><span data-stu-id="50c0a-280">In previous tutorials we looked at using a drop-down list populated with the users, but this approach does not scale well.</span></span> <span data-ttu-id="50c0a-281">このチュートリアルでは代替検討しました: ページングされた GridView で結果が表示されます、フィルター可能なインターフェイスです。</span><span class="sxs-lookup"><span data-stu-id="50c0a-281">In this tutorial we explored a better alternative: a filterable interface whose results are displayed in a paged GridView.</span></span> <span data-ttu-id="50c0a-282">このユーザー インターフェイスでは、管理者はことができますを検索し、迅速かつ効率的に何千もの間で 1 つのユーザー アカウントを選択します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-282">With this user interface, administrators can quickly and efficiently locate and select one user account among thousands.</span></span>

<span data-ttu-id="50c0a-283">満足のプログラミングです。</span><span class="sxs-lookup"><span data-stu-id="50c0a-283">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="50c0a-284">関連項目</span><span class="sxs-lookup"><span data-stu-id="50c0a-284">Further Reading</span></span>

<span data-ttu-id="50c0a-285">このチュートリアルで説明したトピックの詳細については、次の情報を参照してください。</span><span class="sxs-lookup"><span data-stu-id="50c0a-285">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="50c0a-286">SQL Server 2005 での ASP.NET でカスタム ページング</span><span class="sxs-lookup"><span data-stu-id="50c0a-286">Custom Paging in ASP.NET with SQL Server 2005</span></span>](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx)
- [<span data-ttu-id="50c0a-287">大量のデータを効率的にページング</span><span class="sxs-lookup"><span data-stu-id="50c0a-287">Efficiently Paging Through Large Amounts of Data</span></span>](https://asp.net/learn/data-access/tutorial-25-cs.aspx)
- [<span data-ttu-id="50c0a-288">独自の web サイト管理ツールのローリング</span><span class="sxs-lookup"><span data-stu-id="50c0a-288">Rolling Your Own Website Administration Tool</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)

### <a name="about-the-author"></a><span data-ttu-id="50c0a-289">執筆者紹介</span><span class="sxs-lookup"><span data-stu-id="50c0a-289">About the Author</span></span>

<span data-ttu-id="50c0a-290">Scott Mitchell、複数の受け取ります書籍の著者と、4GuysFromRolla.com の創設者では、1998 年から、Microsoft Web テクノロジに取り組んできました。</span><span class="sxs-lookup"><span data-stu-id="50c0a-290">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="50c0a-291">Scott は、フリーのコンサルタント、トレーナー、およびライターとして動作します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-291">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="50c0a-292">最新の著書は *[Sams 教える自分で ASP.NET 2.0 24 時間以内に](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)* します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-292">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="50c0a-293">Scott に到達できる[ mitchell@4guysfromrolla.com ](mailto:mitchell@4guysfromrolla.com)または彼のブログ[ http://ScottOnWriting.NET](http://scottonwriting.net/)します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-293">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="50c0a-294">特別なに感謝します。</span><span class="sxs-lookup"><span data-stu-id="50c0a-294">Special Thanks To</span></span>

<span data-ttu-id="50c0a-295">このチュートリアル シリーズは、多くの便利なレビュー担当者によってレビューされました。</span><span class="sxs-lookup"><span data-stu-id="50c0a-295">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="50c0a-296">このチュートリアルでは、潜在顧客レビュー担当者は、Alicja Maziarz でした。</span><span class="sxs-lookup"><span data-stu-id="50c0a-296">Lead reviewer for this tutorial was Alicja Maziarz.</span></span> <span data-ttu-id="50c0a-297">今後、MSDN の記事を確認したいですか。</span><span class="sxs-lookup"><span data-stu-id="50c0a-297">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="50c0a-298">場合は、筆者に [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="50c0a-298">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="50c0a-299">次へ</span><span class="sxs-lookup"><span data-stu-id="50c0a-299">Next</span></span>](recovering-and-changing-passwords-cs.md)
