---
uid: web-pages/overview/getting-started/introducing-aspnet-web-pages-2/form-basics
title: ASP.NET Web ページの HTML フォームの基本の導入 |Microsoft Docs
author: Rick-Anderson
description: このチュートリアルでは、入力フォームを作成する方法と ASP.NET Web Pages (Razor) を使用すると、ユーザーの入力を処理する方法の基本を説明します。 今すぐこととしています.
ms.author: riande
ms.date: 05/28/2015
ms.assetid: 81ed82bf-b940-44f1-b94a-555d0cb7cc98
msc.legacyurl: /web-pages/overview/getting-started/introducing-aspnet-web-pages-2/form-basics
msc.type: authoredcontent
ms.openlocfilehash: 28385ac2244ab0bfb38ee5fcbc64e6e11804612b
ms.sourcegitcommit: 2d3e5422d530203efdaf2014d1d7df31f88d08d0
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/05/2018
ms.locfileid: "51021678"
---
<a name="introducing-aspnet-web-pages---html-form-basics"></a>ASP.NET Web ページの HTML フォームの基本の概要
====================
によって[Tom FitzMacken](https://github.com/tfitzmac)

> このチュートリアルでは、入力フォームを作成する方法と ASP.NET Web Pages (Razor) を使用すると、ユーザーの入力を処理する方法の基本を説明します。 データベースがあれば、これでユーザーがデータベース内の特定の映画を検索できるように、フォームのスキルを使用します。 を通じてシリーズを完了したと想定して[概要を表示するデータを使用して ASP.NET Web Pages](/aspnet/web-pages/overview/getting-started/introducing-aspnet-web-pages-2/displaying-data)します。
> 
> 学習内容。
> 
> - 標準の HTML 要素を使用してフォームを作成する方法。
> - ユーザーを読み取る方法は形式で入力します。
> - SQL クエリを選択的に、検索を使用してデータを取得用語をユーザーを作成する方法を提供します。
> - ページで「記憶」、ユーザーが入力したフィールドを持つ方法です。
>   
> 
> 説明した機能/テクノロジ:
> 
> - `Request` オブジェクト。
> - SQL`Where`句。


## <a name="what-youll-build"></a>構築します

前のチュートリアルでデータベースを作成して、データを追加および使用して、`WebGrid`データを表示するヘルパー。 このチュートリアルでは、特定のジャンルを映画を検索できるまたはタイトルには入力する任意の単語が含まれています、検索ボックスを追加します。 (たとえば、ことができますジャンルが"Action"、またはタイトルには、"Harry"または"Adventure"が含まれています。 すべての映画を検索する)

このチュートリアルを完了すると、次のようなページが必要があります。

![ムービー ジャンルとタイトルの検索 ページ](form-basics/_static/image1.png)

ページの一覧の一部は前回のチュートリアルと同じ&mdash;グリッド。 違いは、グリッドが表示される映画のみを検索することになります。

## <a name="about-html-forms"></a>HTML フォームについて

(かどうか HTML フォームを作成してとの違いのエクスペリエンスが得られたら`GET`と`POST`、このセクションをスキップすることができます)。

フォームがユーザー入力要素を持つ&mdash;テキスト ボックス、ボタン、オプション ボタン、チェック ボックス、ドロップダウン リスト、およびなど。 ユーザーは、これらのコントロールで入力または選択を行い、ボタンをクリックして、フォームを送信します。

フォームの基本的な HTML 構文は、この例で示されています。

[!code-html[Main](form-basics/samples/sample1.html)]

このマークアップをページで実行すると、次の図のような単純なフォームが作成されます。

![ブラウザーでレンダリングされたとして基本的な HTML フォーム](form-basics/_static/image2.png)

`<form>`要素を送信する HTML 要素で囲みます。 (させるという、簡単なミスはページに要素を追加し、内部に配置することを忘れないで、`<form>`要素。 その場合、何も送信されます。)`method`属性は、ユーザー入力を送信する方法をブラウザーに指示します。 これを設定して`post`サーバー上または更新プログラムを実行している場合`get`場合は、サーバーからデータをフェッチしているだけです。

<a id="GET,_POST,_and_HTTP_Verb_Safety"></a>

> [!TIP] 
> 
> **GET、POST、および HTTP 動詞の安全性**
> 
> HTTP の場合、ブラウザーとサーバー情報を交換に使用するプロトコルはその基本的な操作で非常に単純です。 ブラウザーでは、サーバーに要求を行ういくつかの動詞のみを使用します。 Web 用のコードを記述する場合は、これらの動詞と、ブラウザーとサーバーの使用方法を理解することをお勧めします。 距離と最もよく使用される動詞は、これらは。
> 
> - `GET`。 ブラウザーでは、この動詞を使用して、サーバーから何かを取り出します。 たとえば、お使いのブラウザーに URL を入力すると、ブラウザーが実行します。、`GET`目的のページを要求する操作。 ページには、グラフィックスが含まれている場合、ブラウザーを追加実行`GET`イメージを取得する操作。 場合、`GET`操作は、サーバーに情報を渡す必要があると、クエリ文字列内の URL の一部として情報が渡されます。
> - `POST`。 ブラウザーが送信を`POST`追加または変更、サーバー上にデータを送信するために要求します。 たとえば、`POST`をデータベースにレコードを作成または変更する既存の動詞が使用されます。 ほとんどの場合、フォームに入力し、[送信] ボタンをクリックして、ブラウザーを実行する`POST`操作。 `POST`操作、サーバーに渡されるデータがページの本文にします。
> 
> これらの動詞を重要な違いは、`GET`操作がサーバーで何も変更することはできません: または少し抽象の方法で配置する、`GET`操作がサーバー上での状態の変更になりません。 実行することができます、`GET`何度でも、必要な場合、およびそれらのリソースを変更しないと同じリソースで操作します。 (A `GET` 「安全」、または技術の用語を使用する操作とよく言われますが*べき等である*)。もちろん、これに対して、`POST`要求、サーバーで何か変更操作を実行するたびにします。
> 
> 2 つの例はこの区別を示すために役立ちます。 検索を実行するときに Bing や Google など、エンジンを使用して 1 つのテキスト ボックスで構成される形式で入力して、検索ボタンをクリックします。 ブラウザーを実行、 `GET` URL の一部として渡されたボックスに入力した値で操作します。 使用して、`GET`操作情報だけをこの種類のフォームは、検索操作は、サーバー上のすべてのリソースを変更しないため、問題ありませんが、フェッチします。
> 
> ここでのオンライン注文を考えてみましょう。 注文の詳細を入力し、[送信] ボタンをクリックします。 この操作になります、`POST`のため、操作の結果は新しい注文レコード、変更、アカウント情報でおそらく多くの他の変更など、サーバー上の変更を要求します。 異なり、`GET`操作を繰り返すことはできません、`POST`要求: サーバー上の新しい注文を生成し、要求を再送信するたびにも実行した場合。 (このような場合は、web サイト 2 回以上送信ボタンをクリックしないことを警告する多くの場合、または誤ってフォームを再送信されないように、[送信] ボタンを無効になります)。
> 
> このチュートリアルの過程で、両方を使用します、`GET`操作と`POST`HTML フォームを操作します。 各ケースの理由で使用する動詞は、適切なものを説明します。
> 
> (HTTP 動詞の詳細については、次を参照してください、[メソッド定義](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html)W3C サイトの記事「。)。


ほとんどのユーザー入力要素が HTML`<input>`要素。 ような外観`<input type="type" name="name">,`場所*型*するユーザー入力コントロールの種類を示します。 これらの要素は、一般的なものです。

- テキスト ボックス: `<input type="text">`
- チェック ボックスをオンします。 `<input type="check">`
- ラジオ ボタンをクリックします。 `<input type="radio">`
- ボタンをクリックします。 `<input type="button">`
- ボタンを送信します。 `<input type="submit">`

使用することも、`<textarea>`複数行テキスト ボックスを作成する要素と`<select>`ドロップダウン リストまたはスクロール可能なリストを作成する要素。 (詳細については、HTML フォームの要素、参照してください[HTML フォームおよび入力](http://www.w3schools.com/html/html_forms.asp)W3Schools サイトです)。

`name`属性は、名前がすぐにわかりますが、後で、要素の値の取得方法を示しますので、非常に重要です。

興味深い部分は、ユーザーの入力で何が、ページの開発者。 これらの要素に関連付けられた組み込みの動作はありません。 代わりに、ユーザーが入力または選択された値を取得し、何らかの処理を実行する必要があります。 このチュートリアルで学習内容です。

> [!TIP] 
> 
> **HTML5 と入力フォーム**
> 
> ご存知のように、HTML は状態遷移と最新バージョン (HTML5) より直感的な方法はユーザー情報を入力するためのサポートが含まれています。 たとえば、HTML5 で (ページの開発者向け) ことがわかりますページ日付を入力するユーザーをします。 ブラウザーに自動的に表示できます日を手動で入力するように求めるのではなく、予定表。 ただし、HTML5 では、新機能と、まだサポートのすべてのブラウザーでされません。
> 
> ASP.NET Web ページには、ユーザーのブラウザーを使用する入力 HTML5 がサポートされています。 新しい属性のアイデア、 `<input>` 、HTML5 の要素を参照してください[HTML&lt;入力&gt;type 属性](http://www.w3schools.com/html/html_form_input_types.asp)W3Schools サイト。


## <a name="creating-the-form"></a>フォームの作成

WebMatrix で、**ファイル** ワークスペースで、開く、 *Movies.cshtml*ページ。

終了後`</h1>`タグと、開く前に`<div>`のタグ、`grid.GetHtml`呼び出しは、次のマークアップを追加。

[!code-html[Main](form-basics/samples/sample2.html)]

このマークアップをという名前のテキスト ボックスを持つフォームを作成する`searchGenre`と送信ボタン。 テキスト ボックスし、送信ボタンがで囲まれた、`<form>`要素が`method`属性に設定されて`get`します。 (テキスト ボックスと内でボタンを送信しないことに注意して、`<form>`要素で、ボタンをクリックすると何も送信されます)。使用する、`GET`動詞ここでフォームを作成しているためするは変更しないように、サーバー上: 検索結果だけです。 (前のチュートリアルでは使用して、`post`メソッドで、サーバーへの変更を送信する方法です。 わかりますが、次のチュートリアルでもう一度。)

ページを実行します。 フォームの動作を定義していない、どのように見えることがわかります。

![ムービー ジャンルの検索ボックス ページ](form-basics/_static/image3.png)

「コメディ。」のように、テキスト ボックスに値を入力します。 クリックして**検索ジャンル**します。

ページの URL をメモしてをおきます。 設定するため、`<form>`要素の`method`属性を`get`、入力した値では、次のように、URL クエリ文字列の一部になります。

`http://localhost:45661/Movies.cshtml?searchGenre=Comedy`

## <a name="reading-form-values"></a>フォームの値の読み取り

ページには、データベースのデータを取得し、結果をグリッドに表示するコードが既に含まれています。 検索語句を含む SQL クエリを実行できるように、テキスト ボックスの値を読み取るコードを追加するがあるようになりました。

フォームの方法を設定するため、`get`次のようなコードを使用して、テキスト ボックスに入力された値を読み取ることができます。

`var searchTerm = Request.QueryString["searchGenre"];`

`Request.QueryString`オブジェクト (、`QueryString`のプロパティ、`Request`オブジェクト) の一部として送信された要素の値が含まれています、`GET`操作。 `Request.QueryString`プロパティが含まれています、*コレクション*(リスト) の形式で送信される値。 個別の値を取得するには、対象となる要素の名前を指定します。 理由が必要、`name`属性を`<input>`要素 (`searchTerm`) テキスト ボックスを作成します。 (詳細については、`Request`オブジェクトを参照してください、[サイドバー](#BKMK_TheRequestObject)後)。

テキスト ボックスの値を読み取る簡単になります。 ユーザーが入力しなかったすべてのテキスト ボックスがクリックされた場合は**検索**を検索するものがないため、ボタンをクリックするを無視するか、です。

次のコードでは、これらの条件を実装する方法を示す例を示します。 (まだこのコードを追加する必要はありません。 後で行います)。

[!code-csharp[Main](form-basics/samples/sample3.cs)]

この方法で、テストが分かれます。

- 値を取得`Request.QueryString["searchGenre"]`、つまりに入力された値、`<input>`という名前の要素`searchGenre`します。
- 使用して空であるかを調べる、`IsEmpty`メソッド。 このメソッドは、何か (たとえば、フォーム要素) に値が含まれるかどうかを確認する標準的な方法です。 実際がある場合にのみを処理が*いない*空か、そのため.
- 追加、`!`演算子の前後に、`IsEmpty`をテストします。 (、`!`演算子は論理 NOT)。

英語、全体の `if`条件は、次に変換します *場合は、フォームの searchGenre 要素は空でなく、...*

このブロックは、検索用語を使用するクエリを作成するためのステージを設定します。 次のセクションを実行してみましょう。

<a id="BKMK_TheRequestObject"></a>

> [!TIP] 
> 
> **要求オブジェクト**
> 
> `Request`オブジェクトには、ブラウザーはページが要求または送信されるときに、アプリケーションに送信されるすべての情報が含まれています。 このオブジェクトには、テキスト ボックスの値またはアップロードするファイルのように、ユーザーは、すべての情報が含まれています。 あらゆる種類の cookie、URL クエリ文字列 (存在する場合) 内の値と同様に、追加の情報も含まれています実行している、ブラウザー、ユーザーが使用しているブラウザーで設定されている言語の一覧の種類 ページのファイル パス。、その他さまざまな。
> 
> `Request`オブジェクトが、*コレクション*(リスト) の値。 その名前を指定することで、コレクションから個々 の値を取得します。
> 
> `var someValue = Request["name"];`
> 
> `Request`オブジェクトが実際にいくつかのサブセットを公開します。 例えば:
> 
> - `Request.Form` 送信済みの要素から値を提供する`<form>`要素の場合は、要求、`POST`要求。
> - `Request.QueryString` により、値だけでは、URL のクエリ文字列。 (ような URL で`http://mysite/myapp/page?searchGenre=action&page=2`、 `?searchGenre=action&page=2` URL のセクションは、クエリ文字列)。
> - `Request.Cookies` コレクションは、ブラウザーが送信したクッキーにアクセスできます。
> 
> 送信されたフォームがわかっている値を取得するのには、使用することができます`Request["name"]`します。 具体的なバージョンを使用する代わりに、 `Request.Form["name"]` (の`POST`要求) または`Request.QueryString["name"]`(の`GET`要求)。 もちろん、*名前*を取得する項目の名前を指定します。
> 
> 取得する項目の名前を使用するコレクション内で一意であることができます。 理由、`Request`オブジェクトなどのサブセットを提供する`Request.Form`と`Request.QueryString`します。 という名前のフォーム要素には、ページが含まれていると`userName`と*も*という名前の cookie を含む`userName`します。 表示された場合`Request["userName"]`フォームの値または cookie をするかどうかにはあいまいです。 ただし、表示された場合`Request.Form["userName"]`または`Request.Cookie["userName"]`、取得するには、どの値を明示するしています。
> 
> 固有のものし、のサブセットを使用することをお勧め`Request`のように、該当する、`Request.Form`または`Request.QueryString`します。 このチュートリアルで作成しているページの単純な場合、おそらく本当にも行いません。 ただしより複雑なページを作成するとき、明示的なバージョンを使用`Request.Form`または`Request.QueryString`ページには、フォーム (または複数の形式) が含まれている場合に発生する可能性のある問題を回避するための cookie やクエリ文字列の値。


## <a name="creating-a-query-by-using-a-search-term"></a>検索用語を使用してクエリを作成します。

ユーザーが入力した検索語句を取得する方法がわかったら、それを使用するクエリを作成することができます。 データベースからムービーのすべての項目を取得するには、このステートメントのような SQL クエリを使用していることを注意してください。

`SELECT * FROM Movies`

特定の動画のみを取得するを含むクエリを使用する必要が、`Where`句。 この句を使用している行は、クエリによって返される条件を設定できます。 次に例を示します。

`SELECT * FROM Movies WHERE Genre = 'Action'`

基本的な形式は`WHERE column = value`します。 さまざまな演算子を使用するには、さらに、ジャスト`=`と同様に、 `>` (より大きい)、 `<` (未満)、 `<>` (等しくない)、 `<=` (以下と等しい)、探しているものに応じてなど。

SQL ステートメントが大文字小文字が区別はありません。 念のため、 &mdash; `SELECT`と同じ`Select`(またはでも`select`)。 ただし、ユーザー多くの場合、大文字にする SQL ステートメントでキーワードなど`SELECT`と`WHERE`、読みやすくします。

### <a name="passing-the-search-term-as-a-parameter"></a>検索用語をパラメーターとして渡す

特定のジャンルは非常に簡単に検索 (`WHERE Genre = 'Action'`)、ユーザーが入力したすべてのジャンルを検索できるしたいです。 そのために検索する値のプレース ホルダーを含む SQL クエリとして作成します。 このコマンドのように表示されます。

`SELECT * FROM Movies WHERE Genre = @0`

プレース ホルダーは、`@`文字の後に 0 個です。 ご想像のとおり、クエリが複数のプレース ホルダーを含めることができ、という名前になります`@0`、 `@1`、`@2`など。

クエリの設定を実際に値を渡すことは、次のようなコードを使用します。

[!code-sql[Main](form-basics/samples/sample4.sql)]

このコードは、どのような実行したグリッドにデータを表示するに似ています。 唯一の違いは次のとおりです。

- クエリには、プレース ホルダーが含まれています (`WHERE Genre = @0"`)。
- クエリが変数に格納されます (`selectCommand`) に直接クエリを渡す前に、;、`db.Query`メソッド。
- 呼び出すと、`db.Query`値のプレース ホルダーを使用して、クエリの両方に合格するメソッド。 (クエリに複数のプレース ホルダーがある場合、それらを渡すと、メソッドに個別の値としてすべてです)。

これらすべての要素を一緒に配置した場合、次のコードを取得します。

[!code-csharp[Main](form-basics/samples/sample5.cs)]

> [!NOTE] 
> 
> **重要**。 プレース ホルダーを使用して (のように`@0`) は SQL コマンドに値を渡す*非常に重要な*セキュリティ。 ここに表示、変数のデータのプレース ホルダーでは、唯一の方法は SQL コマンドを構築する必要があります。
> 
> ありません (連結) のリテラル テキストと、ユーザーから取得した値、まとめて配置することで、SQL ステートメントを構築します。 サイトに SQL ステートメントにユーザー入力の連結が表示されます、 *SQL インジェクション攻撃を受ける*悪意のあるユーザーが、データベースをハッキングするページに値を送信します。 (詳細、情報の記事で[SQL インジェクション](https://msdn.microsoft.com/library/ms161953.aspx)MSDN web サイトです)。


## <a name="updating-the-movies-page-with-search-code"></a>コードの検索と映画 ページを更新しています

内のコードを更新することができますので、 *Movies.cshtml*ファイル。 を開始するには、このコードで、ページの上部にあるコード ブロック内のコードを置き換えます。

[!code-csharp[Main](form-basics/samples/sample6.cs)]

ここでの違いは、このクエリを入力したこと、`selectCommand`に渡す変数`db.Query`以降。 変数に、SQL ステートメントを配置するには、検索を実行するために何がであると、ステートメントを変更することができます。

またを戻すで後で次の 2 行を削除しました。

[!code-csharp[Main](form-basics/samples/sample7.cs)]

まだ、クエリを実行する (つまり、呼び出す`db.Query`) を初期化して、`WebGrid`まだヘルパー。 SQL ステートメントを実行する必要がありますを決定した後、それらを実行します。

書き換えられたこのブロックの後に、検索を処理するための新しいロジックを追加できます。 完成したコードは、次のようになります。 この例に一致するように、ページのコードを更新します。

[!code-cshtml[Main](form-basics/samples/sample8.cshtml)]

ページは、次のようにここでは動作します。 ページが実行するたびに、コードは、データベースを開きます、`selectCommand`からすべてのレコードを取得する SQL ステートメントに変数が設定されている、`Movies`テーブル。 また、コードを初期化、`searchTerm`変数。

ただし、現在の要求の値が含まれる場合、`searchGenre`要素では、コード セット`selectCommand`、別のクエリに-が含まれるいずれかを具体的には、`Where`ジャンルを検索する句。 また、設定`searchTerm`(可能性のある何も)、検索ボックスに渡されたものにします。

ステートメントが、SQL に関係なく`selectCommand`、コードを呼び出して`db.Query`、クエリを実行するには渡す任意`searchTerm`します。 場合に何もない`searchTerm`、ともかく、その場合に値を渡すためのパラメーターがないため`selectCommand`します。

コードの最後に、初期化、`WebGrid`までと同様、クエリ結果を使用してヘルパー。

SQL ステートメントを配置することで表示することができ、変数に検索用語と、柔軟性、コードに追加しています。 このチュートリアルの後半で後ほど説明するよう、この基本的なフレームワークを使用し、さまざまな種類の検索ロジックを追加し続けます。

## <a name="testing-the-search-by-genre-feature"></a>検索-ジャンルで機能をテスト

WebMatrix で、実行、 *Movies.cshtml*ページ。 ジャンルのテキスト ボックスにページが表示されます。

をクリックして、テスト記録の 1 つの入力をジャンルの入力**検索**します。 この時間だけそのジャンルと一致するムービーの一覧が表示します。

![Comedies' genre' の検索後にリストされているビデオ ページ](form-basics/_static/image4.png)

別のジャンルを入力し、もう一度検索します。 検索では大文字小文字が区別されないことが表示されるため、すべて小文字または大文字の文字を使用して、ジャンルを入力してください。

## <a name="remembering-what-the-user-entered"></a>ユーザーが入力した「記憶」

お気付きかもしれませんが、ジャンルを入力し、クリックした後に**検索ジャンル**ジャンルの一覧を表示します。 ただし、検索テキスト ボックスが空&mdash;言い換えること、忘れていた入力しています。

この動作が発生した理由を理解しておく必要があります。 ページを送信するときに、ブラウザーは、web サーバーに要求を送信します。 ASP.NET が要求を取得すると、コードを実行、および、ブラウザーにページを再度表示しますがページの新しいインスタンスを作成します。 実際には、ただし、ページを知らない自体の以前のバージョンでの操作だけですが。 いくつか含まれていた要求を受け取りましたがわかっているすべては、これでデータを形成します。

ページを要求するたびに&mdash;かどうか、最初に、または送信することによって&mdash;新しいページを取得します。 Web サーバーには、最後の要求のメモリがありません。 ありません ASP.NET、およびブラウザーありません。 ページのこれらの異なるインスタンス間の唯一の接続は、それらの間で送信するすべてのデータです。 ページを送信すると、たとえば、新しい page インスタンスは以前のインスタンスから送信されたフォーム データを取得できます。 (ページ間でデータをやりとりする別の方法は、cookie を使用するのには) です。

このような状況を記述する正式な方法は、web ページがあると答えて*ステートレス*します。 Web サーバーと、ページ自体と、ページ内の要素では、ページの以前の状態に関する情報は保持されません。 Web は、個々 の要求の状態を維持するとすばやくのリソースを枯渇 web サーバーは、多くの場合、おそらく何千を処理も数千秒あたりの要求のため、この方法を設計されました。

それが理由のテキスト ボックスが空でした。 ページを送信した後、ASP.NET は、ページの新しいインスタンスを作成し、コードとマークアップを実行します。 テキスト ボックスに値を格納する ASP.NET に指示したこのコードで何があります。 ASP.NET しなかったため、何もと内の値を指定せずにテキスト ボックスが表示されました。

実際にこの問題を回避する簡単な方法があります。 テキスト ボックスに入力したジャンル*は*コードで使用可能な&mdash;内にある`Request.QueryString["searchGenre"]`します。

テキスト ボックスのマークアップを更新できるように、`value`属性から値を取得する`searchTerm`などの次の例。

[!code-html[Main](form-basics/samples/sample9.html?highlight=1)]

このページで設定することがも、`value`属性を`searchTerm`その変数にも、ジャンルが含まれているので、変数を入力します。 使用していますが、`Request`を設定するオブジェクト、`value`属性ようこのタスクを実行する標準的な方法を次に示します。 (これを行う必要がある場合&mdash;状況によっては、ページをレンダリングする場合があります*せず*フィールドの値。 ェケェルェニェマォウーォノェボナ アプリで何が起こっています。)

> [!NOTE]
> 「思い出せない」パスワードを使用するテキスト ボックスの値。 コードを使用して、[パスワード] フィールドに入力できるようにする、セキュリティ ホールがあります。


ページを再度実行し、ジャンルを入力し、クリックして**検索ジャンル**します。 この時間だけでなくは表示、検索の結果がテキスト ボックスでは、前回の入力は記憶。

![ページのことを示すテキスト ボックスが '記憶' 前のエントリ](form-basics/_static/image5.png)

## <a name="searching-for-any-word-in-the-title"></a>タイトルの任意の単語の検索

すべてのジャンルを検索できますようになりましたが、タイトルを検索する場合がありますも。 検索すると、そのため、タイトル内で任意の場所に表示される単語を検索することができます、タイトルを正確に取得するには、困難です。 SQL にするには、使用する、`LIKE`演算子と構文、次のようにします。

`SELECT * FROM Movies WHERE Title LIKE '%adventure%'`

このコマンドは、タイトルが"adventure"を含むすべての映画を取得します。 使用すると、`LIKE`オペレーターは、ワイルドカード文字を含める`%`検索語句の一部として。 検索`LIKE 'adventure%'`「'adventure' で始まる」ことを意味します。 (技術的には、その意味「文字列 'adventure' の後に何か」)同様に、検索語句`LIKE '%adventure'`「'adventure' で終了するまで」に別の方法が「何も後に文字列 'adventure'」を意味します。

検索語句`LIKE '%adventure%'`のためことを意味します""adventure' タイトルにします"。 (技術的には、「何も 'adventure'、何も後に続く、タイトルにします。」)

内で、`<form>`要素、終了のすぐ下にある次のマークアップを追加`</div>`ジャンル検索用のタグ (閉じる`</form>`要素)。

[!code-html[Main](form-basics/samples/sample10.html)]

アセンブルする必要があることを除き、この検索を処理するコードはジャンルの検索では、コードのように、`LIKE`検索します。 ページの上部にあるコード ブロック内でこれを追加`if`ブロックの直後、`if`ジャンル検索のブロック。

[!code-csharp[Main](form-basics/samples/sample11.cs)]

検索を使用する点を除いて、このコードが、前述のと同じロジックを使用して、`LIKE`演算子と、コードを配置"`%`"検索語句の前後にします。

別の検索ページを追加する簡単な方法に注意してください。 行う必要があるすべてでした。

- 作成、`if`関連する検索ボックスに、値があったかどうかを確認するテストをブロックします。
- 設定、`selectCommand`変数を新しい SQL ステートメントにします。
- 設定、`searchTerm`変数をクエリに渡す値。

タイトルの検索の新しいロジックを含む完全なコード ブロックを次に示します。

[!code-cshtml[Main](form-basics/samples/sample12.cshtml)]

このコードの動作の概要を次に示します。

- 変数`searchTerm`と`selectCommand`上部にある初期化されます。 適切な検索用語 (ある場合) にこれらの変数を設定しようとしているし、適切な SQL コマンドが、ユーザーがページにはに基づいています。 既定の検索は、データベースからすべての映画を取得する単純なケースです。
- テストで`searchGenre`と`searchTitle`、コード セット`searchTerm`を検索する値。 それらのコード ブロックの設定も`selectCommand`検索条件に該当する SQL コマンド。
- `db.Query`メソッドが 1 回だけ呼び出されるのすべての SQL コマンドを使用して`selectedCommand`であり、どのような値`searchTerm`します。 検索用語 (ありませんジャンルとないタイトル word) が存在しない場合の値`searchTerm`空の文字列します。 ただし、重要ではない、クエリにパラメーターを必要としない場合ので。

## <a name="testing-the-title-search-feature"></a>タイトルの検索機能をテストします。

これで、検索が完了しました ページをテストできます。 実行*Movies.cshtml*します。

ジャンルを入力し、クリックして**検索ジャンル**します。 グリッドには、前のように映画のジャンルが表示されます。

タイトルの単語を入力し、クリックして**検索タイトル**します。 グリッドでは、映画のタイトルにその単語を表示します。

![ムービー ページのタイトルに '、' の検索後に一覧表示](form-basics/_static/image6.png)

両方のテキスト ボックスを空白のままにして、いずれかのボタンをクリックします。 グリッドには、すべての映画が表示されます。

## <a name="combining-the-queries"></a>クエリの結合

検索を行うことができますが排他的なことに注意してください可能性があります。 両方の検索ボックスに値がある場合でも、同時に、タイトル、ジャンルを検索できません。 たとえば、肩書きが"Adventure"を含むすべてのアクション映画を検索できません。 (ジャンルとタイトルの両方の値を入力する場合、ページが次に、コード、タイトルの検索を優先順位)条件を結合する検索を作成するには、次のような構文を含む SQL クエリを作成する必要があります。

`SELECT * FROM Movies WHERE Genre = @0 AND Title LIKE @1`

次のようなステートメントを使用してクエリを実行する必要があり、(大まかに言うと)。

`var selectedData = db.Query(selectCommand, searchGenre, searchTitle);`

検索条件の多くの順列を許可するロジックを作成する参加すればする少し、ご覧のとおりです。 そのため、私たちを終了します。

## <a name="coming-up-next"></a>次回について

次のチュートリアルでは、ユーザーがムービーをデータベースに追加できるようにフォームを使用するページを作成します。

## <a name="complete-listing-for-movie-page-updated-with-search"></a>(検索と更新) ムービー ページ全体を示します

[!code-cshtml[Main](form-basics/samples/sample13.cshtml)]

## <a name="additional-resources"></a>その他のリソース

- [Razor 構文を使用して ASP.NET Web プログラミングの概要](https://go.microsoft.com/fwlink/?LinkID=202890)
- [SQL の WHERE 句](http://www.w3schools.com/sql/sql_where.asp)W3Schools サイト
- [メソッド定義](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html)W3C サイトの記事「

> [!div class="step-by-step"]
> [前へ](displaying-data.md)
> [次へ](entering-data.md)
