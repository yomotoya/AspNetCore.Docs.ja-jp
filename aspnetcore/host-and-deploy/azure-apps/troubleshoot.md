---
title: Azure App Service での ASP.NET Core 起動エラーのトラブルシューティング
author: guardrex
description: ASP.NET Core Azure App Service の配置に関する問題を診断する方法を学習します。
ms.author: riande
ms.custom: mvc
ms.date: 10/24/2018
uid: host-and-deploy/azure-apps/troubleshoot
ms.openlocfilehash: 05bb024f5b0d2b554cc861c250a92fd7ae23437f
ms.sourcegitcommit: 4d74644f11e0dac52b4510048490ae731c691496
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/25/2018
ms.locfileid: "50090746"
---
# <a name="troubleshoot-aspnet-core-on-azure-app-service"></a><span data-ttu-id="50093-103">Azure App Service での ASP.NET Core のトラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="50093-103">Troubleshoot ASP.NET Core on Azure App Service</span></span>

<span data-ttu-id="50093-104">作成者: [Luke Latham](https://github.com/guardrex)</span><span class="sxs-lookup"><span data-stu-id="50093-104">By [Luke Latham](https://github.com/guardrex)</span></span>

[!INCLUDE [Azure App Service Preview Notice](../../includes/azure-apps-preview-notice.md)]

<span data-ttu-id="50093-105">この記事では、Azure App Service の診断ツールを使って ASP.NET Core アプリの起動時の問題を診断する方法の手順を説明します。</span><span class="sxs-lookup"><span data-stu-id="50093-105">This article provides instructions on how to diagnose an ASP.NET Core app startup issue using Azure App Service's diagnostic tools.</span></span> <span data-ttu-id="50093-106">トラブルシューティングの役に立つ他の情報については、Azure ドキュメントの「[Azure App Service 診断の概要](/azure/app-service/app-service-diagnostics)」および「[Azure App Service でアプリを監視する方法](/azure/app-service/web-sites-monitor)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="50093-106">For additional troubleshooting advice, see [Azure App Service diagnostics overview](/azure/app-service/app-service-diagnostics) and [How to: Monitor Apps in Azure App Service](/azure/app-service/web-sites-monitor) in the Azure documentation.</span></span>

## <a name="app-startup-errors"></a><span data-ttu-id="50093-107">アプリ起動時のエラー</span><span class="sxs-lookup"><span data-stu-id="50093-107">App startup errors</span></span>

<span data-ttu-id="50093-108">**502.5 処理エラー**</span><span class="sxs-lookup"><span data-stu-id="50093-108">**502.5 Process Failure**</span></span>  
<span data-ttu-id="50093-109">ワーカー プロセスが失敗します。</span><span class="sxs-lookup"><span data-stu-id="50093-109">The worker process fails.</span></span> <span data-ttu-id="50093-110">アプリは起動しません。</span><span class="sxs-lookup"><span data-stu-id="50093-110">The app doesn't start.</span></span>

<span data-ttu-id="50093-111">[ASP.NET Core モジュール](xref:fundamentals/servers/aspnet-core-module)はワーカー プロセスの開始を試みますが、開始に失敗します。</span><span class="sxs-lookup"><span data-stu-id="50093-111">The [ASP.NET Core Module](xref:fundamentals/servers/aspnet-core-module) attempts to start the worker process but it fails to start.</span></span> <span data-ttu-id="50093-112">この種の問題のトラブルシューティングには、アプリケーション イベント ログを調べると役に立つことがよくあります。</span><span class="sxs-lookup"><span data-stu-id="50093-112">Examining the Application Event Log often helps troubleshoot this type of problem.</span></span> <span data-ttu-id="50093-113">ログへのアクセスについては、「[アプリケーション イベント ログ](#application-event-log)」セクションで説明します。</span><span class="sxs-lookup"><span data-stu-id="50093-113">Accessing the log is explained in the [Application Event Log](#application-event-log) section.</span></span>

<span data-ttu-id="50093-114">正しく構成されていないアプリによりワーカー プロセスが失敗する場合、"*502.5 処理エラー*" のエラー ページが返されます。</span><span class="sxs-lookup"><span data-stu-id="50093-114">The *502.5 Process Failure* error page is returned when a misconfigured app causes the worker process to fail:</span></span>

![502.5 処理エラー ページが表示されているブラウザー ウィンドウ](troubleshoot/_static/process-failure-page.png)

<span data-ttu-id="50093-116">**500 内部サーバー エラー**</span><span class="sxs-lookup"><span data-stu-id="50093-116">**500 Internal Server Error**</span></span>  
<span data-ttu-id="50093-117">アプリは起動しますが、エラーのためにサーバーは要求を実行できません。</span><span class="sxs-lookup"><span data-stu-id="50093-117">The app starts, but an error prevents the server from fulfilling the request.</span></span>

<span data-ttu-id="50093-118">このエラーは、起動時または応答の作成中に、アプリのコード内で発生します。</span><span class="sxs-lookup"><span data-stu-id="50093-118">This error occurs within the app's code during startup or while creating a response.</span></span> <span data-ttu-id="50093-119">応答にコンテンツが含まれていないか、またはブラウザーに "*500 内部サーバー エラー*" という応答が表示される可能性があります。</span><span class="sxs-lookup"><span data-stu-id="50093-119">The response may contain no content, or the response may appear as a *500 Internal Server Error* in the browser.</span></span> <span data-ttu-id="50093-120">通常、アプリケーション イベント ログではアプリが正常に起動したことが示されます。</span><span class="sxs-lookup"><span data-stu-id="50093-120">The Application Event Log usually states that the app started normally.</span></span> <span data-ttu-id="50093-121">サーバーから見るとそれは正しいことです。</span><span class="sxs-lookup"><span data-stu-id="50093-121">From the server's perspective, that's correct.</span></span> <span data-ttu-id="50093-122">アプリは起動しましたが、有効な応答を生成できません。</span><span class="sxs-lookup"><span data-stu-id="50093-122">The app did start, but it can't generate a valid response.</span></span> <span data-ttu-id="50093-123">問題のトラブルシューティングを行うには、[Kudu コンソールでアプリを実行する](#run-the-app-in-the-kudu-console)か、または [ASP.NET Core モジュールの stdout ログを有効にします](#aspnet-core-module-stdout-log)。</span><span class="sxs-lookup"><span data-stu-id="50093-123">[Run the app in the Kudu console](#run-the-app-in-the-kudu-console) or [enable the ASP.NET Core Module stdout log](#aspnet-core-module-stdout-log) to troubleshoot the problem.</span></span>

<span data-ttu-id="50093-124">**接続のリセット**</span><span class="sxs-lookup"><span data-stu-id="50093-124">**Connection reset**</span></span>

<span data-ttu-id="50093-125">ヘッダー送信後にエラーが発生した場合、サーバーが **500 内部サーバー エラー**を送信するには遅すぎます。</span><span class="sxs-lookup"><span data-stu-id="50093-125">If an error occurs after the headers are sent, it's too late for the server to send a **500 Internal Server Error** when an error occurs.</span></span> <span data-ttu-id="50093-126">このような状況は、応答に対する複雑なオブジェクトのシリアル化中にエラーが起きたときによく発生します。</span><span class="sxs-lookup"><span data-stu-id="50093-126">This often happens when an error occurs during the serialization of complex objects for a response.</span></span> <span data-ttu-id="50093-127">この種のエラーは、クライアントでは "*接続リセット*" エラーとして表示されます。</span><span class="sxs-lookup"><span data-stu-id="50093-127">This type of error appears as a *connection reset* error on the client.</span></span> <span data-ttu-id="50093-128">この種のエラーのトラブルシューティングには、[アプリケーション ログ](xref:fundamentals/logging/index)が役に立つことがあります。</span><span class="sxs-lookup"><span data-stu-id="50093-128">[Application logging](xref:fundamentals/logging/index) can help troubleshoot these types of errors.</span></span>

## <a name="default-startup-limits"></a><span data-ttu-id="50093-129">既定の起動制限</span><span class="sxs-lookup"><span data-stu-id="50093-129">Default startup limits</span></span>

<span data-ttu-id="50093-130">ASP.NET Core モジュールの *startupTimeLimit* は、既定では 120 秒に構成されます。</span><span class="sxs-lookup"><span data-stu-id="50093-130">The ASP.NET Core Module is configured with a default *startupTimeLimit* of 120 seconds.</span></span> <span data-ttu-id="50093-131">既定値のままにした場合、モジュールで処理エラーが記録されるまでに、アプリは最大で 2 分を起動にかけることができます。</span><span class="sxs-lookup"><span data-stu-id="50093-131">When left at the default value, an app may take up to two minutes to start before the module logs a process failure.</span></span> <span data-ttu-id="50093-132">モジュールの構成の詳細については、「[AspNetCore 要素の属性](xref:host-and-deploy/aspnet-core-module#attributes-of-the-aspnetcore-element)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="50093-132">For information on configuring the module, see [Attributes of the aspNetCore element](xref:host-and-deploy/aspnet-core-module#attributes-of-the-aspnetcore-element).</span></span>

## <a name="troubleshoot-app-startup-errors"></a><span data-ttu-id="50093-133">アプリの起動エラーのトラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="50093-133">Troubleshoot app startup errors</span></span>

### <a name="application-event-log"></a><span data-ttu-id="50093-134">アプリケーション イベント ログ</span><span class="sxs-lookup"><span data-stu-id="50093-134">Application Event Log</span></span>

<span data-ttu-id="50093-135">アプリケーション イベント ログにアクセスするには、Azure portal の **[問題の診断と解決]** ブレードを使います。</span><span class="sxs-lookup"><span data-stu-id="50093-135">To access the Application Event Log, use the **Diagnose and solve problems** blade in the Azure portal :</span></span>

1. <span data-ttu-id="50093-136">Azure portal の **[App Services]** ブレードで、アプリのブレードを開きます。</span><span class="sxs-lookup"><span data-stu-id="50093-136">In the Azure portal, open the app's blade in the **App Services** blade.</span></span>
1. <span data-ttu-id="50093-137">**[問題の診断と解決]** ブレードを選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-137">Select the **Diagnose and solve problems** blade.</span></span>
1. <span data-ttu-id="50093-138">**[SELECT PROBLEM CATEGORY]\(問題カテゴリの選択\)** で、**[Web App Down]\(Web アプリのダウン\)** ボタンを選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-138">Under **SELECT PROBLEM CATEGORY**, select the **Web App Down** button.</span></span>
1. <span data-ttu-id="50093-139">**[Suggested Solutions]\(推奨される解決方法\)** で、, open the pane for **[Open Application Event Logs]\(アプリケーション イベント ログを開く\)** のウィンドウを開きます。</span><span class="sxs-lookup"><span data-stu-id="50093-139">Under **Suggested Solutions**, open the pane for **Open Application Event Logs**.</span></span> <span data-ttu-id="50093-140">**[Open Application Event Logs]\(アプリケーション イベント ログを開く\)** ボタンを選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-140">Select the **Open Application Event Logs** button.</span></span>
1. <span data-ttu-id="50093-141">**[Source]\(ソース\)** 列で、*IIS AspNetCoreModule* によって提供された最新のエラーを調べます。</span><span class="sxs-lookup"><span data-stu-id="50093-141">Examine the latest error provided by the *IIS AspNetCoreModule* in the **Source** column.</span></span>

<span data-ttu-id="50093-142">**[問題の診断と解決]** ブレードを使う代わりに、[Kudu](https://github.com/projectkudu/kudu/wiki) を使ってアプリケーション イベント ログ ファイルを直接調べることもできます。</span><span class="sxs-lookup"><span data-stu-id="50093-142">An alternative to using the **Diagnose and solve problems** blade is to examine the Application Event Log file directly using [Kudu](https://github.com/projectkudu/kudu/wiki):</span></span>

1. <span data-ttu-id="50093-143">**[開発ツール]** 領域で **[高度なツール]** ブレードを選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-143">Select the **Advanced Tools** blade in the **DEVELOPMENT TOOLS** area.</span></span> <span data-ttu-id="50093-144">**[Go&rarr;]** ボタンを選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-144">Select the **Go&rarr;** button.</span></span> <span data-ttu-id="50093-145">新しいブラウザー タブまたはウィンドウで Kudu コンソールが開きます。</span><span class="sxs-lookup"><span data-stu-id="50093-145">The Kudu console opens in a new browser tab or window.</span></span>
1. <span data-ttu-id="50093-146">ページの上部にあるナビゲーション バーを使って **[デバッグ コンソール]** を開き、**[CMD]** を選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-146">Using the navigation bar at the top of the page, open **Debug console** and select **CMD**.</span></span>
1. <span data-ttu-id="50093-147">**LogFiles** フォルダーを開きます。</span><span class="sxs-lookup"><span data-stu-id="50093-147">Open the **LogFiles** folder.</span></span>
1. <span data-ttu-id="50093-148">*eventlog.xml* ファイルの横にある鉛筆アイコンを選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-148">Select the pencil icon next to the *eventlog.xml* file.</span></span>
1. <span data-ttu-id="50093-149">ログを調べます。</span><span class="sxs-lookup"><span data-stu-id="50093-149">Examine the log.</span></span> <span data-ttu-id="50093-150">ログの末尾までスクロールし、最新のイベントを確認します。</span><span class="sxs-lookup"><span data-stu-id="50093-150">Scroll to the bottom of the log to see the most recent events.</span></span>

### <a name="run-the-app-in-the-kudu-console"></a><span data-ttu-id="50093-151">Kudu コンソールでアプリを実行します。</span><span class="sxs-lookup"><span data-stu-id="50093-151">Run the app in the Kudu console</span></span>

<span data-ttu-id="50093-152">多くの起動時エラーでは、アプリケーション イベント ログに役に立つ情報が生成されません。</span><span class="sxs-lookup"><span data-stu-id="50093-152">Many startup errors don't produce useful information in the Application Event Log.</span></span> <span data-ttu-id="50093-153">[Kudu](https://github.com/projectkudu/kudu/wiki) のリモート実行コンソールでアプリを実行すると、エラーを検出することができます。</span><span class="sxs-lookup"><span data-stu-id="50093-153">You can run the app in the [Kudu](https://github.com/projectkudu/kudu/wiki) Remote Execution Console to discover the error:</span></span>

1. <span data-ttu-id="50093-154">**[開発ツール]** 領域で **[高度なツール]** ブレードを選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-154">Select the **Advanced Tools** blade in the **DEVELOPMENT TOOLS** area.</span></span> <span data-ttu-id="50093-155">**[Go&rarr;]** ボタンを選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-155">Select the **Go&rarr;** button.</span></span> <span data-ttu-id="50093-156">新しいブラウザー タブまたはウィンドウで Kudu コンソールが開きます。</span><span class="sxs-lookup"><span data-stu-id="50093-156">The Kudu console opens in a new browser tab or window.</span></span>
1. <span data-ttu-id="50093-157">ページの上部にあるナビゲーション バーを使って **[デバッグ コンソール]** を開き、**[CMD]** を選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-157">Using the navigation bar at the top of the page, open **Debug console** and select **CMD**.</span></span>
1. <span data-ttu-id="50093-158">パス **site** > **wwwroot** へのフォルダーを開きます。</span><span class="sxs-lookup"><span data-stu-id="50093-158">Open the folders to the path **site** > **wwwroot**.</span></span>
1. <span data-ttu-id="50093-159">コンソールで、アプリのアセンブリを実行することによってアプリを実行します。</span><span class="sxs-lookup"><span data-stu-id="50093-159">In the console, run the app by executing the app's assembly.</span></span>
   * <span data-ttu-id="50093-160">アプリが[フレームワークに依存する展開](/dotnet/core/deploying/#framework-dependent-deployments-fdd)である場合、*dotnet.exe* を使ってアプリのアセンブリを実行します。</span><span class="sxs-lookup"><span data-stu-id="50093-160">If the app is a [framework-dependent deployment](/dotnet/core/deploying/#framework-dependent-deployments-fdd), run the app's assembly with *dotnet.exe*.</span></span> <span data-ttu-id="50093-161">次のコマンドで、`<assembly_name>` をアプリのアセンブリの名前に置き換えます。`dotnet .\<assembly_name>.dll`</span><span class="sxs-lookup"><span data-stu-id="50093-161">In the following command, substitute the name of the app's assembly for `<assembly_name>`: `dotnet .\<assembly_name>.dll`</span></span>
   * <span data-ttu-id="50093-162">アプリが[自己完結型の展開](/dotnet/core/deploying/#self-contained-deployments-scd)である場合は、アプリの実行可能ファイルを実行します。</span><span class="sxs-lookup"><span data-stu-id="50093-162">If the app is a [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd), run the app's executable.</span></span> <span data-ttu-id="50093-163">次のコマンドで、`<assembly_name>` をアプリのアセンブリの名前に置き換えます。`<assembly_name>.exe`</span><span class="sxs-lookup"><span data-stu-id="50093-163">In the following command, substitute the name of the app's assembly for `<assembly_name>`: `<assembly_name>.exe`</span></span>
1. <span data-ttu-id="50093-164">エラーを示すアプリからのコンソール出力はすべて、Kudu コンソールにパイプされます。</span><span class="sxs-lookup"><span data-stu-id="50093-164">The console output from the app, showing any errors, is piped to the Kudu console.</span></span>

### <a name="aspnet-core-module-stdout-log"></a><span data-ttu-id="50093-165">ASP.NET Core モジュールの stdout ログ</span><span class="sxs-lookup"><span data-stu-id="50093-165">ASP.NET Core Module stdout log</span></span>

<span data-ttu-id="50093-166">ASP.NET Core モジュールの stdout には、アプリケーション イベント ログでは見つからない有用なエラー メッセージが記録されることがよくあります。</span><span class="sxs-lookup"><span data-stu-id="50093-166">The ASP.NET Core Module stdout log often records useful error messages not found in the Application Event Log.</span></span> <span data-ttu-id="50093-167">stdout ログを有効にして表示するには:</span><span class="sxs-lookup"><span data-stu-id="50093-167">To enable and view stdout logs:</span></span>

1. <span data-ttu-id="50093-168">Azure portal で **[問題の診断と解決]** ブレードに移動します。</span><span class="sxs-lookup"><span data-stu-id="50093-168">Navigate to the **Diagnose and solve problems** blade in the Azure portal.</span></span>
1. <span data-ttu-id="50093-169">**[SELECT PROBLEM CATEGORY]\(問題カテゴリの選択\)** で、**[Web App Down]\(Web アプリのダウン\)** ボタンを選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-169">Under **SELECT PROBLEM CATEGORY**, select the **Web App Down** button.</span></span>
1. <span data-ttu-id="50093-170">**[Suggested Solutions]\(推奨される解決方法\)** > **[Enable Stdout Log Redirection]\(Stdout ログのリダイレクトを有効にする\)** で、ボタンをクリックして **[Open Kudu Console to edit Web.Config]\(Kudu コンソールを開いて Web.Config を編集する\)** ボタンを選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-170">Under **Suggested Solutions** > **Enable Stdout Log Redirection**, select the button to **Open Kudu Console to edit Web.Config**.</span></span>
1. <span data-ttu-id="50093-171">Kudu の**診断コンソール**で、パス **site** > **wwwroot** へのフォルダーを開きます。</span><span class="sxs-lookup"><span data-stu-id="50093-171">In the Kudu **Diagnostic Console**, open the folders to the path **site** > **wwwroot**.</span></span> <span data-ttu-id="50093-172">下にスクロールして、一覧の最後にある *web.config* ファイルを表示します。</span><span class="sxs-lookup"><span data-stu-id="50093-172">Scroll down to reveal the *web.config* file at the bottom of the list.</span></span>
1. <span data-ttu-id="50093-173">*web.config* ファイルの隣の鉛筆アイコンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="50093-173">Click the pencil icon next to the *web.config* file.</span></span>
1. <span data-ttu-id="50093-174">**stdoutLogEnabled** を `true` に設定し、**stdoutLogFile** パスを `\\?\%home%\LogFiles\stdout` に変更します。</span><span class="sxs-lookup"><span data-stu-id="50093-174">Set **stdoutLogEnabled** to `true` and change the **stdoutLogFile** path to: `\\?\%home%\LogFiles\stdout`.</span></span>
1. <span data-ttu-id="50093-175">**[保存]** を選んで、更新した *web.config* ファイルを保存します。</span><span class="sxs-lookup"><span data-stu-id="50093-175">Select **Save** to save the updated *web.config* file.</span></span>
1. <span data-ttu-id="50093-176">アプリに対して要求します。</span><span class="sxs-lookup"><span data-stu-id="50093-176">Make a request to the app.</span></span>
1. <span data-ttu-id="50093-177">Azure portal に戻ります。</span><span class="sxs-lookup"><span data-stu-id="50093-177">Return to the Azure portal.</span></span> <span data-ttu-id="50093-178">**[開発ツール]** 領域で **[高度なツール]** ブレードを選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-178">Select the **Advanced Tools** blade in the **DEVELOPMENT TOOLS** area.</span></span> <span data-ttu-id="50093-179">**[Go&rarr;]** ボタンを選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-179">Select the **Go&rarr;** button.</span></span> <span data-ttu-id="50093-180">新しいブラウザー タブまたはウィンドウで Kudu コンソールが開きます。</span><span class="sxs-lookup"><span data-stu-id="50093-180">The Kudu console opens in a new browser tab or window.</span></span>
1. <span data-ttu-id="50093-181">ページの上部にあるナビゲーション バーを使って **[デバッグ コンソール]** を開き、**[CMD]** を選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-181">Using the navigation bar at the top of the page, open **Debug console** and select **CMD**.</span></span>
1. <span data-ttu-id="50093-182">**LogFiles** フォルダーを選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-182">Select the **LogFiles** folder.</span></span>
1. <span data-ttu-id="50093-183">**[Modified]\(変更日\)** 列を調べて、変更日が最新の stdout ログの鉛筆アイコンを選んで編集します。</span><span class="sxs-lookup"><span data-stu-id="50093-183">Inspect the **Modified** column and select the pencil icon to edit the stdout log with the latest modification date.</span></span>
1. <span data-ttu-id="50093-184">ログ ファイルが開くと、エラーが表示されます。</span><span class="sxs-lookup"><span data-stu-id="50093-184">When the log file opens, the error is displayed.</span></span>

<span data-ttu-id="50093-185">**重要**。</span><span class="sxs-lookup"><span data-stu-id="50093-185">**Important!**</span></span> <span data-ttu-id="50093-186">トラブルシューティングが完了したら、stdout ログを無効にします。</span><span class="sxs-lookup"><span data-stu-id="50093-186">Disable stdout logging when troubleshooting is complete.</span></span>

1. <span data-ttu-id="50093-187">Kudu の**診断コンソール** で、パス **site** > **wwwroot** に戻り、*web.config* ファイルを表示します。</span><span class="sxs-lookup"><span data-stu-id="50093-187">In the Kudu **Diagnostic Console**, return to the path **site** > **wwwroot** to reveal the *web.config* file.</span></span> <span data-ttu-id="50093-188">鉛筆アイコンを選んで **web.config** ファイルを再び開きます。</span><span class="sxs-lookup"><span data-stu-id="50093-188">Open the **web.config** file again by selecting the pencil icon.</span></span>
1. <span data-ttu-id="50093-189">**stdoutLogEnabled** を `false` に設定します。</span><span class="sxs-lookup"><span data-stu-id="50093-189">Set **stdoutLogEnabled** to `false`.</span></span>
1. <span data-ttu-id="50093-190">**[保存]** を選んでファイルを保存します。</span><span class="sxs-lookup"><span data-stu-id="50093-190">Select **Save** to save the file.</span></span>

> [!WARNING]
> <span data-ttu-id="50093-191">stdout ログを無効にしないと、アプリまたはサーバーで障害が発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="50093-191">Failure to disable the stdout log can lead to app or server failure.</span></span> <span data-ttu-id="50093-192">ログ ファイルのサイズまたは作成されるログ ファイルの数に制限はありません。</span><span class="sxs-lookup"><span data-stu-id="50093-192">There's no limit on log file size or the number of log files created.</span></span> <span data-ttu-id="50093-193">stdout ログは、アプリ起動時の問題のトラブルシューティングにのみ使ってください。</span><span class="sxs-lookup"><span data-stu-id="50093-193">Only use stdout logging to troubleshoot app startup problems.</span></span>
>
> <span data-ttu-id="50093-194">起動後の ASP.NET Core アプリでの一般的なログの場合は、ログ ファイルのサイズを制限し、ログをローテーションするログ ライブラリを使います。</span><span class="sxs-lookup"><span data-stu-id="50093-194">For general logging in an ASP.NET Core app after startup, use a logging library that limits log file size and rotates logs.</span></span> <span data-ttu-id="50093-195">詳しくは、「[サードパーティ製のログ プロバイダー](xref:fundamentals/logging/index#third-party-logging-providers)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="50093-195">For more information, see [third-party logging providers](xref:fundamentals/logging/index#third-party-logging-providers).</span></span>

## <a name="common-startup-errors"></a><span data-ttu-id="50093-196">起動時の一般的なエラー</span><span class="sxs-lookup"><span data-stu-id="50093-196">Common startup errors</span></span> 

<span data-ttu-id="50093-197">以下を参照してください。<xref:host-and-deploy/azure-iis-errors-reference></span><span class="sxs-lookup"><span data-stu-id="50093-197">See <xref:host-and-deploy/azure-iis-errors-reference>.</span></span> <span data-ttu-id="50093-198">このリファレンス トピックでは、アプリの起動を妨げる一般的な問題のほとんどが説明されています。</span><span class="sxs-lookup"><span data-stu-id="50093-198">Most of the common problems that prevent app startup are covered in the reference topic.</span></span>

## <a name="slow-or-hanging-app"></a><span data-ttu-id="50093-199">アプリの速度低下またはハング</span><span class="sxs-lookup"><span data-stu-id="50093-199">Slow or hanging app</span></span>

<span data-ttu-id="50093-200">要求に対してアプリの応答が遅いとき、またはアプリがハングするときのデバッグ ガイダンスについては、「[Azure App Service での Web アプリのパフォーマンス低下に関する問題のトラブルシューティング](/azure/app-service/app-service-web-troubleshoot-performance-degradation)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="50093-200">When an app responds slowly or hangs on a request, see [Troubleshoot slow web app performance issues in Azure App Service](/azure/app-service/app-service-web-troubleshoot-performance-degradation) for debugging guidance.</span></span>

## <a name="remote-debugging"></a><span data-ttu-id="50093-201">リモート デバッグ</span><span class="sxs-lookup"><span data-stu-id="50093-201">Remote debugging</span></span>

<span data-ttu-id="50093-202">次のトピックを参照してください。</span><span class="sxs-lookup"><span data-stu-id="50093-202">See the following topics:</span></span>

* <span data-ttu-id="50093-203">[「Visual Studio を使用した Azure App Service のトラブルシューティング」の「Web アプリのリモート デバッグ」セクション](/azure/app-service/web-sites-dotnet-troubleshoot-visual-studio#remotedebug) (Azure ドキュメント)</span><span class="sxs-lookup"><span data-stu-id="50093-203">[Remote debugging web apps section of Troubleshoot a web app in Azure App Service using Visual Studio](/azure/app-service/web-sites-dotnet-troubleshoot-visual-studio#remotedebug) (Azure documentation)</span></span>
* <span data-ttu-id="50093-204">[Visual Studio 2017 を使用して Azure 内の IIS 上の ASP.NET Core をリモート デバッグする](/visualstudio/debugger/remote-debugging-azure) (Visual Studio ドキュメント)</span><span class="sxs-lookup"><span data-stu-id="50093-204">[Remote Debug ASP.NET Core on IIS in Azure in Visual Studio 2017](/visualstudio/debugger/remote-debugging-azure) (Visual Studio documentation)</span></span>

## <a name="application-insights"></a><span data-ttu-id="50093-205">Application Insights</span><span class="sxs-lookup"><span data-stu-id="50093-205">Application Insights</span></span>

<span data-ttu-id="50093-206">[Application Insights](https://azure.microsoft.com/services/application-insights/) は、Azure App Service でホストされているアプリからのテレメトリを提供し、エラー ログやレポート機能を備えています。</span><span class="sxs-lookup"><span data-stu-id="50093-206">[Application Insights](https://azure.microsoft.com/services/application-insights/) provides telemetry from apps hosted in the Azure App Service, including error logging and reporting features.</span></span> <span data-ttu-id="50093-207">Application Insights は、アプリのログ機能が使用可能になってアプリが起動した後で発生したエラーのみをレポートできます。</span><span class="sxs-lookup"><span data-stu-id="50093-207">Application Insights can only report on errors that occur after the app starts when the app's logging features become available.</span></span> <span data-ttu-id="50093-208">詳しくは、「[Application Insights for ASP.NET Core](/azure/application-insights/app-insights-asp-net-core)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="50093-208">For more information, see [Application Insights for ASP.NET Core](/azure/application-insights/app-insights-asp-net-core).</span></span>

## <a name="monitoring-blades"></a><span data-ttu-id="50093-209">監視ブレード</span><span class="sxs-lookup"><span data-stu-id="50093-209">Monitoring blades</span></span>

<span data-ttu-id="50093-210">監視ブレードでは、このトピックでこれまでに説明した方法に代わるトラブルシューティング エクスペリエンスが提供されます。</span><span class="sxs-lookup"><span data-stu-id="50093-210">Monitoring blades provide an alternative troubleshooting experience to the methods described earlier in the topic.</span></span> <span data-ttu-id="50093-211">これらのブレードは、500 番台のエラーの診断に使用できます。</span><span class="sxs-lookup"><span data-stu-id="50093-211">These blades can be used to diagnose 500-series errors.</span></span>

<span data-ttu-id="50093-212">ASP.NET Core 拡張機能がインストールされていることを確認してください。</span><span class="sxs-lookup"><span data-stu-id="50093-212">Confirm that the ASP.NET Core Extensions are installed.</span></span> <span data-ttu-id="50093-213">拡張機能がインストールされていない場合は、手動でインストールします。</span><span class="sxs-lookup"><span data-stu-id="50093-213">If the extensions aren't installed, install them manually:</span></span>

1. <span data-ttu-id="50093-214">**[開発ツール]** ブレード セクションで、**[拡張機能]** ブレードを選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-214">In the **DEVELOPMENT TOOLS** blade section, select the **Extensions** blade.</span></span>
1. <span data-ttu-id="50093-215">**[ASP.NET Core Extensions]\(ASP.NET Core 拡張機能\)** が一覧に表示されます。</span><span class="sxs-lookup"><span data-stu-id="50093-215">The **ASP.NET Core Extensions** should appear in the list.</span></span>
1. <span data-ttu-id="50093-216">拡張機能がインストールされていない場合は、**[追加]** ボタンを選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-216">If the extensions aren't installed, select the **Add** button.</span></span>
1. <span data-ttu-id="50093-217">一覧から **[ASP.NET Core Extensions]\(ASP.NET Core 拡張機能\)** を選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-217">Choose the **ASP.NET Core Extensions** from the list.</span></span>
1. <span data-ttu-id="50093-218">**[OK]** を選んで法的条項に同意します。</span><span class="sxs-lookup"><span data-stu-id="50093-218">Select **OK** to accept the legal terms.</span></span>
1. <span data-ttu-id="50093-219">**[拡張機能の追加]** ブレードで **[OK]** を選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-219">Select **OK** on the **Add extension** blade.</span></span>
1. <span data-ttu-id="50093-220">拡張機能が正常にインストールされると、情報ポップアップ メッセージで通知されます。</span><span class="sxs-lookup"><span data-stu-id="50093-220">An informational pop-up message indicates when the extensions are successfully installed.</span></span>

<span data-ttu-id="50093-221">stdout ログが有効になっていない場合は、次の手順のようにします。</span><span class="sxs-lookup"><span data-stu-id="50093-221">If stdout logging isn't enabled, follow these steps:</span></span>

1. <span data-ttu-id="50093-222">Azure portal の **[開発ツール]** 領域で **[高度なツール]** ブレードを選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-222">In the Azure portal, select the **Advanced Tools** blade in the **DEVELOPMENT TOOLS** area.</span></span> <span data-ttu-id="50093-223">**[Go&rarr;]** ボタンを選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-223">Select the **Go&rarr;** button.</span></span> <span data-ttu-id="50093-224">新しいブラウザー タブまたはウィンドウで Kudu コンソールが開きます。</span><span class="sxs-lookup"><span data-stu-id="50093-224">The Kudu console opens in a new browser tab or window.</span></span>
1. <span data-ttu-id="50093-225">ページの上部にあるナビゲーション バーを使って **[デバッグ コンソール]** を開き、**[CMD]** を選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-225">Using the navigation bar at the top of the page, open **Debug console** and select **CMD**.</span></span>
1. <span data-ttu-id="50093-226">パス **site** > **wwwroot** へのフォルダーを開き、下にスクロールして、一覧の最後にある *web.config* ファイルを表示します。</span><span class="sxs-lookup"><span data-stu-id="50093-226">Open the folders to the path **site** > **wwwroot** and scroll down to reveal the *web.config* file at the bottom of the list.</span></span>
1. <span data-ttu-id="50093-227">*web.config* ファイルの隣の鉛筆アイコンをクリックします。</span><span class="sxs-lookup"><span data-stu-id="50093-227">Click the pencil icon next to the *web.config* file.</span></span>
1. <span data-ttu-id="50093-228">**stdoutLogEnabled** を `true` に設定し、**stdoutLogFile** パスを `\\?\%home%\LogFiles\stdout` に変更します。</span><span class="sxs-lookup"><span data-stu-id="50093-228">Set **stdoutLogEnabled** to `true` and change the **stdoutLogFile** path to: `\\?\%home%\LogFiles\stdout`.</span></span>
1. <span data-ttu-id="50093-229">**[保存]** を選んで、更新した *web.config* ファイルを保存します。</span><span class="sxs-lookup"><span data-stu-id="50093-229">Select **Save** to save the updated *web.config* file.</span></span>

<span data-ttu-id="50093-230">続けて診断ログをアクティブにします。</span><span class="sxs-lookup"><span data-stu-id="50093-230">Proceed to activate diagnostic logging:</span></span>

1. <span data-ttu-id="50093-231">Azure portal で **[診断ログ]** ブレードを選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-231">In the Azure portal, select the **Diagnostics logs** blade.</span></span>
1. <span data-ttu-id="50093-232">**[アプリケーション ログ (ファイル システム)]** および **[詳細なエラー メッセージ]** の **[オン]** スイッチを選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-232">Select the **On** switch for **Application Logging (Filesystem)** and **Detailed error messages**.</span></span> <span data-ttu-id="50093-233">ブレードの上部にある **[保存]** ボタンを選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-233">Select the **Save** button at the top of the blade.</span></span>
1. <span data-ttu-id="50093-234">失敗した要求イベントのバッファ処理 (FREB) とも呼ばれる失敗した要求のトレースを含めるには、**[失敗した要求のトレース]** で **[オン]** スイッチを選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-234">To include failed request tracing, also known as Failed Request Event Buffering (FREB) logging, select the **On** switch for **Failed request tracing**.</span></span> 
1. <span data-ttu-id="50093-235">ポータルで **[診断ログ]** ブレードのすぐ下にある **[ログ ストリーム]** ブレードを選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-235">Select the **Log stream** blade, which is listed immediately under the **Diagnostics logs** blade in the portal.</span></span>
1. <span data-ttu-id="50093-236">アプリに対して要求します。</span><span class="sxs-lookup"><span data-stu-id="50093-236">Make a request to the app.</span></span>
1. <span data-ttu-id="50093-237">ログ ストリーム データ内で、エラーの原因が示されます。</span><span class="sxs-lookup"><span data-stu-id="50093-237">Within the log stream data, the cause of the error is indicated.</span></span>

<span data-ttu-id="50093-238">**重要**。</span><span class="sxs-lookup"><span data-stu-id="50093-238">**Important!**</span></span> <span data-ttu-id="50093-239">トラブルシューティングが完了したら、stdout ログを無効にしてください。</span><span class="sxs-lookup"><span data-stu-id="50093-239">Be sure to disable stdout logging when troubleshooting is complete.</span></span> <span data-ttu-id="50093-240">「[ASP.NET Core モジュールの stdout ログ](#aspnet-core-module-stdout-log)」セクションの説明をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="50093-240">See the instructions in the [ASP.NET Core Module stdout log](#aspnet-core-module-stdout-log) section.</span></span>

<span data-ttu-id="50093-241">失敗した要求のトレース ログ (FREB ログ) を見るには:</span><span class="sxs-lookup"><span data-stu-id="50093-241">To view the failed request tracing logs (FREB logs):</span></span>

1. <span data-ttu-id="50093-242">Azure portal で **[問題の診断と解決]** ブレードに移動します。</span><span class="sxs-lookup"><span data-stu-id="50093-242">Navigate to the **Diagnose and solve problems** blade in the Azure portal.</span></span>
1. <span data-ttu-id="50093-243">サイド バーの **[SUPPORT TOOLS]\(サポート ツール\)** 領域で、**[Failed Request Tracing Logs]\(失敗した要求のトレース ログ\)** を選びます。</span><span class="sxs-lookup"><span data-stu-id="50093-243">Select **Failed Request Tracing Logs** from the **SUPPORT TOOLS** area of the sidebar.</span></span>

<span data-ttu-id="50093-244">詳しくは、[「Azure App Service の Web アプリの診断ログの有効化」トピックの「失敗した要求トレース」セクション](/azure/app-service/web-sites-enable-diagnostic-log#failed-request-traces)および[「Azure での Web アプリのアプリケーションパフォーマンスに関するよくあるご質問」の「失敗した要求トレースをオンにするにはどうすればよいですか?」](/azure/app-service/app-service-web-availability-performance-application-issues-faq#how-do-i-turn-on-failed-request-tracing)をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="50093-244">See [Failed request traces section of the Enable diagnostics logging for web apps in Azure App Service topic](/azure/app-service/web-sites-enable-diagnostic-log#failed-request-traces) and the [Application performance FAQs for Web Apps in Azure: How do I turn on failed request tracing?](/azure/app-service/app-service-web-availability-performance-application-issues-faq#how-do-i-turn-on-failed-request-tracing) for more information.</span></span>

<span data-ttu-id="50093-245">詳しくは、「[Azure App Service の Web アプリの診断ログの有効化](/azure/app-service/web-sites-enable-diagnostic-log)」をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="50093-245">For more information, see [Enable diagnostics logging for web apps in Azure App Service](/azure/app-service/web-sites-enable-diagnostic-log).</span></span>

> [!WARNING]
> <span data-ttu-id="50093-246">stdout ログを無効にしないと、アプリまたはサーバーで障害が発生する可能性があります。</span><span class="sxs-lookup"><span data-stu-id="50093-246">Failure to disable the stdout log can lead to app or server failure.</span></span> <span data-ttu-id="50093-247">ログ ファイルのサイズまたは作成されるログ ファイルの数に制限はありません。</span><span class="sxs-lookup"><span data-stu-id="50093-247">There's no limit on log file size or the number of log files created.</span></span>
>
> <span data-ttu-id="50093-248">ASP.NET Core アプリでのルーチン ログの場合は、ログ ファイルのサイズを制限し、ログをローテーションするログ ライブラリを使います。</span><span class="sxs-lookup"><span data-stu-id="50093-248">For routine logging in an ASP.NET Core app, use a logging library that limits log file size and rotates logs.</span></span> <span data-ttu-id="50093-249">詳細については、「[サードパーティ製のログ プロバイダー](xref:fundamentals/logging/index#third-party-logging-providers)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="50093-249">For more information, see [third-party logging providers](xref:fundamentals/logging/index#third-party-logging-providers).</span></span>

## <a name="additional-resources"></a><span data-ttu-id="50093-250">その他の技術情報</span><span class="sxs-lookup"><span data-stu-id="50093-250">Additional resources</span></span>

* <xref:fundamentals/error-handling>
* <xref:host-and-deploy/azure-iis-errors-reference>
* [<span data-ttu-id="50093-251">Visual Studio を使用した Azure App Service での Web アプリのトラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="50093-251">Troubleshoot a web app in Azure App Service using Visual Studio</span></span>](/azure/app-service/web-sites-dotnet-troubleshoot-visual-studio)
* [<span data-ttu-id="50093-252">Azure Web Apps での "502 bad gateway" および "503 service unavailable" の HTTP エラーのトラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="50093-252">Troubleshoot HTTP errors of "502 bad gateway" and "503 service unavailable" in your Azure web apps</span></span>](/azure/app-service/app-service-web-troubleshoot-http-502-http-503)
* [<span data-ttu-id="50093-253">Azure App Service での Web アプリのパフォーマンス低下に関する問題のトラブルシューティング</span><span class="sxs-lookup"><span data-stu-id="50093-253">Troubleshoot slow web app performance issues in Azure App Service</span></span>](/azure/app-service/app-service-web-troubleshoot-performance-degradation)
* [<span data-ttu-id="50093-254">Azure での Web アプリのアプリケーションパフォーマンスに関するよくあるご質問</span><span class="sxs-lookup"><span data-stu-id="50093-254">Application performance FAQs for Web Apps in Azure</span></span>](/azure/app-service/app-service-web-availability-performance-application-issues-faq)
* [<span data-ttu-id="50093-255">Azure Web アプリのサンドボックス (App Service ランタイムの実行の制限)</span><span class="sxs-lookup"><span data-stu-id="50093-255">Azure Web App sandbox (App Service runtime execution limitations)</span></span>](https://github.com/projectkudu/kudu/wiki/Azure-Web-App-sandbox)
* [<span data-ttu-id="50093-256">Azure Friday: Azure App Service の診断とトラブルシューティング (12 分間のビデオ)</span><span class="sxs-lookup"><span data-stu-id="50093-256">Azure Friday: Azure App Service Diagnostic and Troubleshooting Experience (12-minute video)</span></span>](https://channel9.msdn.com/Shows/Azure-Friday/Azure-App-Service-Diagnostic-and-Troubleshooting-Experience)
