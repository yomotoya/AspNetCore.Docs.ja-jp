---
title: ASP.NET Core のコントローラーのメソッドとビュー
author: rick-anderson
description: ASP.NET Core でコントローラー メソッド、ビュー、DataAnnotations を使用する方法について説明します。
ms.author: riande
ms.date: 12/13/2018
uid: tutorials/first-mvc-app/controller-methods-views
ms.openlocfilehash: 36c8141ba5827366572dabcfd0fdf9600c745706
ms.sourcegitcommit: 5b0eca8c21550f95de3bb21096bd4fd4d9098026
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 04/27/2019
ms.locfileid: "64889767"
---
# <a name="controller-methods-and-views-in-aspnet-core"></a><span data-ttu-id="721c0-103">ASP.NET Core のコントローラーのメソッドとビュー</span><span class="sxs-lookup"><span data-stu-id="721c0-103">Controller methods and views in ASP.NET Core</span></span>

<span data-ttu-id="721c0-104">作成者: [Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="721c0-104">By [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

<span data-ttu-id="721c0-105">ムービー アプリは上々の滑り出しでしたが、表示が理想的ではありません。たとえば、**ReleaseDate** は 2 語でなければなりません。</span><span class="sxs-lookup"><span data-stu-id="721c0-105">We have a good start to the movie app, but the presentation isn't ideal, for example, **ReleaseDate** should be two words.</span></span>

![インデックス ビュー:Release Date が 1 語 (スペースなし) で、ムービーの公開日がすべて午前 12 時になっています](working-with-sql/_static/m55.png)

<span data-ttu-id="721c0-107">*Models/Movie.cs* ファイルを開き、下の画像で強調表示されている行を追加します。</span><span class="sxs-lookup"><span data-stu-id="721c0-107">Open the *Models/Movie.cs* file and add the highlighted lines shown below:</span></span>

[!code-csharp[](start-mvc/sample/MvcMovie22/Models/MovieDateFixed.cs?name=snippet_1&highlight=2,3,12-13,17)]

<span data-ttu-id="721c0-108">[DataAnnotations](/aspnet/mvc/overview/older-versions/mvc-music-store/mvc-music-store-part-6) については、次のチュートリアルで説明します。</span><span class="sxs-lookup"><span data-stu-id="721c0-108">We cover [DataAnnotations](/aspnet/mvc/overview/older-versions/mvc-music-store/mvc-music-store-part-6) in the next tutorial.</span></span> <span data-ttu-id="721c0-109">[Display](/dotnet/api/microsoft.aspnetcore.mvc.modelbinding.metadata.displaymetadata) 属性は、フィールドの名前として表示する内容 (ここでは、"ReleaseDate" ではなく、"Release Date") を指定します。</span><span class="sxs-lookup"><span data-stu-id="721c0-109">The [Display](/dotnet/api/microsoft.aspnetcore.mvc.modelbinding.metadata.displaymetadata) attribute specifies what to display for the name of a field (in this case "Release Date" instead of "ReleaseDate").</span></span> <span data-ttu-id="721c0-110">[DataType](/dotnet/api/microsoft.aspnetcore.mvc.dataannotations.internal.datatypeattributeadapter) 属性はデータ型 (Date) を指定するため、フィールドに格納される時刻情報は表示されません。</span><span class="sxs-lookup"><span data-stu-id="721c0-110">The [DataType](/dotnet/api/microsoft.aspnetcore.mvc.dataannotations.internal.datatypeattributeadapter) attribute specifies the type of the data (Date), so the time information stored in the field isn't displayed.</span></span>

<span data-ttu-id="721c0-111">`[Column(TypeName = "decimal(18, 2)")]` データ注釈は、Entity Framework Core がデータベースの通貨と `Price` を正しくマッピングできるようにするために必要です。</span><span class="sxs-lookup"><span data-stu-id="721c0-111">The `[Column(TypeName = "decimal(18, 2)")]` data annotation is required so Entity Framework Core can correctly map `Price` to currency in the database.</span></span> <span data-ttu-id="721c0-112">詳細については、「[Data Types](/ef/core/modeling/relational/data-types)」(データ型) を参照してください。</span><span class="sxs-lookup"><span data-stu-id="721c0-112">For more information, see [Data Types](/ef/core/modeling/relational/data-types).</span></span>

<span data-ttu-id="721c0-113">`Movies` コントローラーを表示し、**[編集]** リンクをマウスでポイントしてターゲットの URL を確認します。</span><span class="sxs-lookup"><span data-stu-id="721c0-113">Browse to the `Movies` controller and hold the mouse pointer over an **Edit** link to see the target URL.</span></span>

![[編集] リンクがマウスでポイントされ、リンク URL として https://localhost:5001/Movies/Edit/5 が表示されている状態のブラウザー ウィンドウ](~/tutorials/first-mvc-app/controller-methods-views/_static/edit7.png)

<span data-ttu-id="721c0-115">**[編集]**、**[詳細]**、**[削除]** の各リンクは、*Views/Movies/Index.cshtml* ファイルで Core MVC アンカー タグ ヘルパーによって生成されます。</span><span class="sxs-lookup"><span data-stu-id="721c0-115">The **Edit**, **Details**, and **Delete** links are generated by the Core MVC Anchor Tag Helper in the *Views/Movies/Index.cshtml* file.</span></span>

[!code-HTML[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Views/Movies/IndexOriginal.cshtml?highlight=1-3&range=46-50)]

<span data-ttu-id="721c0-116">[タグ ヘルパー](xref:mvc/views/tag-helpers/intro)を使うと、Razor ファイルでの HTML 要素の作成とレンダリングに、サーバー側コードを組み込むことができます。</span><span class="sxs-lookup"><span data-stu-id="721c0-116">[Tag Helpers](xref:mvc/views/tag-helpers/intro) enable server-side code to participate in creating and rendering HTML elements in Razor files.</span></span> <span data-ttu-id="721c0-117">上のコードでは、`AnchorTagHelper` はコントローラーのアクション メソッドとルート ID から HTML の `href` 属性の値を動的に生成します。好みのブラウザーの **[ソースの表示]** または開発者ツールを使って、生成されたマークアップを確認してください。</span><span class="sxs-lookup"><span data-stu-id="721c0-117">In the code above, the `AnchorTagHelper` dynamically generates the HTML `href` attribute value from the controller action method and route id. You use **View Source** from your favorite browser or use the developer tools to examine the generated markup.</span></span> <span data-ttu-id="721c0-118">生成された HTML の部分を以下に示します。</span><span class="sxs-lookup"><span data-stu-id="721c0-118">A portion of the generated HTML is shown below:</span></span>

```html
 <td>
    <a href="/Movies/Edit/4"> Edit </a> |
    <a href="/Movies/Details/4"> Details </a> |
    <a href="/Movies/Delete/4"> Delete </a>
</td>
```

<span data-ttu-id="721c0-119">*Startup.cs* ファイルで設定する[ルーティング](xref:mvc/controllers/routing)の形式を思い出してください。</span><span class="sxs-lookup"><span data-stu-id="721c0-119">Recall the format for [routing](xref:mvc/controllers/routing) set in the *Startup.cs* file:</span></span>

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Startup.cs?name=snippet_1&highlight=5)]

<span data-ttu-id="721c0-120">ASP.NET Core は、`https://localhost:5001/Movies/Edit/4` を、`Movies` コントローラーの `Edit` アクション メソッドへの要求に変換し、パラメーター `Id` には 4 を設定します </span><span class="sxs-lookup"><span data-stu-id="721c0-120">ASP.NET Core translates `https://localhost:5001/Movies/Edit/4` into a request to the `Edit` action method of the `Movies` controller with the parameter `Id` of 4.</span></span> <span data-ttu-id="721c0-121">(コントローラー メソッドはアクション メソッドとも呼ばれます)。</span><span class="sxs-lookup"><span data-stu-id="721c0-121">(Controller methods are also known as action methods.)</span></span>

<span data-ttu-id="721c0-122">[タグ ヘルパー](xref:mvc/views/tag-helpers/intro)は、ASP.NET Core で最もよく使われる新機能の 1 つです。</span><span class="sxs-lookup"><span data-stu-id="721c0-122">[Tag Helpers](xref:mvc/views/tag-helpers/intro) are one of the most popular new features in ASP.NET Core.</span></span> <span data-ttu-id="721c0-123">詳細については、「[その他の技術情報](#additional-resources)」を参照してください。</span><span class="sxs-lookup"><span data-stu-id="721c0-123">For more information, see [Additional resources](#additional-resources).</span></span>

<span data-ttu-id="721c0-124">`Movies` コントローラーを開き、2 つの `Edit` アクション メソッドを調べます。</span><span class="sxs-lookup"><span data-stu-id="721c0-124">Open the `Movies` controller and examine the two `Edit` action methods.</span></span> <span data-ttu-id="721c0-125">次に示すコードの `HTTP GET Edit` メソッドは、ムービーをフェッチし、*Edit.cshtml* Razor ファイルによって生成される編集フォームを設定します。</span><span class="sxs-lookup"><span data-stu-id="721c0-125">The following code shows the `HTTP GET Edit` method, which fetches the movie and populates the edit form generated by the *Edit.cshtml* Razor file.</span></span>

::: moniker range=">= aspnetcore-2.1"

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie21/Controllers/MC1.cs?name=snippet_edit1)]

<span data-ttu-id="721c0-126">次に示すコードの `HTTP POST Edit` メソッドは、送信されたムービーの値を処理します。</span><span class="sxs-lookup"><span data-stu-id="721c0-126">The following code shows the `HTTP POST Edit` method, which processes the posted movie values:</span></span>

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Controllers/MC1.cs?name=snippet_edit2)]

::: moniker-end

::: moniker range="<= aspnetcore-2.0"

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Controllers/MC1.cs?name=snippet_edit1)]

<span data-ttu-id="721c0-127">次に示すコードの `HTTP POST Edit` メソッドは、送信されたムービーの値を処理します。</span><span class="sxs-lookup"><span data-stu-id="721c0-127">The following code shows the `HTTP POST Edit` method, which processes the posted movie values:</span></span>

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Controllers/MC1.cs?name=snippet_edit2)]

::: moniker-end

<span data-ttu-id="721c0-128">`[Bind]` 属性は、[オーバーポスティング攻撃](/aspnet/mvc/overview/getting-started/getting-started-with-ef-using-mvc/implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-application#overpost)を防ぐための 1 つの方法です。</span><span class="sxs-lookup"><span data-stu-id="721c0-128">The `[Bind]` attribute is one way to protect against [over-posting](/aspnet/mvc/overview/getting-started/getting-started-with-ef-using-mvc/implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-application#overpost).</span></span> <span data-ttu-id="721c0-129">変更する `[Bind]` 属性にだけプロパティを含める必要があります。</span><span class="sxs-lookup"><span data-stu-id="721c0-129">You should only include properties in the `[Bind]` attribute that you want to change.</span></span> <span data-ttu-id="721c0-130">詳細については、[オーバーポスティング攻撃からのコントローラーの保護](/aspnet/mvc/overview/getting-started/getting-started-with-ef-using-mvc/implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-application)に関する記事を参照してください。</span><span class="sxs-lookup"><span data-stu-id="721c0-130">For more information, see [Protect your controller from over-posting](/aspnet/mvc/overview/getting-started/getting-started-with-ef-using-mvc/implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-application).</span></span> <span data-ttu-id="721c0-131">[ViewModels](http://rachelappel.com/use-viewmodels-to-manage-data-amp-organize-code-in-asp-net-mvc-applications/) は、オーバーポスティング攻撃を防ぐもう 1 つの方法を提供します。</span><span class="sxs-lookup"><span data-stu-id="721c0-131">[ViewModels](http://rachelappel.com/use-viewmodels-to-manage-data-amp-organize-code-in-asp-net-mvc-applications/) provide an alternative approach to prevent over-posting.</span></span>

<span data-ttu-id="721c0-132">2 番目の `Edit` アクション メソッドの前に `[HttpPost]` 属性が付いていることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="721c0-132">Notice the second `Edit` action method is preceded by the `[HttpPost]` attribute.</span></span>

::: moniker range=">= aspnetcore-2.1"

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie21/Controllers/MC1.cs?name=snippet_edit2&highlight=1)]

::: moniker-end

::: moniker range="<= aspnetcore-2.0"

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Controllers/MC1.cs?name=snippet_edit2&highlight=4)]

::: moniker-end

<span data-ttu-id="721c0-133">`HttpPost` 属性は、`POST` 要求に対して "*のみ*" この `Edit` メソッドを呼び出すことができることを指定します。</span><span class="sxs-lookup"><span data-stu-id="721c0-133">The `HttpPost` attribute specifies that this `Edit` method can be invoked *only* for `POST` requests.</span></span> <span data-ttu-id="721c0-134">1 番目の Edit メソッドにも `[HttpGet]` 属性を適用してもかまいませんが、`[HttpGet]` が既定値なので必要ありません。</span><span class="sxs-lookup"><span data-stu-id="721c0-134">You could apply the `[HttpGet]` attribute to the first edit method, but that's not necessary because `[HttpGet]` is the default.</span></span>

<span data-ttu-id="721c0-135">`ValidateAntiForgeryToken` 属性は[リクエスト フォージェリを防ぐ](xref:security/anti-request-forgery)ために使われ、編集ビュー ファイル (*Views/Movies/Edit.cshtml*) で生成されるフォージェリ対策トークンとペアにされます。</span><span class="sxs-lookup"><span data-stu-id="721c0-135">The `ValidateAntiForgeryToken` attribute is used to [prevent forgery of a request](xref:security/anti-request-forgery) and is paired up with an anti-forgery token generated in the edit view file (*Views/Movies/Edit.cshtml*).</span></span> <span data-ttu-id="721c0-136">編集ビュー ファイルは、[フォーム タグ ヘルパー](xref:mvc/views/working-with-forms)でフォージェリ対策トークンを生成します。</span><span class="sxs-lookup"><span data-stu-id="721c0-136">The edit view file generates the anti-forgery token with the [Form Tag Helper](xref:mvc/views/working-with-forms).</span></span>

[!code-HTML[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Views/Movies/Edit.cshtml?range=9)]

<span data-ttu-id="721c0-137">[フォーム タグ ヘルパー](xref:mvc/views/working-with-forms)で生成される非表示のフォージェリ対策トークンは、Movies コントローラーの `Edit` メソッドで `[ValidateAntiForgeryToken]` によって生成されるフォージェリ対策トークンと一致している必要があります。</span><span class="sxs-lookup"><span data-stu-id="721c0-137">The [Form Tag Helper](xref:mvc/views/working-with-forms) generates a hidden anti-forgery token that must match the `[ValidateAntiForgeryToken]` generated anti-forgery token in the `Edit` method of the Movies controller.</span></span> <span data-ttu-id="721c0-138">詳しくは、[リクエスト フォージェリの対策に関する記事](xref:security/anti-request-forgery)をご覧ください。</span><span class="sxs-lookup"><span data-stu-id="721c0-138">For more information, see [Anti-Request Forgery](xref:security/anti-request-forgery).</span></span>

<span data-ttu-id="721c0-139">`HttpGet Edit` メソッドは、ムービーの `ID` パラメーターを受け取り、Entity Framework の `FindAsync` メソッドを使ってムービーを検索して、選択されたムービーを編集ビューに返します。</span><span class="sxs-lookup"><span data-stu-id="721c0-139">The `HttpGet Edit` method takes the movie `ID` parameter, looks up the movie using the Entity Framework `FindAsync` method, and returns the selected movie to the Edit view.</span></span> <span data-ttu-id="721c0-140">ムービーが見つからない場合は、`NotFound` (HTTP 404) が返されます。</span><span class="sxs-lookup"><span data-stu-id="721c0-140">If a movie cannot be found, `NotFound` (HTTP 404) is returned.</span></span>

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie21/Controllers/MC1.cs?name=snippet_edit1)]

<span data-ttu-id="721c0-141">スキャフォールディング システムが編集ビューを作成したときは、そのシステムが `Movie` クラスを調べて、クラスの各プロパティの `<label>` および `<input>` 要素をレンダリングするコードを作成しました。</span><span class="sxs-lookup"><span data-stu-id="721c0-141">When the scaffolding system created the Edit view, it examined the `Movie` class and created code to render `<label>` and `<input>` elements for each property of the class.</span></span> <span data-ttu-id="721c0-142">次の例では、Visual Studio のスキャフォールディング システムによって生成された編集ビューを示します。</span><span class="sxs-lookup"><span data-stu-id="721c0-142">The following example shows the Edit view that was generated by the Visual Studio scaffolding system:</span></span>

[!code-HTML[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie22/Views/Movies/EditOriginal.cshtml)]

<span data-ttu-id="721c0-143">ビュー テンプレートではファイルの先頭に `@model MvcMovie.Models.Movie` ステートメントがあることに注意してください。</span><span class="sxs-lookup"><span data-stu-id="721c0-143">Notice how the view template has a `@model MvcMovie.Models.Movie` statement at the top of the file.</span></span> <span data-ttu-id="721c0-144">`@model MvcMovie.Models.Movie` は、ビューがビュー テンプレートのモデルとして `Movie` 型を期待することを指定します。</span><span class="sxs-lookup"><span data-stu-id="721c0-144">`@model MvcMovie.Models.Movie` specifies that the view expects the model for the view template to be of type `Movie`.</span></span>

<span data-ttu-id="721c0-145">スキャフォールディングされたコードは、複数のタグ ヘルパー メソッドを使って HTML マークアップを効率化します。</span><span class="sxs-lookup"><span data-stu-id="721c0-145">The scaffolded code uses several Tag Helper methods to streamline the HTML markup.</span></span> <span data-ttu-id="721c0-146">[ラベル タグ ヘルパー](xref:mvc/views/working-with-forms)は、フィールドの名前を表示します ("Title"、"ReleaseDate"、"Genre"、"Price")。</span><span class="sxs-lookup"><span data-stu-id="721c0-146">The - [Label Tag Helper](xref:mvc/views/working-with-forms) displays the name of the field ("Title", "ReleaseDate", "Genre", or "Price").</span></span> <span data-ttu-id="721c0-147">[入力タグ ヘルパー](xref:mvc/views/working-with-forms)は、HTML の `<input>` 要素をレンダリングします。</span><span class="sxs-lookup"><span data-stu-id="721c0-147">The [Input Tag Helper](xref:mvc/views/working-with-forms) renders an HTML `<input>` element.</span></span> <span data-ttu-id="721c0-148">[検証タグ ヘルパー](xref:mvc/views/working-with-forms)は、そのプロパティに関連付けられている検証メッセージを表示します。</span><span class="sxs-lookup"><span data-stu-id="721c0-148">The [Validation Tag Helper](xref:mvc/views/working-with-forms) displays any validation messages associated with that property.</span></span>

<span data-ttu-id="721c0-149">アプリケーションを実行し、`/Movies` URL に移動します。</span><span class="sxs-lookup"><span data-stu-id="721c0-149">Run the application and navigate to the `/Movies` URL.</span></span> <span data-ttu-id="721c0-150">**[編集]** リンクをクリックします。</span><span class="sxs-lookup"><span data-stu-id="721c0-150">Click an **Edit** link.</span></span> <span data-ttu-id="721c0-151">ブラウザーで、ページのソースを表示します。</span><span class="sxs-lookup"><span data-stu-id="721c0-151">In the browser, view the source for the page.</span></span> <span data-ttu-id="721c0-152">`<form>` 要素に対して生成された HTML を次に示します。</span><span class="sxs-lookup"><span data-stu-id="721c0-152">The generated HTML for the `<form>` element is shown below.</span></span>

[!code-HTML[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Views/Shared/edit_view_source.html?highlight=1,6,10,17,24,28)]

<span data-ttu-id="721c0-153">`<input>` 要素は、`/Movies/Edit/id` URL に送信するように `action` 属性が設定された `HTML <form>` 要素に含まれます。</span><span class="sxs-lookup"><span data-stu-id="721c0-153">The `<input>` elements are in an `HTML <form>` element whose `action` attribute is set to post to the `/Movies/Edit/id` URL.</span></span> <span data-ttu-id="721c0-154">[`Save`] ボタンがクリックされると、フォームのデータがサーバーに送信されます。</span><span class="sxs-lookup"><span data-stu-id="721c0-154">The form data will be posted to the server when the `Save` button is clicked.</span></span> <span data-ttu-id="721c0-155">`</form>` 要素を閉じる前に最後の行では、[フォーム タグ ヘルパー](xref:mvc/views/working-with-forms)によって生成された非表示の [XSRF](xref:security/anti-request-forgery) トークンが示されています。</span><span class="sxs-lookup"><span data-stu-id="721c0-155">The last line before the closing `</form>` element shows the hidden [XSRF](xref:security/anti-request-forgery) token generated by the [Form Tag Helper](xref:mvc/views/working-with-forms).</span></span>

## <a name="processing-the-post-request"></a><span data-ttu-id="721c0-156">POST 要求の処理</span><span class="sxs-lookup"><span data-stu-id="721c0-156">Processing the POST Request</span></span>

<span data-ttu-id="721c0-157">次のリストでは、`Edit` アクション メソッドの `[HttpPost]` バージョンを示します。</span><span class="sxs-lookup"><span data-stu-id="721c0-157">The following listing shows the `[HttpPost]` version of the `Edit` action method.</span></span>

::: moniker range=">= aspnetcore-2.1"

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie21/Controllers/MC1.cs?name=snippet_edit2)]

::: moniker-end

::: moniker range="<= aspnetcore-2.0"

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc/sample/MvcMovie/Controllers/MC1.cs?name=snippet_edit2)]

::: moniker-end

<span data-ttu-id="721c0-158">`[ValidateAntiForgeryToken]` 属性は、[フォーム タグ ヘルパー](xref:mvc/views/working-with-forms)のフォージェリ対策トークン ジェネレーターによって生成された非表示の [XSRF](xref:security/anti-request-forgery) トークンを検証します。</span><span class="sxs-lookup"><span data-stu-id="721c0-158">The `[ValidateAntiForgeryToken]` attribute validates the hidden [XSRF](xref:security/anti-request-forgery) token generated by the anti-forgery token generator in the [Form Tag Helper](xref:mvc/views/working-with-forms)</span></span>

<span data-ttu-id="721c0-159">[モデル バインド](xref:mvc/models/model-binding) システムは、送信されたフォーム値を取得し、`movie` パラメーターとして渡される `Movie` オブジェクトを作成します。</span><span class="sxs-lookup"><span data-stu-id="721c0-159">The [model binding](xref:mvc/models/model-binding) system takes the posted form values and creates a `Movie` object that's passed as the `movie` parameter.</span></span> <span data-ttu-id="721c0-160">`ModelState.IsValid` メソッドは、フォームで送信されたデータを使って `Movie` オブジェクトを変更 (編集または更新) できることを検証します。</span><span class="sxs-lookup"><span data-stu-id="721c0-160">The `ModelState.IsValid` method verifies that the data submitted in the form can be used to modify (edit or update) a `Movie` object.</span></span> <span data-ttu-id="721c0-161">データが有効な場合は保存されます。</span><span class="sxs-lookup"><span data-stu-id="721c0-161">If the data is valid, it's saved.</span></span> <span data-ttu-id="721c0-162">更新 (編集) されたムービー データは、データベース コンテキストの `SaveChangesAsync` メソッドを呼び出すことによってデータベースに保存されます。</span><span class="sxs-lookup"><span data-stu-id="721c0-162">The updated (edited) movie data is saved to the database by calling the `SaveChangesAsync` method of database context.</span></span> <span data-ttu-id="721c0-163">データを保存した後、コードはユーザーを `MoviesController` クラスの `Index` アクション メソッドにリダイレクトします。そこでは、行われたばかりの変更を含むムービー コレクションが表示されます。</span><span class="sxs-lookup"><span data-stu-id="721c0-163">After saving the data, the code redirects the user to the `Index` action method of the `MoviesController` class, which displays the movie collection, including the changes just made.</span></span>

<span data-ttu-id="721c0-164">フォームがサーバーに送信される前に、クライアント側の検証はフィールドに対する検証規則を確認します。</span><span class="sxs-lookup"><span data-stu-id="721c0-164">Before the form is posted to the server, client-side validation checks any validation rules on the fields.</span></span> <span data-ttu-id="721c0-165">検証エラーがある場合は、エラー メッセージが表示され、フォームは送信されません。</span><span class="sxs-lookup"><span data-stu-id="721c0-165">If there are any validation errors, an error message is displayed and the form isn't posted.</span></span> <span data-ttu-id="721c0-166">JavaScript が無効になっている場合、クライアント側検証は行われませんが、サーバーは送信された無効な値を検出し、フォーム値がエラー メッセージと共に再表示されます。</span><span class="sxs-lookup"><span data-stu-id="721c0-166">If JavaScript is disabled, you won't have client-side validation but the server will detect the posted values that are not valid, and the form values will be redisplayed with error messages.</span></span> <span data-ttu-id="721c0-167">このチュートリアルで後ほど、[モデルの検証](xref:mvc/models/validation)についてさらに詳しく説明します。</span><span class="sxs-lookup"><span data-stu-id="721c0-167">Later in the tutorial we examine [Model Validation](xref:mvc/models/validation) in more detail.</span></span> <span data-ttu-id="721c0-168">*Views/Movies/Edit.cshtml* ビュー テンプレートの[検証タグ ヘルパー](xref:mvc/views/working-with-forms)は、適切なエラー メッセージの表示を処理します。</span><span class="sxs-lookup"><span data-stu-id="721c0-168">The [Validation Tag Helper](xref:mvc/views/working-with-forms) in the *Views/Movies/Edit.cshtml* view template takes care of displaying appropriate error messages.</span></span>

![編集ビュー:正しくない価格の値 abc に対する例外では、"Price フィールドは数値でなければなりません" と表示されます。](~/tutorials/first-mvc-app/controller-methods-views/_static/val.png)

<span data-ttu-id="721c0-171">Movie コントローラーのすべての `HttpGet` メソッドは、同様のパターンに従います。</span><span class="sxs-lookup"><span data-stu-id="721c0-171">All the `HttpGet` methods in the movie controller follow a similar pattern.</span></span> <span data-ttu-id="721c0-172">ムービー オブジェクト (または、`Index` の場合はオブジェクトの一覧) を取得し、オブジェクト (モデル) をビューに渡します。</span><span class="sxs-lookup"><span data-stu-id="721c0-172">They get a movie object (or list of objects, in the case of `Index`), and pass the object (model) to the view.</span></span> <span data-ttu-id="721c0-173">`Create` メソッドは、空のムービー オブジェクトを `Create` ビューに渡します。</span><span class="sxs-lookup"><span data-stu-id="721c0-173">The `Create` method passes an empty movie object to the `Create` view.</span></span> <span data-ttu-id="721c0-174">データの作成、編集、削除、またはそれ以外の変更を行うすべてのメソッドは、メソッドの `[HttpPost]` のオーバーロードでそれを行います。</span><span class="sxs-lookup"><span data-stu-id="721c0-174">All the methods that create, edit, delete, or otherwise modify data do so in the `[HttpPost]` overload of the method.</span></span> <span data-ttu-id="721c0-175">`HTTP GET` メソッドでデータを変更すると、セキュリティ リスクがあります。</span><span class="sxs-lookup"><span data-stu-id="721c0-175">Modifying data in an `HTTP GET` method is a security risk.</span></span> <span data-ttu-id="721c0-176">`HTTP GET` メソッドでデータを変更することは、HTTP のベスト プラクティスや、GET 要求ではアプリケーションの状態を変更してはならないというアーキテクチャの [REST](http://rest.elkstein.org/) パターンにも、違反しています。</span><span class="sxs-lookup"><span data-stu-id="721c0-176">Modifying data in an `HTTP GET` method also violates HTTP best practices and the architectural [REST](http://rest.elkstein.org/) pattern, which specifies that GET requests shouldn't change the state of your application.</span></span> <span data-ttu-id="721c0-177">つまり、GET 操作の実行は、副作用がなく、永続化されたデータを変更しない、安全な操作である必要があります。</span><span class="sxs-lookup"><span data-stu-id="721c0-177">In other words, performing a GET operation should be a safe operation that has no side effects and doesn't modify your persisted data.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="721c0-178">その他の技術情報</span><span class="sxs-lookup"><span data-stu-id="721c0-178">Additional resources</span></span>

* [<span data-ttu-id="721c0-179">グローバライズとローカライズ</span><span class="sxs-lookup"><span data-stu-id="721c0-179">Globalization and localization</span></span>](xref:fundamentals/localization)
* [<span data-ttu-id="721c0-180">Tag Helpers の概要</span><span class="sxs-lookup"><span data-stu-id="721c0-180">Introduction to Tag Helpers</span></span>](xref:mvc/views/tag-helpers/intro)
* [<span data-ttu-id="721c0-181">タグ ヘルパーの作成</span><span class="sxs-lookup"><span data-stu-id="721c0-181">Author Tag Helpers</span></span>](xref:mvc/views/tag-helpers/authoring)
* [<span data-ttu-id="721c0-182">リクエスト フォージェリの対策</span><span class="sxs-lookup"><span data-stu-id="721c0-182">Anti-Request Forgery</span></span>](xref:security/anti-request-forgery)
* <span data-ttu-id="721c0-183">[オーバーポスティング攻撃](/aspnet/mvc/overview/getting-started/getting-started-with-ef-using-mvc/implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-application)からのコントローラーの保護</span><span class="sxs-lookup"><span data-stu-id="721c0-183">Protect your controller from [over-posting](/aspnet/mvc/overview/getting-started/getting-started-with-ef-using-mvc/implementing-basic-crud-functionality-with-the-entity-framework-in-asp-net-mvc-application)</span></span>
* [<span data-ttu-id="721c0-184">ViewModel</span><span class="sxs-lookup"><span data-stu-id="721c0-184">ViewModels</span></span>](http://rachelappel.com/use-viewmodels-to-manage-data-amp-organize-code-in-asp-net-mvc-applications/)
* [<span data-ttu-id="721c0-185">フォーム タグ ヘルパー</span><span class="sxs-lookup"><span data-stu-id="721c0-185">Form Tag Helper</span></span>](xref:mvc/views/working-with-forms)
* [<span data-ttu-id="721c0-186">入力タグ ヘルパー</span><span class="sxs-lookup"><span data-stu-id="721c0-186">Input Tag Helper</span></span>](xref:mvc/views/working-with-forms)
* [<span data-ttu-id="721c0-187">ラベル タグ ヘルパー</span><span class="sxs-lookup"><span data-stu-id="721c0-187">Label Tag Helper</span></span>](xref:mvc/views/working-with-forms)
* [<span data-ttu-id="721c0-188">選択タグ ヘルパー</span><span class="sxs-lookup"><span data-stu-id="721c0-188">Select Tag Helper</span></span>](xref:mvc/views/working-with-forms)
* [<span data-ttu-id="721c0-189">検証タグ ヘルパー</span><span class="sxs-lookup"><span data-stu-id="721c0-189">Validation Tag Helper</span></span>](xref:mvc/views/working-with-forms)

> [!div class="step-by-step"]
> <span data-ttu-id="721c0-190">[前へ](working-with-sql.md)
> [次へ](search.md)</span><span class="sxs-lookup"><span data-stu-id="721c0-190">[Previous](working-with-sql.md)
[Next](search.md)</span></span>  
