---
uid: web-forms/overview/data-access/basic-reporting/declarative-parameters-vb
title: "宣言型のパラメーター (VB) |Microsoft ドキュメント"
author: rick-anderson
description: "このチュートリアルでは、ハード コーディングされた値に設定パラメーターを使用して、DetailsView コントロールに表示するデータを選択する方法について説明します。"
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/31/2010
ms.topic: article
ms.assetid: dc1234a3-114f-4c9a-8d25-50ca03cc8e8e
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/declarative-parameters-vb
msc.type: authoredcontent
ms.openlocfilehash: 7759b3d078ddabd335034f2ff76f10fb0de7dd28
ms.sourcegitcommit: 9a9483aceb34591c97451997036a9120c3fe2baf
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/10/2017
---
<a name="declarative-parameters-vb"></a><span data-ttu-id="9f14d-103">宣言型のパラメーター (VB)</span><span class="sxs-lookup"><span data-stu-id="9f14d-103">Declarative Parameters (VB)</span></span>
====================
<span data-ttu-id="9f14d-104">によって[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="9f14d-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="9f14d-105">[サンプル アプリをダウンロード](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_5_VB.exe)または[PDF のダウンロード](declarative-parameters-vb/_static/datatutorial05vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="9f14d-105">[Download Sample App](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_5_VB.exe) or [Download PDF](declarative-parameters-vb/_static/datatutorial05vb1.pdf)</span></span>

> <span data-ttu-id="9f14d-106">このチュートリアルでは、ハード コーディングされた値に設定パラメーターを使用して、DetailsView コントロールに表示するデータを選択する方法について説明します。</span><span class="sxs-lookup"><span data-stu-id="9f14d-106">In this tutorial we'll illustrate how to use a parameter set to a hard-coded value to select the data to display in a DetailsView control.</span></span>


## <a name="introduction"></a><span data-ttu-id="9f14d-107">はじめに</span><span class="sxs-lookup"><span data-stu-id="9f14d-107">Introduction</span></span>

<span data-ttu-id="9f14d-108">[前回のチュートリアル](displaying-data-with-the-objectdatasource-vb.md)、GridView、DetailsView、フォーム ビュー コントロールを呼び出した ObjectDataSource コントロールにバインドされているとデータの表示について説明しました、`GetProducts()`メソッドから、`ProductsBLL`クラスです。</span><span class="sxs-lookup"><span data-stu-id="9f14d-108">In the [last tutorial](displaying-data-with-the-objectdatasource-vb.md) we looked at displaying data with the GridView, DetailsView, and FormView controls bound to an ObjectDataSource control that invoked the `GetProducts()` method from the `ProductsBLL` class.</span></span> <span data-ttu-id="9f14d-109">`GetProducts()`メソッドは、設定、すべてのレコードから、Northwind データベースの厳密に型指定された DataTable を返します`Products`テーブル。</span><span class="sxs-lookup"><span data-stu-id="9f14d-109">The `GetProducts()` method returns a strongly-typed DataTable populated with all of the records from the Northwind database's `Products` table.</span></span> <span data-ttu-id="9f14d-110">`ProductsBLL`クラスには、その他の商品の単なるサブセットを返すメソッドが含まれています。 `GetProductByProductID(productID)`、 `GetProductsByCategoryID(categoryID)`、および`GetProductsBySupplierID(supplierID)`です。</span><span class="sxs-lookup"><span data-stu-id="9f14d-110">The `ProductsBLL` class contains additional methods for returning just subsets of the products - `GetProductByProductID(productID)`, `GetProductsByCategoryID(categoryID)`, and `GetProductsBySupplierID(supplierID)`.</span></span> <span data-ttu-id="9f14d-111">これら 3 つの方法では、返された製品情報をフィルター処理する方法を示す、入力パラメーターを想定します。</span><span class="sxs-lookup"><span data-stu-id="9f14d-111">These three methods expect an input parameter indicating how to filter the returned product information.</span></span>

<span data-ttu-id="9f14d-112">ためにこれらのパラメーターの値がどこから得られる指定する必要がありますが、入力パラメーターは、期待するメソッドを呼び出す、ObjectDataSource を使用できます。</span><span class="sxs-lookup"><span data-stu-id="9f14d-112">The ObjectDataSource can be used to invoke methods that expect input parameters, but in order to do so we must specify where the values for these parameters come from.</span></span> <span data-ttu-id="9f14d-113">パラメーターの値がハードコーディングすることができますか、さまざまななど、動的なソースから取得できます。 クエリ文字列値、セッション変数、またはその他のページ上の Web コントロールのプロパティの値。</span><span class="sxs-lookup"><span data-stu-id="9f14d-113">The parameter values can be hard-coded or can come from a variety of dynamic sources, including: querystring values, Session variables, the property value of a Web control on the page, or others.</span></span>

<span data-ttu-id="9f14d-114">このチュートリアルでは、ハード コーディングされた値に設定パラメーターを使用する方法を示すでスタートしましょう。</span><span class="sxs-lookup"><span data-stu-id="9f14d-114">For this tutorial let's start by illustrating how to use a parameter set to a hard-coded value.</span></span> <span data-ttu-id="9f14d-115">具体的には、説明、つまり Chef Anton Gumbo ミックス、ある特定の製品に関する情報を表示するページへの DetailsView の追加、`ProductID`は 5 です。</span><span class="sxs-lookup"><span data-stu-id="9f14d-115">Specifically, we'll look at adding a DetailsView to the page that displays information about a specific product, namely Chef Anton's Gumbo Mix, which has a `ProductID` of 5.</span></span> <span data-ttu-id="9f14d-116">次に、Web コントロールに基づくパラメーターの値を設定する方法を会いしましょう。</span><span class="sxs-lookup"><span data-stu-id="9f14d-116">Next, we'll see how to set the parameter value based on a Web control.</span></span> <span data-ttu-id="9f14d-117">具体的には、ユーザーがその後、その国にある仕入先の一覧を表示するのにボタンをクリックしたことができます、国に入力できるテキスト ボックスを使用します。</span><span class="sxs-lookup"><span data-stu-id="9f14d-117">In particular, we'll use a TextBox to let the user type in a country, after which they can click a Button to see the list of suppliers that reside in that country.</span></span>

## <a name="using-a-hard-coded-parameter-value"></a><span data-ttu-id="9f14d-118">パラメーターのハードコード値を使用します。</span><span class="sxs-lookup"><span data-stu-id="9f14d-118">Using a Hard-Coded Parameter Value</span></span>

<span data-ttu-id="9f14d-119">最初の例では、DetailsView コントロールを追加することによって、起動、 `DeclarativeParams.aspx`  ページで、`BasicReporting`フォルダーです。</span><span class="sxs-lookup"><span data-stu-id="9f14d-119">For the first example, start by adding a DetailsView control to the `DeclarativeParams.aspx` page in the `BasicReporting` folder.</span></span> <span data-ttu-id="9f14d-120">DetailsView のスマート タグから選択&lt;新しいデータ ソース&gt;ドロップダウン リストで一覧表示し、ObjectDataSource を追加します。</span><span class="sxs-lookup"><span data-stu-id="9f14d-120">From the DetailsView's smart tag, select &lt;New data source&gt; from the drop-down list and choose to add an ObjectDataSource.</span></span>


<span data-ttu-id="9f14d-121">[![ページに、ObjectDataSource を追加します。](declarative-parameters-vb/_static/image2.png)](declarative-parameters-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="9f14d-121">[![Add an ObjectDataSource to the Page](declarative-parameters-vb/_static/image2.png)](declarative-parameters-vb/_static/image1.png)</span></span>

<span data-ttu-id="9f14d-122">**図 1**: ObjectDataSource をページに追加 ([フルサイズのイメージを表示するをクリックして](declarative-parameters-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="9f14d-122">**Figure 1**: Add an ObjectDataSource to the Page ([Click to view full-size image](declarative-parameters-vb/_static/image3.png))</span></span>


<span data-ttu-id="9f14d-123">ObjectDataSource コントロールのデータ ソースの選択ウィザードが自動的に開始されます。</span><span class="sxs-lookup"><span data-stu-id="9f14d-123">This will automatically start the ObjectDataSource control's Choose Data Source wizard.</span></span> <span data-ttu-id="9f14d-124">選択、`ProductsBLL`ウィザードの最初の画面からクラスです。</span><span class="sxs-lookup"><span data-stu-id="9f14d-124">Select the `ProductsBLL` class from the first screen of the wizard.</span></span>


<span data-ttu-id="9f14d-125">[![ProductsBLL クラスを選択します。](declarative-parameters-vb/_static/image5.png)](declarative-parameters-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="9f14d-125">[![Select the ProductsBLL Class](declarative-parameters-vb/_static/image5.png)](declarative-parameters-vb/_static/image4.png)</span></span>

<span data-ttu-id="9f14d-126">**図 2**: 選択、`ProductsBLL`クラス ([フルサイズのイメージを表示するをクリックして](declarative-parameters-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="9f14d-126">**Figure 2**: Select the `ProductsBLL` Class ([Click to view full-size image](declarative-parameters-vb/_static/image6.png))</span></span>


<span data-ttu-id="9f14d-127">使用する特定の製品に関する情報を表示するので、`GetProductByProductID(productID)`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="9f14d-127">Since we want to display information about a particular product we want to use the `GetProductByProductID(productID)` method.</span></span>


<span data-ttu-id="9f14d-128">[![GetProductByProductID(productID) 方法を選択します。](declarative-parameters-vb/_static/image8.png)](declarative-parameters-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="9f14d-128">[![Choose the GetProductByProductID(productID) method](declarative-parameters-vb/_static/image8.png)](declarative-parameters-vb/_static/image7.png)</span></span>

<span data-ttu-id="9f14d-129">**図 3**: 選択、`GetProductByProductID(productID)`メソッド ([フルサイズのイメージを表示するをクリックして](declarative-parameters-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="9f14d-129">**Figure 3**: Choose the `GetProductByProductID(productID)` method ([Click to view full-size image](declarative-parameters-vb/_static/image9.png))</span></span>


<span data-ttu-id="9f14d-130">選択したメソッドには、パラメーターが含まれているため場所お尋ね、パラメーターに使用する値を定義すると、ウィザードの 1 つ以上の画面があります。</span><span class="sxs-lookup"><span data-stu-id="9f14d-130">Since the method we selected includes a parameter, there's one more screen for the wizard, where we're asked to define the value to be used for the parameter.</span></span> <span data-ttu-id="9f14d-131">左側の一覧には、選択したメソッドのパラメーターのすべてが表示されます。</span><span class="sxs-lookup"><span data-stu-id="9f14d-131">The list on the left shows all of the parameters for the selected method.</span></span> <span data-ttu-id="9f14d-132">`GetProductByProductID(productID)`が 1 つだけある`productID`です。</span><span class="sxs-lookup"><span data-stu-id="9f14d-132">For `GetProductByProductID(productID)` there's only one `productID`.</span></span> <span data-ttu-id="9f14d-133">右側の選択したパラメーターの値を指定できます。</span><span class="sxs-lookup"><span data-stu-id="9f14d-133">On the right we can specify the value for the selected parameter.</span></span> <span data-ttu-id="9f14d-134">パラメーターのソースのドロップダウン リストでは、パラメーター値のさまざまな可能なソースを列挙します。</span><span class="sxs-lookup"><span data-stu-id="9f14d-134">The parameter source drop-down list enumerates the various possible sources for the parameter value.</span></span> <span data-ttu-id="9f14d-135">5 用のハード コーディングされた値を指定するので、`productID`パラメーター、None とパラメーターのソースのままにし、DefaultValue ボックスに「5」と入力します。</span><span class="sxs-lookup"><span data-stu-id="9f14d-135">Since we want to specify a hard-coded value of 5 for the `productID` parameter, leave the Parameter source as None and enter 5 into the DefaultValue textbox.</span></span>


<span data-ttu-id="9f14d-136">[![Hard-Coded パラメーター値の 5 を使用するパラメーター productID の](declarative-parameters-vb/_static/image11.png)](declarative-parameters-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="9f14d-136">[![A Hard-Coded Parameter Value of 5 Will Be Used for the productID Parameter](declarative-parameters-vb/_static/image11.png)](declarative-parameters-vb/_static/image10.png)</span></span>

<span data-ttu-id="9f14d-137">**図 4**: A Hard-Coded パラメーター値の 5 を使用するため、`productID`パラメーター ([フルサイズのイメージを表示するをクリックして](declarative-parameters-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="9f14d-137">**Figure 4**: A Hard-Coded Parameter Value of 5 Will Be Used for the `productID` Parameter ([Click to view full-size image](declarative-parameters-vb/_static/image12.png))</span></span>


<span data-ttu-id="9f14d-138">ObjectDataSource コントロールの宣言型マークアップを含むデータ ソース構成ウィザードを完了すると、`Parameter`内のオブジェクト、`SelectParameters`コレクションで定義されたメソッドで想定されている入力パラメーターのそれぞれについて、 `SelectMethod`プロパティ。</span><span class="sxs-lookup"><span data-stu-id="9f14d-138">After completing the Configure Data Source wizard, the ObjectDataSource control's declarative markup includes a `Parameter` object in the `SelectParameters` collection for each of the input parameters expected by the method defined in the `SelectMethod` property.</span></span> <span data-ttu-id="9f14d-139">この例でを使用してメソッドがのみ、1 つの入力パラメーターを受け取るため`parameterID`、ここで 1 つだけのエントリが存在します。</span><span class="sxs-lookup"><span data-stu-id="9f14d-139">Since the method we're using in this example expects just a single input parameter, `parameterID`, there's only one entry here.</span></span> <span data-ttu-id="9f14d-140">`SelectParameters`コレクションから派生した任意のクラスを含めることができます、`Parameter`クラス内で、`System.Web.UI.WebControls`名前空間。</span><span class="sxs-lookup"><span data-stu-id="9f14d-140">The `SelectParameters` collection can contain any class that derives from the `Parameter` class in the `System.Web.UI.WebControls` namespace.</span></span> <span data-ttu-id="9f14d-141">パラメーターのハードコード値ベースの`Parameter`クラスを使用するは、他のパラメーターのソース オプション、派生`Parameter`クラスが使用されます。 独自に作成することも[カスタム パラメーターの型](http://www.leftslipper.com/ShowFaq.aspx?FaqId=11)、必要に応じて。</span><span class="sxs-lookup"><span data-stu-id="9f14d-141">For hard-coded parameter values the base `Parameter` class is used, but for the other parameter source options a derived `Parameter` class is used; you can also create your own [custom parameter types](http://www.leftslipper.com/ShowFaq.aspx?FaqId=11), if needed.</span></span>

[!code-aspx[Main](declarative-parameters-vb/samples/sample1.aspx)]

> [!NOTE]
> <span data-ttu-id="9f14d-142">月の値を含める表示この時点でいる場合はしているコンピューターで、宣言型マークアップ、 `InsertMethod`、`UpdateMethod`と`DeleteMethod`プロパティだけでなく`DeleteParameters`です。</span><span class="sxs-lookup"><span data-stu-id="9f14d-142">If you're following along on your own computer the declarative markup you see at this point may include values for the `InsertMethod`, `UpdateMethod`, and `DeleteMethod` properties, as well as `DeleteParameters`.</span></span> <span data-ttu-id="9f14d-143">ObjectDataSource のデータ ソースの選択ウィザードからのメソッドを自動的に指定する、`ProductBLL`に使用する挿入、更新、および削除すると、明示的にオフにしたものをしない限り、上記のマークアップで含めるをできるようにします。</span><span class="sxs-lookup"><span data-stu-id="9f14d-143">The ObjectDataSource's Choose Data Source wizard automatically specifies the methods from the `ProductBLL` to use for inserting, updating, and deleting, so unless you explicitly cleared those out, they'll be included in the markup above.</span></span>


<span data-ttu-id="9f14d-144">Web コントロールのデータが、ObjectDataSource を呼び出すこのページを訪問する際に`Select`メソッドの呼び出しは、`ProductsBLL`クラスの`GetProductByProductID(productID)`5 用のハード コーディングされた値を使用して、メソッド、`productID`入力パラメーターです。</span><span class="sxs-lookup"><span data-stu-id="9f14d-144">When visiting this page, the data Web control will invoke the ObjectDataSource's `Select` method, which will call the `ProductsBLL` class's `GetProductByProductID(productID)` method using the hard-coded value of 5 for the `productID` input parameter.</span></span> <span data-ttu-id="9f14d-145">メソッドは、厳密に型指定されたを返します`ProductDataTable`Chef Anton Gumbo ミックスに関する情報を含む 1 つの行を格納しているオブジェクト (プロダクトの product `ProductID` 5)。</span><span class="sxs-lookup"><span data-stu-id="9f14d-145">The method will return a strongly-typed `ProductDataTable` object that contains a single row with information about Chef Anton's Gumbo Mix (the product with `ProductID` 5).</span></span>


<span data-ttu-id="9f14d-146">[![情報は Chef Anton の Gumbo ミックスが表示されます。](declarative-parameters-vb/_static/image14.png)](declarative-parameters-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="9f14d-146">[![Information About Chef Anton's Gumbo Mix are Displayed](declarative-parameters-vb/_static/image14.png)](declarative-parameters-vb/_static/image13.png)</span></span>

<span data-ttu-id="9f14d-147">**図 5**: 情報は Chef Anton の Gumbo ミックスが表示されます ([フルサイズのイメージを表示するをクリックして](declarative-parameters-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="9f14d-147">**Figure 5**: Information About Chef Anton's Gumbo Mix are Displayed ([Click to view full-size image](declarative-parameters-vb/_static/image15.png))</span></span>


## <a name="setting-the-parameter-value-to-the-property-value-of-a-web-control"></a><span data-ttu-id="9f14d-148">パラメーター値を Web コントロールのプロパティの値に設定</span><span class="sxs-lookup"><span data-stu-id="9f14d-148">Setting the Parameter Value to the Property Value of a Web Control</span></span>

<span data-ttu-id="9f14d-149">値を設定することも、ObjectDataSource のパラメーターは、ページ上の Web コントロールの値に基づいています。</span><span class="sxs-lookup"><span data-stu-id="9f14d-149">The ObjectDataSource's parameter values can also be set based on the value of a Web control on the page.</span></span> <span data-ttu-id="9f14d-150">これを示すためには、すべてのユーザーによって指定された国に配置されている仕入先の一覧を表示する GridView があてみましょう。</span><span class="sxs-lookup"><span data-stu-id="9f14d-150">To illustrate this, let's have a GridView that lists all of the suppliers that are located in a country specified by the user.</span></span> <span data-ttu-id="9f14d-151">ユーザーが国の名前を入力できるページにテキスト ボックスを追加することによってこの開始を実行します。</span><span class="sxs-lookup"><span data-stu-id="9f14d-151">To accomplish this start by adding a TextBox to the page into which the user can enter a country name.</span></span> <span data-ttu-id="9f14d-152">このテキスト ボックス コントロールの設定`ID`プロパティを`CountryName`です。</span><span class="sxs-lookup"><span data-stu-id="9f14d-152">Set this TextBox control's `ID` property to `CountryName`.</span></span> <span data-ttu-id="9f14d-153">またボタン Web コントロールを追加します。</span><span class="sxs-lookup"><span data-stu-id="9f14d-153">Also add a Button Web control.</span></span>


<span data-ttu-id="9f14d-154">[![ID CountryName を含むページにテキスト ボックスを追加します。](declarative-parameters-vb/_static/image17.png)](declarative-parameters-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="9f14d-154">[![Add a TextBox to the Page with ID CountryName](declarative-parameters-vb/_static/image17.png)](declarative-parameters-vb/_static/image16.png)</span></span>

<span data-ttu-id="9f14d-155">**図 6**: テキスト ボックスを使用してページに追加`ID` `CountryName` ([フルサイズのイメージを表示するをクリックして](declarative-parameters-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="9f14d-155">**Figure 6**: Add a TextBox to the Page with `ID` `CountryName` ([Click to view full-size image](declarative-parameters-vb/_static/image18.png))</span></span>


<span data-ttu-id="9f14d-156">次に、ページと、スマート タグから GridView を追加では、新しい ObjectDataSource の追加を選択します。</span><span class="sxs-lookup"><span data-stu-id="9f14d-156">Next, add a GridView to the page and, from the smart tag, choose to add a new ObjectDataSource.</span></span> <span data-ttu-id="9f14d-157">仕入先についての選択を表示するので、`SuppliersBLL`ウィザードの最初の画面からのクラスです。</span><span class="sxs-lookup"><span data-stu-id="9f14d-157">Since we want to display supplier information select the `SuppliersBLL` class from the wizard's first screen.</span></span> <span data-ttu-id="9f14d-158">2 番目の画面では、次のように選択します。、`GetSuppliersByCountry(country)`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="9f14d-158">From the second screen, pick the `GetSuppliersByCountry(country)` method.</span></span>


<span data-ttu-id="9f14d-159">[![GetSuppliersByCountry(country) 方法を選択します。](declarative-parameters-vb/_static/image20.png)](declarative-parameters-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="9f14d-159">[![Choose the GetSuppliersByCountry(country) Method](declarative-parameters-vb/_static/image20.png)](declarative-parameters-vb/_static/image19.png)</span></span>

<span data-ttu-id="9f14d-160">**図 7**: 選択、`GetSuppliersByCountry(country)`メソッド ([フルサイズのイメージを表示するをクリックして](declarative-parameters-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="9f14d-160">**Figure 7**: Choose the `GetSuppliersByCountry(country)` Method ([Click to view full-size image](declarative-parameters-vb/_static/image21.png))</span></span>


<span data-ttu-id="9f14d-161">以降、`GetSuppliersByCountry(country)`メソッドの入力パラメーターには、ウィザードにはもう一度、パラメーターの値を選択するための最後の画面が含まれています。</span><span class="sxs-lookup"><span data-stu-id="9f14d-161">Since the `GetSuppliersByCountry(country)` method has an input parameter, the wizard once again includes a final screen for choosing the parameter value.</span></span> <span data-ttu-id="9f14d-162">この時点では、パラメーターのソースをコントロールに設定します。</span><span class="sxs-lookup"><span data-stu-id="9f14d-162">This time, set the Parameter source to Control.</span></span> <span data-ttu-id="9f14d-163">これは、ページ上のコントロールの名前を持つ ControlID ドロップダウン リストが設定されます。選択、`CountryName`一覧から管理します。</span><span class="sxs-lookup"><span data-stu-id="9f14d-163">This will populate the ControlID drop-down list with the names of the controls on the page; select the `CountryName` control from the list.</span></span> <span data-ttu-id="9f14d-164">ページを最初に開いたとき、 `CountryName`  テキスト ボックスは空白になります、結果が返されないため、何も表示されません。</span><span class="sxs-lookup"><span data-stu-id="9f14d-164">When the page is first visited the `CountryName` TextBox will be blank, so no results are returned and nothing is displayed.</span></span> <span data-ttu-id="9f14d-165">既定でいくつかの結果を表示する場合は、DefaultValue textbox を適宜設定します。</span><span class="sxs-lookup"><span data-stu-id="9f14d-165">If you want to display some results by default, set the DefaultValue textbox accordingly.</span></span>


<span data-ttu-id="9f14d-166">[![CountryName コントロール値に、パラメーターの値を設定します。](declarative-parameters-vb/_static/image23.png)](declarative-parameters-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="9f14d-166">[![Set the Parameter Value to the CountryName Control Value](declarative-parameters-vb/_static/image23.png)](declarative-parameters-vb/_static/image22.png)</span></span>

<span data-ttu-id="9f14d-167">**図 8**: に、パラメーターの値を設定、`CountryName`制御値 ([フルサイズのイメージを表示するをクリックして](declarative-parameters-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="9f14d-167">**Figure 8**: Set the Parameter Value to the `CountryName` Control Value ([Click to view full-size image](declarative-parameters-vb/_static/image24.png))</span></span>


<span data-ttu-id="9f14d-168">ObjectDataSource の宣言型マークアップと若干異なり、最初の例を使用して、 [ControlParameter](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.controlparameter.aspx)標準ではなく`Parameter`オブジェクト。</span><span class="sxs-lookup"><span data-stu-id="9f14d-168">The ObjectDataSource's declarative markup differs slightly from our first example, using a [ControlParameter](https://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.controlparameter.aspx) instead of the standard `Parameter` object.</span></span> <span data-ttu-id="9f14d-169">A`ControlParameter`を指定する追加のプロパティを持つ、 `ID` Web コントロールと、パラメーターで使用するプロパティ値の (`PropertyName`)。</span><span class="sxs-lookup"><span data-stu-id="9f14d-169">A `ControlParameter` has additional properties to specify the `ID` of the Web control and the property value to use for the parameter (`PropertyName`).</span></span> <span data-ttu-id="9f14d-170">データ ソース構成ウィザードが、テキスト ボックス、おすることが使用を決定するのに十分なスマート、`Text`パラメーター値のプロパティです。</span><span class="sxs-lookup"><span data-stu-id="9f14d-170">The Configure Data Source wizard was smart enough to determine that, for a TextBox, we'll likely want to use the `Text` property for the parameter value.</span></span> <span data-ttu-id="9f14d-171">ただし、Web コントロールから別のプロパティ値を使用する場合は、変更、`PropertyName`値ここで、またはウィザードで「詳細プロパティの表示設定」リンクをクリックします。</span><span class="sxs-lookup"><span data-stu-id="9f14d-171">If, however, you want to use a different property value from the Web control you can change the `PropertyName` value here or by clicking the "Show advanced properties" link in the wizard.</span></span>

[!code-aspx[Main](declarative-parameters-vb/samples/sample2.aspx)]

<span data-ttu-id="9f14d-172">最初に、ページにアクセスしたとき、 `CountryName`  テキスト ボックスが空です。</span><span class="sxs-lookup"><span data-stu-id="9f14d-172">When visiting the page for the first time the `CountryName` TextBox is empty.</span></span> <span data-ttu-id="9f14d-173">ObjectDataSource の`Select`GridView の値でメソッドが呼び出されますも`Nothing`に渡される、`GetSuppliersByCountry(country)`メソッドです。</span><span class="sxs-lookup"><span data-stu-id="9f14d-173">The ObjectDataSource's `Select` method is still invoked by the GridView, but a value of `Nothing` is passed into the `GetSuppliersByCountry(country)` method.</span></span> <span data-ttu-id="9f14d-174">TableAdapter に変換、`Nothing`データベースに`NULL`値 (`DBNull.Value`) で使用されるクエリでは、`GetSuppliersByCountry(country)`メソッドがいずれかが返されないように記述された値、 `NULL` の値を指定`@CategoryID`パラメーター。</span><span class="sxs-lookup"><span data-stu-id="9f14d-174">The TableAdapter converts the `Nothing` into a database `NULL` value (`DBNull.Value`), but the query used by the `GetSuppliersByCountry(country)` method is written such that it doesn't return any values when a `NULL` value is specified for the `@CategoryID` parameter.</span></span> <span data-ttu-id="9f14d-175">つまり、サプライヤーは返されません。</span><span class="sxs-lookup"><span data-stu-id="9f14d-175">In short, no suppliers are returned.</span></span>

<span data-ttu-id="9f14d-176">訪問者の国、ただし、入力し、ポストバックを発生させる、ObjectDataSource のサプライヤーの表示ボタンをクリックした後`Select`メソッドを表示すると、テキスト ボックス コントロールの引き渡し`Text`値として、`country`パラメーター。</span><span class="sxs-lookup"><span data-stu-id="9f14d-176">Once the visitor enters in a country, however, and clicks the Show Suppliers button to cause a postback, the ObjectDataSource's `Select` method is requeried, passing in the TextBox control's `Text` value as the `country` parameter.</span></span>


<span data-ttu-id="9f14d-177">[![カナダから業者が表示されます。](declarative-parameters-vb/_static/image26.png)](declarative-parameters-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="9f14d-177">[![Those Suppliers from Canada are Shown](declarative-parameters-vb/_static/image26.png)](declarative-parameters-vb/_static/image25.png)</span></span>

<span data-ttu-id="9f14d-178">**図 9**: カナダからサプライヤーものが表示されます ([フルサイズのイメージを表示するをクリックして](declarative-parameters-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="9f14d-178">**Figure 9**: Those Suppliers from Canada are Shown ([Click to view full-size image](declarative-parameters-vb/_static/image27.png))</span></span>


## <a name="showing-all-suppliers-by-default"></a><span data-ttu-id="9f14d-179">既定ですべてのサプライヤーの表示</span><span class="sxs-lookup"><span data-stu-id="9f14d-179">Showing All Suppliers By Default</span></span>

<span data-ttu-id="9f14d-180">はなく最初のページを表示するときに表示なしサプライヤーのより可能性がありますを表示する*すべて* ボックスで、国の名前を入力して一覧を縮小するユーザーを許可するのには最初、suppliers です。</span><span class="sxs-lookup"><span data-stu-id="9f14d-180">Rather than show none of the suppliers when first viewing the page we may want to show *all* suppliers at first, allowing the user to pare down the list by entering a country name in the TextBox.</span></span> <span data-ttu-id="9f14d-181">テキスト ボックスが空で、ときに、`SuppliersBLL`クラスの`GetSuppliersByCountry(country)`メソッドが渡された`Nothing`の *`country`* 入力パラメーターです。</span><span class="sxs-lookup"><span data-stu-id="9f14d-181">When the TextBox is empty, the `SuppliersBLL` class's `GetSuppliersByCountry(country)` method is passed in `Nothing` for its *`country`* input parameter.</span></span> <span data-ttu-id="9f14d-182">これは、`Nothing`値は、に、DAL の`GetSupplierByCountry(country)`メソッド、データベースに変換されます`NULL`値を`@Country`次のクエリ パラメーター。</span><span class="sxs-lookup"><span data-stu-id="9f14d-182">This `Nothing` value is then passed down into the DAL's `GetSupplierByCountry(country)` method, where it's translated to a database `NULL` value for the `@Country` parameter in the following query:</span></span>

[!code-sql[Main](declarative-parameters-vb/samples/sample3.sql)]

<span data-ttu-id="9f14d-183">式`Country = NULL`常に False を返します、レコードにもある`Country`列には、`NULL`値です。 そのため、レコードは返されません。</span><span class="sxs-lookup"><span data-stu-id="9f14d-183">The expression `Country = NULL` always returns False, even for records whose `Country` column has a `NULL` value; therefore, no records are returned.</span></span>

<span data-ttu-id="9f14d-184">返される*すべて*仕入先国 テキスト ボックスが空の場合は、お補強できます、`GetSuppliersByCountry(country)`メソッドを呼び出す BLL で、`GetSuppliers()`メソッドは、その国のパラメーターと`Nothing`と DAL の呼び出しに`GetSuppliersByCountry(country)`。メソッドはそれ以外の場合。</span><span class="sxs-lookup"><span data-stu-id="9f14d-184">To return *all* suppliers when the country TextBox is empty, we can augment the `GetSuppliersByCountry(country)` method in the BLL to invoke the `GetSuppliers()` method when its country parameter is `Nothing` and to call the DAL's `GetSuppliersByCountry(country)` method otherwise.</span></span> <span data-ttu-id="9f14d-185">国のパラメーターが含まれるときに、国が指定されていない場合、すべてのサプライヤーと仕入先の適切なサブセットを返すの効果があります。</span><span class="sxs-lookup"><span data-stu-id="9f14d-185">This will have the effect of returning all suppliers when no country is specified and the appropriate subset of suppliers when the country parameter is included.</span></span>

<span data-ttu-id="9f14d-186">変更、`GetSuppliersByCountry(country)`メソッドで、`SuppliersBLL`には、次のクラス。</span><span class="sxs-lookup"><span data-stu-id="9f14d-186">Change the `GetSuppliersByCountry(country)` method in the `SuppliersBLL` class to the following:</span></span>

[!code-vb[Main](declarative-parameters-vb/samples/sample4.vb)]

<span data-ttu-id="9f14d-187">この変更により、`DeclarativeParams.aspx`ページが最初にアクセスされるときに、仕入先のすべてを表示 (またはたびに、 `CountryName`  テキスト ボックスが空です)。</span><span class="sxs-lookup"><span data-stu-id="9f14d-187">With this change the `DeclarativeParams.aspx` page shows all of the suppliers when first visited (or whenever the `CountryName` TextBox is empty).</span></span>


<span data-ttu-id="9f14d-188">[![All は既定で表示されるようになりました](declarative-parameters-vb/_static/image29.png)](declarative-parameters-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="9f14d-188">[![All Suppliers are Now Shown by Default](declarative-parameters-vb/_static/image29.png)](declarative-parameters-vb/_static/image28.png)</span></span>

<span data-ttu-id="9f14d-189">**図 10**: All は既定で表示されるようになりました ([フルサイズのイメージを表示するをクリックして](declarative-parameters-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="9f14d-189">**Figure 10**: All Suppliers are Now Shown by Default ([Click to view full-size image](declarative-parameters-vb/_static/image30.png))</span></span>


## <a name="summary"></a><span data-ttu-id="9f14d-190">概要</span><span class="sxs-lookup"><span data-stu-id="9f14d-190">Summary</span></span>

<span data-ttu-id="9f14d-191">入力パラメーターを持つメソッドを使用するために必要があります、objectdatasource のパラメーターの値を指定する`SelectParameters`コレクション。</span><span class="sxs-lookup"><span data-stu-id="9f14d-191">In order to use methods with input parameters, we need to specify the values for the parameters in the ObjectDataSource's `SelectParameters` collection.</span></span> <span data-ttu-id="9f14d-192">異なる型のパラメーターの異なるソースから取得されるパラメーター値を許容します。</span><span class="sxs-lookup"><span data-stu-id="9f14d-192">Different types of parameters allow for the parameter value to be obtained from different sources.</span></span> <span data-ttu-id="9f14d-193">既定のパラメーター型が、ハード コーディングされた値を使用しますが、簡単に (およびコードの行がない) と同様、クエリ文字列、セッション変数、cookie、およびページ上のコントロールを Web からもユーザーが入力した値からパラメーターの値を取得できます。</span><span class="sxs-lookup"><span data-stu-id="9f14d-193">The default parameter type uses a hard-coded value, but just as easily (and without a line of code) parameter values can be obtained from the querystring, Session variables, cookies, and even user-entered values from Web controls on the page.</span></span>

<span data-ttu-id="9f14d-194">このチュートリアルで見ておの例では、宣言型のパラメーター値を使用する方法を説明します。</span><span class="sxs-lookup"><span data-stu-id="9f14d-194">The examples we looked at in this tutorial illustrated how to use declarative parameter values.</span></span> <span data-ttu-id="9f14d-195">ただし、場合がありますしなければならない場合は、現在の日付と時間など、使用できないパラメーター ソースを使用する必要がありますか、このサイトは、メンバーシップ、訪問者のユーザー ID を使用していた場合。</span><span class="sxs-lookup"><span data-stu-id="9f14d-195">However, there may be times when we need to use a parameter source that's not available, such as the current date and time, or, if our site was using Membership, the User ID of the visitor.</span></span> <span data-ttu-id="9f14d-196">そのようなシナリオおことができます、パラメーター値を設定、ObjectDataSource 前にプログラムでその基になるオブジェクトのメソッドを呼び出します。</span><span class="sxs-lookup"><span data-stu-id="9f14d-196">For such scenarios we can set the parameter values programmatically prior to the ObjectDataSource invoking its underlying object's method.</span></span> <span data-ttu-id="9f14d-197">これを実現する方法をお見せ、[次のチュートリアル](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)です。</span><span class="sxs-lookup"><span data-stu-id="9f14d-197">We'll see how to accomplish this in the [next tutorial](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md).</span></span>

<span data-ttu-id="9f14d-198">満足プログラミング!</span><span class="sxs-lookup"><span data-stu-id="9f14d-198">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="9f14d-199">作成者について</span><span class="sxs-lookup"><span data-stu-id="9f14d-199">About the Author</span></span>

<span data-ttu-id="9f14d-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)、7 つ受け取りますブックとの創設者の作成者[4GuysFromRolla.com](http://www.4guysfromrolla.com)、1998 年からマイクロソフトの Web テクノロジで取り組んできました。</span><span class="sxs-lookup"><span data-stu-id="9f14d-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="9f14d-201">Scott は、コンサルタント、トレーナー、ライターとして機能します。</span><span class="sxs-lookup"><span data-stu-id="9f14d-201">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="9f14d-202">最新の著書[ *Sam 学べる自分で ASP.NET 2.0 が 24 時間以内に*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)です。</span><span class="sxs-lookup"><span data-stu-id="9f14d-202">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="9f14d-203">彼に到達できる[ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)彼のブログを使用して含まれているのか[http://ScottOnWriting.NET](http://ScottOnWriting.NET)です。</span><span class="sxs-lookup"><span data-stu-id="9f14d-203">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="9f14d-204">感謝の特別な</span><span class="sxs-lookup"><span data-stu-id="9f14d-204">Special Thanks To</span></span>

<span data-ttu-id="9f14d-205">このチュートリアルの系列は既に多くの便利なレビュー担当者によって確認済みです。</span><span class="sxs-lookup"><span data-stu-id="9f14d-205">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="9f14d-206">このチュートリアルのレビュー担当者の潜在顧客が Hilton Giesenow しました。</span><span class="sxs-lookup"><span data-stu-id="9f14d-206">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="9f14d-207">今後、MSDN の記事を確認することに関心のあるですか。</span><span class="sxs-lookup"><span data-stu-id="9f14d-207">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="9f14d-208">場合は、ドロップ me 一度に 1 行ずつ[mitchell@4GuysFromRolla.comです。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="9f14d-208">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="9f14d-209">[前へ](displaying-data-with-the-objectdatasource-vb.md)
[次へ](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)</span><span class="sxs-lookup"><span data-stu-id="9f14d-209">[Previous](displaying-data-with-the-objectdatasource-vb.md)
[Next](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)</span></span>
